here the results of the base models to compare with
all used the same config for a given model size, 
    all trained with 256 batchSize, trainProp=0.8, and lr=1.0e-03
    and no data augmentation (to reduce randomness)


___ model ___ (gating:___, experts: ___ x ___, topK: ___)
    -> nb parameters: total(___), gating(___), experts(___ x ___)
    training:
        ___
    -> best accuracy, train: ___% (epoch ___), test: ___% (epoch ___)
    time taken:
        all: 100.00% (___ sec)
        ___
    experts gates (tests):
        ___



temporary results for testing


############################ without data augmentation ####################################


model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=1, topK=1, modelConfig="medium", memoryMode=False).to(device)
└── Model: 497_916 params
    └── blocks: 497_916 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 98_432 params
        └── Block_FFD_Moe[9]: 71_436 params
            ├── gating: 258 params
            └── experts: 71_178 params
Epoch 1, train: (loss: 1.363, accuracy: 50.19%), test: (loss: 1.124, accuracy: 60.85%), lr: 1.0000e-03
        Epoch 2, train: (loss: 0.9827, accuracy: 65.29%), test: (loss: 0.9312, accuracy: 66.83%), lr: 1.0000e-03
        Epoch 3, train: (loss: 0.8082, accuracy: 71.39%), test: (loss: 0.7605, accuracy: 73.52%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.7078, accuracy: 75.19%), test: (loss: 0.8128, accuracy: 72.17%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.6282, accuracy: 77.94%), test: (loss: 0.7095, accuracy: 75.31%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.5521, accuracy: 80.65%), test: (loss: 0.8329, accuracy: 72.88%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.5045, accuracy: 82.35%), test: (loss: 0.7176, accuracy: 76.15%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.4398, accuracy: 84.49%), test: (loss: 0.6677, accuracy: 77.19%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.3947, accuracy: 86.25%), test: (loss: 0.6547, accuracy: 78.11%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.3576, accuracy: 87.45%), test: (loss: 0.7894, accuracy: 75.06%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.3208, accuracy: 88.68%), test: (loss: 0.6548, accuracy: 79.03%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.2773, accuracy: 90.29%), test: (loss: 0.6866, accuracy: 79.27%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.256, accuracy: 90.97%), test: (loss: 0.7088, accuracy: 77.78%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.2277, accuracy: 91.81%), test: (loss: 0.7198, accuracy: 78.89%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.209, accuracy: 92.47%), test: (loss: 0.7706, accuracy: 78.97%), lr: 1.0000e-03
    -> best accuracy, train: 92.47% (epoch 15), test: 79.27% (epoch 12)
totalTime: 1 min 1.3 sec, trainTime: 56.023 sec, testTime: 5.272 sec
{
    all: 100.00%,
    getBatch: 5.80%,
    predict+loss: 30.40%,
    backward: 46.31%,
    step: 4.32%,
    metrics_base: 1.39%,
    metrics_moe: 1.21%,
    evaluate: 8.60%,
    progressBar: 1.41%,
    other: 0.56%
}
-> RESULT
mean: [1.] (std: 0.0)
std: [0.] (mean: 0.0)
perClassPred: 
[[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]





model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 855_096 params
    └── blocks: 855_096 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 98_432 params
        └── Block_FFD_Moe[9]: 428_616 params
            ├── gating: 1_548 params
            └── experts: 427_068 params
Epoch 1, train: (loss: 1.447, accuracy: 46.93%), test: (loss: 1.182, accuracy: 58.91%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.008, accuracy: 64.13%), test: (loss: 1.045, accuracy: 65.06%), lr: 1.0000e-03
        Epoch 3, train: (loss: 0.8325, accuracy: 70.78%), test: (loss: 0.8973, accuracy: 70.17%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.7152, accuracy: 74.94%), test: (loss: 0.7165, accuracy: 75.22%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.628, accuracy: 78.13%), test: (loss: 0.7806, accuracy: 74.43%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.5582, accuracy: 80.55%), test: (loss: 0.6822, accuracy: 76.83%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.5036, accuracy: 82.56%), test: (loss: 0.6532, accuracy: 77.92%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.4435, accuracy: 84.44%), test: (loss: 0.6696, accuracy: 77.67%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.4, accuracy: 85.87%), test: (loss: 0.62, accuracy: 79.38%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.3665, accuracy: 87.21%), test: (loss: 0.6366, accuracy: 80.27%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.3257, accuracy: 88.62%), test: (loss: 0.6692, accuracy: 79.50%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.3006, accuracy: 89.56%), test: (loss: 0.6354, accuracy: 79.71%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.2715, accuracy: 90.52%), test: (loss: 0.6248, accuracy: 80.15%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.248, accuracy: 91.29%), test: (loss: 0.6928, accuracy: 80.03%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.2218, accuracy: 92.25%), test: (loss: 0.7083, accuracy: 79.88%), lr: 1.0000e-03
    -> best accuracy, train: 92.25% (epoch 15), test: 80.27% (epoch 10)
totalTime: 1 min 26.2 sec, trainTime: 1 min 19.3 sec, testTime: 6.935 sec
{
    all: 100.00%,
    getBatch: 4.55%,
    predict+loss: 28.54%,
    backward: 50.46%,
    step: 3.99%,
    metrics_base: 1.02%,
    metrics_moe: 1.44%,
    evaluate: 8.05%,
    progressBar: 1.45%,
    other: 0.51%
}
-> RESULT
mean: [0.137 0.106 0.194 0.182 0.171 0.21 ] (std: 0.035)
std: [0.201 0.163 0.19  0.295 0.221 0.255] (mean: 0.221)
perClassPred: 
[[0.01 0.   0.19 0.35 0.06 0.66 0.06 0.08 0.   0.  ]
 [0.01 0.   0.05 0.3  0.1  0.09 0.53 0.05 0.   0.01]
 [0.33 0.   0.62 0.21 0.4  0.1  0.2  0.07 0.04 0.  ]
 [0.08 0.78 0.01 0.01 0.01 0.   0.04 0.01 0.13 0.75]
 [0.03 0.03 0.03 0.08 0.39 0.14 0.12 0.75 0.   0.11]
 [0.54 0.19 0.1  0.05 0.04 0.01 0.06 0.04 0.82 0.12]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 2_113_286 params
    └── blocks: 2_113_286 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Block_FFD_Moe[6]: 1_777_548 params
        │   ├── gating: 2_316 params
        │   └── experts: 1_775_232 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.41, accuracy: 48.52%), test: (loss: 1.476, accuracy: 51.85%), lr: 1.0000e-03
        Epoch 2, train: (loss: 0.9959, accuracy: 64.76%), test: (loss: 1.136, accuracy: 61.78%), lr: 1.0000e-03
        Epoch 3, train: (loss: 0.8128, accuracy: 71.42%), test: (loss: 0.9414, accuracy: 68.13%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.6862, accuracy: 76.12%), test: (loss: 0.7817, accuracy: 73.66%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.5868, accuracy: 79.44%), test: (loss: 0.7374, accuracy: 75.08%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.5004, accuracy: 82.68%), test: (loss: 0.9558, accuracy: 71.36%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.4293, accuracy: 85.23%), test: (loss: 0.783, accuracy: 75.02%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.3577, accuracy: 87.58%), test: (loss: 0.7727, accuracy: 76.34%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.2929, accuracy: 89.87%), test: (loss: 0.7846, accuracy: 76.33%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.2403, accuracy: 91.78%), test: (loss: 0.9508, accuracy: 74.65%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.1947, accuracy: 93.36%), test: (loss: 0.8389, accuracy: 78.12%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.1668, accuracy: 94.22%), test: (loss: 0.8994, accuracy: 76.31%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.1372, accuracy: 95.34%), test: (loss: 0.9188, accuracy: 77.95%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.1284, accuracy: 95.56%), test: (loss: 1.002, accuracy: 77.58%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.1149, accuracy: 96.12%), test: (loss: 1.09, accuracy: 75.70%), lr: 1.0000e-03
    -> best accuracy, train: 96.12% (epoch 15), test: 78.12% (epoch 11)
totalTime: 1 min 32.1 sec, trainTime: 1 min 24.5 sec, testTime: 7.642 sec
{
    all: 100.00%,
    getBatch: 4.34%,
    predict+loss: 27.60%,
    backward: 49.68%,
    step: 4.02%,
    metrics_base: 0.96%,
    metrics_moe: 3.19%,
    evaluate: 8.30%,
    progressBar: 1.44%,
    other: 0.48%
}
-> RESULT
mean: [0.142 0.236 0.119 0.174 0.15  0.178] (std: 0.037)
std: [0.13  0.109 0.12  0.158 0.126 0.064] (mean: 0.118)
perClassPred: 
[[0.08 0.38 0.04 0.06 0.1  0.04 0.08 0.2  0.1  0.41]
 [0.37 0.12 0.3  0.36 0.17 0.32 0.1  0.13 0.27 0.07]
 [0.01 0.01 0.17 0.08 0.35 0.08 0.3  0.24 0.02 0.03]
 [0.29 0.3  0.06 0.06 0.07 0.02 0.03 0.04 0.5  0.31]
 [0.04 0.02 0.23 0.29 0.15 0.25 0.39 0.09 0.03 0.02]
 [0.21 0.17 0.2  0.16 0.16 0.28 0.1  0.29 0.08 0.16]]





 model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v3(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 1_127_558 params
    └── blocks: 1_127_558 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_FFD_Moe[5]: 791_820 params
        │   ├── gating: 1_548 params
        │   └── experts: 790_272 params
        ├── Block_CNN[6]: 221_568 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.587, accuracy: 41.71%), test: (loss: 1.284, accuracy: 53.83%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.2, accuracy: 56.87%), test: (loss: 1.222, accuracy: 56.84%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.001, accuracy: 64.58%), test: (loss: 0.9661, accuracy: 66.22%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.8701, accuracy: 69.39%), test: (loss: 0.9609, accuracy: 66.88%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.7767, accuracy: 72.93%), test: (loss: 0.9207, accuracy: 69.18%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.6981, accuracy: 75.66%), test: (loss: 0.9003, accuracy: 69.20%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.6383, accuracy: 78.03%), test: (loss: 0.9011, accuracy: 69.92%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.5858, accuracy: 79.81%), test: (loss: 0.6748, accuracy: 77.33%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.526, accuracy: 81.67%), test: (loss: 0.7281, accuracy: 76.39%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.4871, accuracy: 83.17%), test: (loss: 0.735, accuracy: 75.33%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.4454, accuracy: 84.50%), test: (loss: 0.6571, accuracy: 77.92%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.4046, accuracy: 85.97%), test: (loss: 0.667, accuracy: 77.91%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.3624, accuracy: 87.52%), test: (loss: 0.7818, accuracy: 77.08%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.3251, accuracy: 88.92%), test: (loss: 0.6932, accuracy: 79.04%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.2916, accuracy: 89.99%), test: (loss: 0.7289, accuracy: 77.88%), lr: 1.0000e-03
    -> best accuracy, train: 89.99% (epoch 15), test: 79.04% (epoch 14)
totalTime: 2 min 17.3 sec, trainTime: 2 min 2.4 sec, testTime: 14.874 sec
{
    all: 100.00%,
    getBatch: 2.92%,
    predict+loss: 22.53%,
    backward: 40.48%,
    step: 2.42%,
    metrics_base: 0.64%,
    metrics_moe: 18.91%,
    evaluate: 10.88%,
    progressBar: 0.92%,
    other: 0.31%
}
-> RESULT
mean: [0.155 0.142 0.177 0.172 0.194 0.16 ] (std: 0.017)
std: [0.033 0.038 0.019 0.035 0.031 0.037] (mean: 0.032)
perClassPred: 
[[0.11 0.12 0.16 0.18 0.21 0.19 0.16 0.2  0.12 0.13]
 [0.21 0.12 0.17 0.15 0.12 0.17 0.08 0.12 0.17 0.11]
 [0.17 0.17 0.17 0.2  0.17 0.21 0.15 0.2  0.15 0.19]
 [0.2  0.17 0.18 0.13 0.17 0.11 0.16 0.15 0.24 0.17]
 [0.19 0.25 0.18 0.17 0.15 0.17 0.2  0.17 0.2  0.24]
 [0.1  0.16 0.14 0.16 0.19 0.16 0.24 0.16 0.11 0.17]]





 model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v4(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
    └── Model: 1_326_866 params
    └── blocks: 1_326_866 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_FFD_Moe[4]: 199_308 params
        │   ├── gating: 780 params
        │   └── experts: 198_528 params
        ├── Block_CNN[5]: 73_728 params
        ├── Block_FFD_Moe[6]: 791_820 params
        │   ├── gating: 1_548 params
        │   └── experts: 790_272 params
        ├── Block_CNN[7]: 221_568 params
        ├── Dropout[8]: 0 params
        ├── Flatten[9]: 0 params
        └── Linear[10]: 7_690 params
Epoch 1, train: (loss: 1.783, accuracy: 34.12%), test: (loss: 1.614, accuracy: 41.72%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.324, accuracy: 52.27%), test: (loss: 1.239, accuracy: 56.08%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.138, accuracy: 59.64%), test: (loss: 1.139, accuracy: 60.34%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.016, accuracy: 64.51%), test: (loss: 1.361, accuracy: 54.58%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9187, accuracy: 67.88%), test: (loss: 0.958, accuracy: 66.50%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.853, accuracy: 70.49%), test: (loss: 0.8759, accuracy: 70.08%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.7926, accuracy: 72.59%), test: (loss: 0.8504, accuracy: 71.29%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7462, accuracy: 74.31%), test: (loss: 0.8425, accuracy: 71.54%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7021, accuracy: 75.77%), test: (loss: 0.7633, accuracy: 73.72%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.6685, accuracy: 76.94%), test: (loss: 0.735, accuracy: 75.10%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.624, accuracy: 78.58%), test: (loss: 0.7479, accuracy: 74.57%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.5951, accuracy: 79.78%), test: (loss: 0.8838, accuracy: 72.48%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.5644, accuracy: 80.77%), test: (loss: 0.7258, accuracy: 75.54%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.5346, accuracy: 81.74%), test: (loss: 0.7042, accuracy: 76.39%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.512, accuracy: 82.64%), test: (loss: 0.7017, accuracy: 76.56%), lr: 1.0000e-03
    -> best accuracy, train: 82.64% (epoch 15), test: 76.56% (epoch 15)
totalTime: 6 min 51.6 sec, trainTime: 5 min 51.8 sec, testTime: 59.887 sec
{
    all: 100.00%,
    getBatch: 1.15%,
    predict+loss: 15.44%,
    backward: 28.87%,
    step: 1.19%,
    metrics_base: 0.22%,
    metrics_moe: 37.82%,
    evaluate: 14.55%,
    progressBar: 0.62%,
    other: 0.15%
}
-> RESULT
mean: [0.159 0.166 0.162 0.165 0.178 0.17 ] (std: 0.006)
std: [0.01  0.009 0.005 0.011 0.005 0.005] (mean: 0.008)
perClassPred: 
[[0.16 0.15 0.17 0.16 0.17 0.16 0.17 0.15 0.17 0.14]
 [0.15 0.17 0.16 0.17 0.17 0.17 0.16 0.18 0.15 0.18]
 [0.16 0.16 0.16 0.17 0.16 0.17 0.16 0.16 0.16 0.16]
 [0.18 0.18 0.17 0.16 0.15 0.16 0.16 0.16 0.17 0.16]
 [0.17 0.17 0.18 0.18 0.19 0.17 0.19 0.17 0.18 0.18]
 [0.16 0.17 0.17 0.17 0.17 0.17 0.17 0.18 0.17 0.18]]
-> RESULT
mean: [0.153 0.147 0.161 0.145 0.147 0.247] (std: 0.036)
std: [0.054 0.033 0.042 0.039 0.039 0.07 ] (mean: 0.046)
perClassPred: 
[[0.08 0.09 0.16 0.19 0.22 0.17 0.23 0.2  0.09 0.11]
 [0.16 0.15 0.14 0.1  0.18 0.1  0.12 0.13 0.2  0.16]
 [0.17 0.23 0.13 0.15 0.11 0.12 0.13 0.14 0.23 0.2 ]
 [0.09 0.16 0.12 0.16 0.14 0.19 0.18 0.16 0.08 0.2 ]
 [0.09 0.15 0.14 0.2  0.14 0.22 0.14 0.18 0.1  0.16]
 [0.41 0.22 0.31 0.2  0.21 0.2  0.21 0.19 0.3  0.17]]





model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v5(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 535_046 params
    └── blocks: 535_046 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_FFD_Moe[4]: 199_308 params
        │   ├── gating: 780 params
        │   └── experts: 198_528 params
        ├── Block_CNN[5]: 73_728 params
        ├── Block_CNN[6]: 221_568 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.541, accuracy: 43.71%), test: (loss: 1.366, accuracy: 51.64%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.122, accuracy: 60.31%), test: (loss: 1.292, accuracy: 55.38%), lr: 1.0000e-03
        Epoch 3, train: (loss: 0.9394, accuracy: 67.07%), test: (loss: 0.895, accuracy: 68.96%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.8191, accuracy: 71.13%), test: (loss: 0.8588, accuracy: 69.53%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.7339, accuracy: 74.32%), test: (loss: 0.7382, accuracy: 74.93%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.6504, accuracy: 77.49%), test: (loss: 0.7235, accuracy: 75.17%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.5955, accuracy: 79.42%), test: (loss: 0.7162, accuracy: 75.97%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.5337, accuracy: 81.69%), test: (loss: 0.6752, accuracy: 77.16%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.4905, accuracy: 83.03%), test: (loss: 0.6844, accuracy: 76.53%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.4497, accuracy: 84.45%), test: (loss: 0.6644, accuracy: 78.10%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.4102, accuracy: 85.83%), test: (loss: 0.6613, accuracy: 78.27%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.3707, accuracy: 87.31%), test: (loss: 0.6434, accuracy: 78.31%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.3443, accuracy: 88.16%), test: (loss: 0.6972, accuracy: 78.21%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.2998, accuracy: 89.77%), test: (loss: 0.6366, accuracy: 79.39%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.2738, accuracy: 90.72%), test: (loss: 0.7095, accuracy: 77.98%), lr: 1.0000e-03
    -> best accuracy, train: 90.72% (epoch 15), test: 79.39% (epoch 14)
totalTime: 6 min 40.9 sec, trainTime: 5 min 41.8 sec, testTime: 59.153 sec
{
    all: 100.00%,
    getBatch: 2.26%,
    predict+loss: 15.42%,
    backward: 29.02%,
    step: 0.93%,
    metrics_base: 0.23%,
    metrics_moe: 36.49%,
    evaluate: 14.75%,
    progressBar: 0.75%,
    other: 0.13%
}
-> RESULT
mean: [0.181 0.194 0.124 0.159 0.133 0.208] (std: 0.031)
std: [0.011 0.024 0.028 0.023 0.017 0.018] (mean: 0.02)
perClassPred: 
[[0.19 0.16 0.19 0.18 0.19 0.18 0.2  0.18 0.18 0.16]
 [0.14 0.17 0.18 0.21 0.22 0.21 0.22 0.21 0.17 0.19]
 [0.17 0.16 0.12 0.11 0.08 0.11 0.1  0.12 0.15 0.15]
 [0.11 0.14 0.17 0.17 0.18 0.18 0.18 0.16 0.13 0.14]
 [0.17 0.14 0.15 0.13 0.12 0.13 0.13 0.11 0.15 0.11]
 [0.21 0.23 0.19 0.2  0.2  0.19 0.19 0.22 0.22 0.25]]




table:

--------------------------------------------------------------------------------------------------------------------------
| config                     | parameters | nbEpoches | trainAccuracy | testAccuracy | trainTime | GVofM | GMofV | %Used |
--------------------------------------------------------------------------------------------------------------------------
| without data augmentations                                                                                             |
--------------------------------------------------------------------------------------------------------------------------
| V1 medium + 1 expert top1  |    497'916 |        15 |        92.47% |       79.27% |  56.0 sec |     - |     - |  100% |
| V1 medium + 6 expert top2  |    855'096 |        15 |        92.25% |       80.27% |  79.3 sec | 0.035 | 0.221 |  100% |
| V2 medium + 6 expert top2  |  2'113'286 |        15 |        96.12% |       78.12% |  84.5 sec | 0.037 | 0.118 |  100% |
| V3 medium + 6 expert top2  |  1'127'558 |        15 |        89.99% |       79.04% | 122.4 sec | 0.017 | 0.032 |  100% |
| V4 medium + 6 expert top2  |  1'326'866 |        15 |        82.64% |       76.56% | 351.8 sec | 0.006 | 0.008 |  100% |
|    (2 layers of MOE)       |            |           |               |              |           | 0.036 | 0.046 |  100% |
| V5 medium + 6 expert top2  |    535'046 |        15 |        90.72% |       79.39% | 341.8 sec | 0.031 | 0.020 |  100% |
--------------------------------------------------------------------------------------------------------------------------
| with "basic+augment" data augmentations                                                                                |
--------------------------------------------------------------------------------------------------------------------------
| V1 medium + 1 expert top1  |    497'916 |        25 |        82.36% |       78.74% | 138.1 sec |     - |     - |  100% |
| V1 medium + 6 expert top2  |    855'096 |        25 |        81.49% |       77.38% | 182.8 sec | 0.041 | 0.199 |  100% |
| V2 medium + 6 expert top2  |  2'113'286 |        25 |        84.26% |       78.72% | 180.6 sec | 0.014 | 0.129 |  100% |
| V3 medium + 6 expert top2  |  1'127'558 |        25 |        80.10% |       76.22% | 251.6 sec | 0.029 | 0.035 |  100% |
| V4 medium + 6 expert top2  |  1'326'866 |        25 |        76.35% |       72.77% | 665.4 sec | 0.013 | 0.014 |  100% |
|                            |            |           |               |              |           | 0.023 | 0.049 |  100% |
| V5 medium + 6 expert top2  |    535'046 |        25 |        81.24% |       76.75% | 514.1 sec | 0.018 | 0.020 |  100% |
--------------------------------------------------------------------------------------------------------------------------
| V2 medium + 12 expert top2 |  3'890'834 |        25 |        83.35% |       77.31% | 228.0 sec | 0.019 | 0.074 |  100% |
| V2 medium + 24 expert top2 |  7'445'930 |        25 |        83.02% |       77.19% | 319.4 sec | 0.020 | 0.044 |  100% |
--------------------------------------------------------------------------------------------------------------------------
| V1 large  + 1 expert top2  |  2'395'916 |        25 |        86.94% |       82.25% | 226.9 sec |     - |     - |  100% |
| V1 large  + 6 expert top2  |  3'177'416 |        25 |        86.76% |       81.94% | 256.7 sec | 0.030 | 0.215 |  100% |
| V2 large  + 6 expert top2  |  4'422'614 |        25 |        86.86% |       81.17% | 267.8 sec | 0.021 | 0.139 |  100% |
| V3 large  + 6 expert top2  |  4'422'614 |        25 |        84.23% |       79.58% | 380.9 sec | 0.025 | 0.048 |  100% |
| V4 large  + 6 expert top2  |  5'214'434 |        25 |        81.60% |       77.12% | 873.9 sec | 0.010 | 0.022 |  100% |
|    (2 layers of MOE)       |            |           |               |              |           | 0.029 | 0.057 |  100% |
--------------------------------------------------------------------------------------------------------------------------
| V- large  + 6 expert top2  |  --------- |        -- |        ------ |       ------ | ----- sec | 0.___ | 0.___ |  100% |
|    (2 layers of MOE)       |            |           |               |              |           | 0.___ | 0.___ |     - |
--------------------------------------------------------------------------------------------------------------------------









############################ with data augmentation ####################################
Compose(
      ToImage()
      ToDtype(scale=True)
)
Compose(
      ColorJitter(brightness=(0.65, 1.35), contrast=(0.75, 1.25), saturation=(0.75, 1.25), hue=(-0.03, 0.03))
      Normalize(mean=[0.5, 0.5, 0.5], std=[0.22, 0.22, 0.22], inplace=False)
      RandomHorizontalFlip(p=0.5)
      RandomRotation(degrees=[-15.0, 15.0], interpolation=InterpolationMode.BILINEAR, expand=False, fill=0)
      RandomResizedCrop(size=(32, 32), scale=(0.65, 1.5), ratio=(1, 1), interpolation=InterpolationMode.BILINEAR, antialias=True)
)


model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=1, topK=1, modelConfig="medium", memoryMode=False).to(device)
└── Model: 497_916 params
    └── blocks: 497_916 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 98_432 params
        └── Block_FFD_Moe[9]: 71_436 params
            ├── gating: 258 params
            └── experts: 71_178 params
Epoch 1, train: (loss: 1.564, accuracy: 42.31%), test: (loss: 1.455, accuracy: 47.98%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.246, accuracy: 54.94%), test: (loss: 1.278, accuracy: 54.70%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.095, accuracy: 61.11%), test: (loss: 1.087, accuracy: 61.73%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.9925, accuracy: 65.04%), test: (loss: 1.049, accuracy: 63.33%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9233, accuracy: 67.42%), test: (loss: 0.9975, accuracy: 66.04%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8534, accuracy: 69.75%), test: (loss: 0.9105, accuracy: 68.47%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8122, accuracy: 71.42%), test: (loss: 0.9041, accuracy: 68.21%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7729, accuracy: 73.02%), test: (loss: 0.8482, accuracy: 70.09%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7324, accuracy: 74.46%), test: (loss: 0.8087, accuracy: 72.19%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7194, accuracy: 74.77%), test: (loss: 0.791, accuracy: 72.64%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.6919, accuracy: 76.03%), test: (loss: 0.7564, accuracy: 74.49%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.661, accuracy: 76.80%), test: (loss: 0.793, accuracy: 72.37%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6536, accuracy: 77.19%), test: (loss: 0.7952, accuracy: 73.19%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6361, accuracy: 77.97%), test: (loss: 0.7016, accuracy: 75.65%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.616, accuracy: 78.53%), test: (loss: 0.7307, accuracy: 74.88%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.6068, accuracy: 78.90%), test: (loss: 0.7628, accuracy: 73.91%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5933, accuracy: 79.52%), test: (loss: 0.666, accuracy: 76.93%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5647, accuracy: 80.25%), test: (loss: 0.7122, accuracy: 76.21%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5695, accuracy: 80.24%), test: (loss: 0.7041, accuracy: 76.01%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5584, accuracy: 80.62%), test: (loss: 0.7246, accuracy: 75.48%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.549, accuracy: 80.76%), test: (loss: 0.638, accuracy: 78.47%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5279, accuracy: 81.48%), test: (loss: 0.721, accuracy: 75.28%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5392, accuracy: 81.15%), test: (loss: 0.6268, accuracy: 78.57%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5274, accuracy: 81.60%), test: (loss: 0.6753, accuracy: 77.06%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.5074, accuracy: 82.36%), test: (loss: 0.6248, accuracy: 78.74%), lr: 1.0000e-03
    -> best accuracy, train: 82.36% (epoch 25), test: 78.74% (epoch 25)
eval (test) with no augments: (loss: 0.9293, accuracy: 73.09%)
totalTime: 2 min 36.2 sec, trainTime: 2 min 18.1 sec, testTime: 18.103 sec
{
    all: 100.00%,
    getBatch: 24.90%,
    predict+loss: 21.71%,
    backward: 35.18%,
    step: 3.06%,
    metrics_base: 0.96%,
    metrics_moe: 0.83%,
    evaluate: 11.59%,
    progressBar: 1.39%,
    other: 0.40%
}
-> RESULT
mean: [1.] (std: 0.0)
std: [0.] (mean: 0.0)
perClassPred: 
[[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]


model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 855_096 params
    └── blocks: 855_096 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 98_432 params
        └── Block_FFD_Moe[9]: 428_616 params
            ├── gating: 1_548 params
            └── experts: 427_068 params
Epoch 1, train: (loss: 1.626, accuracy: 41.25%), test: (loss: 1.689, accuracy: 41.06%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.271, accuracy: 54.54%), test: (loss: 1.638, accuracy: 42.90%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.125, accuracy: 60.24%), test: (loss: 1.42, accuracy: 52.24%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.023, accuracy: 63.86%), test: (loss: 1.041, accuracy: 64.28%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9339, accuracy: 67.52%), test: (loss: 1.074, accuracy: 63.84%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8781, accuracy: 69.28%), test: (loss: 1.065, accuracy: 63.78%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8464, accuracy: 70.53%), test: (loss: 0.9103, accuracy: 69.05%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8101, accuracy: 71.82%), test: (loss: 0.8555, accuracy: 70.93%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7721, accuracy: 73.13%), test: (loss: 0.886, accuracy: 69.84%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7411, accuracy: 73.96%), test: (loss: 0.8027, accuracy: 73.04%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7162, accuracy: 75.10%), test: (loss: 0.8083, accuracy: 72.07%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6906, accuracy: 75.98%), test: (loss: 0.8273, accuracy: 72.97%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6767, accuracy: 76.70%), test: (loss: 0.7473, accuracy: 74.94%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6487, accuracy: 77.45%), test: (loss: 0.7645, accuracy: 74.77%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6243, accuracy: 78.42%), test: (loss: 0.7346, accuracy: 75.52%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.616, accuracy: 78.70%), test: (loss: 0.7941, accuracy: 73.74%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.6091, accuracy: 78.96%), test: (loss: 0.774, accuracy: 74.34%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.6005, accuracy: 79.19%), test: (loss: 0.7055, accuracy: 76.07%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5805, accuracy: 80.01%), test: (loss: 0.7528, accuracy: 75.49%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5686, accuracy: 80.16%), test: (loss: 0.6954, accuracy: 76.83%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5638, accuracy: 80.49%), test: (loss: 0.6753, accuracy: 77.23%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.553, accuracy: 80.84%), test: (loss: 0.709, accuracy: 76.09%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5552, accuracy: 80.77%), test: (loss: 0.7047, accuracy: 76.68%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5405, accuracy: 81.25%), test: (loss: 0.6986, accuracy: 77.38%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.5344, accuracy: 81.49%), test: (loss: 0.6852, accuracy: 77.35%), lr: 1.0000e-03
    -> best accuracy, train: 81.49% (epoch 25), test: 77.38% (epoch 24)
eval (test) with no augments: (loss: 0.7431, accuracy: 77.21%)
totalTime: 3 min 25.2 sec, trainTime: 3 min 2.8 sec, testTime: 22.476 sec
{
    all: 100.00%,
    getBatch: 22.43%,
    predict+loss: 20.81%,
    backward: 39.68%,
    step: 2.94%,
    metrics_base: 0.75%,
    metrics_moe: 1.01%,
    evaluate: 10.95%,
    progressBar: 1.06%,
    other: 0.35%
}
-> RESULT
mean: [0.191 0.168 0.24  0.142 0.108 0.152] (std: 0.041)
std: [0.228 0.187 0.212 0.166 0.182 0.217] (mean: 0.199)
perClassPred: 
[[0.21 0.42 0.03 0.02 0.01 0.   0.02 0.01 0.58 0.55]
 [0.   0.   0.3  0.38 0.17 0.57 0.22 0.07 0.01 0.  ]
 [0.72 0.02 0.43 0.14 0.25 0.04 0.04 0.15 0.34 0.05]
 [0.04 0.55 0.07 0.11 0.02 0.07 0.08 0.08 0.08 0.38]
 [0.01 0.01 0.07 0.21 0.09 0.17 0.63 0.03 0.   0.01]
 [0.02 0.   0.11 0.15 0.46 0.15 0.01 0.67 0.   0.01]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 2_113_286 params
    └── blocks: 2_113_286 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Block_FFD_Moe[6]: 1_777_548 params
        │   ├── gating: 2_316 params
        │   └── experts: 1_775_232 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.611, accuracy: 40.61%), test: (loss: 1.673, accuracy: 42.86%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.28, accuracy: 54.10%), test: (loss: 1.32, accuracy: 54.33%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.101, accuracy: 60.92%), test: (loss: 1.121, accuracy: 60.89%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.002, accuracy: 65.03%), test: (loss: 1.089, accuracy: 62.52%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9031, accuracy: 68.41%), test: (loss: 1.088, accuracy: 63.57%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8412, accuracy: 70.84%), test: (loss: 1.037, accuracy: 64.40%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8004, accuracy: 72.20%), test: (loss: 0.9257, accuracy: 68.75%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7487, accuracy: 74.03%), test: (loss: 0.9509, accuracy: 67.74%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7143, accuracy: 75.31%), test: (loss: 0.8585, accuracy: 71.09%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.6998, accuracy: 75.84%), test: (loss: 0.8792, accuracy: 70.91%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.6646, accuracy: 77.21%), test: (loss: 0.8648, accuracy: 72.11%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6438, accuracy: 77.90%), test: (loss: 0.7727, accuracy: 74.14%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6242, accuracy: 78.55%), test: (loss: 0.79, accuracy: 73.85%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6073, accuracy: 79.04%), test: (loss: 0.7754, accuracy: 73.39%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.5842, accuracy: 79.77%), test: (loss: 0.7238, accuracy: 76.08%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.554, accuracy: 80.78%), test: (loss: 0.8207, accuracy: 73.90%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5503, accuracy: 80.92%), test: (loss: 0.7291, accuracy: 75.69%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5288, accuracy: 81.56%), test: (loss: 0.6837, accuracy: 76.72%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5118, accuracy: 82.33%), test: (loss: 0.7517, accuracy: 75.12%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5006, accuracy: 82.81%), test: (loss: 0.7498, accuracy: 75.74%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.507, accuracy: 82.51%), test: (loss: 0.7343, accuracy: 75.83%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.4934, accuracy: 82.88%), test: (loss: 0.6549, accuracy: 78.37%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.4797, accuracy: 83.41%), test: (loss: 0.6491, accuracy: 78.17%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4684, accuracy: 83.77%), test: (loss: 0.7486, accuracy: 76.42%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.4568, accuracy: 84.26%), test: (loss: 0.6428, accuracy: 78.72%), lr: 1.0000e-03
    -> best accuracy, train: 84.26% (epoch 25), test: 78.72% (epoch 25)
eval (test) with no augments: (loss: 0.9188, accuracy: 73.81%)
totalTime: 3 min 21.4 sec, trainTime: 3 min 0.6 sec, testTime: 20.804 sec
{
    all: 100.00%,
    getBatch: 18.35%,
    predict+loss: 21.92%,
    backward: 41.89%,
    step: 3.11%,
    metrics_base: 0.71%,
    metrics_moe: 2.33%,
    evaluate: 10.33%,
    progressBar: 1.01%,
    other: 0.35%
}
-> RESULT
mean: [0.171 0.167 0.142 0.167 0.164 0.189] (std: 0.014)
std: [0.051 0.134 0.138 0.182 0.161 0.11 ] (mean: 0.129)
perClassPred: 
[[0.15 0.18 0.19 0.15 0.09 0.23 0.16 0.12 0.17 0.29]
 [0.04 0.01 0.19 0.24 0.27 0.38 0.12 0.34 0.01 0.03]
 [0.36 0.18 0.09 0.06 0.05 0.06 0.02 0.05 0.45 0.17]
 [0.26 0.56 0.05 0.02 0.03 0.01 0.05 0.05 0.26 0.41]
 [0.02 0.03 0.23 0.24 0.25 0.1  0.55 0.05 0.04 0.03]
 [0.16 0.05 0.24 0.28 0.29 0.21 0.09 0.39 0.06 0.08]]



model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=True).to(device)
└── Model: 2_113_286 params
    └── blocks: 2_113_286 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Block_FFD_Moe[6]: 1_777_548 params
        │   ├── gating: 2_316 params
        │   └── experts: 1_775_232 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.61, accuracy: 40.72%), test: (loss: 1.811, accuracy: 41.41%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.278, accuracy: 54.23%), test: (loss: 1.482, accuracy: 47.82%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.108, accuracy: 60.90%), test: (loss: 1.148, accuracy: 60.19%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.983, accuracy: 65.40%), test: (loss: 1.111, accuracy: 61.39%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9218, accuracy: 67.91%), test: (loss: 1.045, accuracy: 64.78%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8491, accuracy: 70.61%), test: (loss: 1.11, accuracy: 64.43%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8005, accuracy: 72.17%), test: (loss: 0.9288, accuracy: 67.97%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7567, accuracy: 73.65%), test: (loss: 0.9262, accuracy: 69.27%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7107, accuracy: 75.50%), test: (loss: 0.8724, accuracy: 70.10%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.6818, accuracy: 76.65%), test: (loss: 0.8854, accuracy: 70.07%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.6661, accuracy: 77.15%), test: (loss: 0.8201, accuracy: 72.54%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6498, accuracy: 77.68%), test: (loss: 1.026, accuracy: 67.72%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6175, accuracy: 79.02%), test: (loss: 0.7509, accuracy: 75.05%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6085, accuracy: 79.00%), test: (loss: 0.7379, accuracy: 75.24%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.5712, accuracy: 80.54%), test: (loss: 0.776, accuracy: 74.16%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.5668, accuracy: 80.60%), test: (loss: 0.7524, accuracy: 75.00%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5602, accuracy: 80.79%), test: (loss: 0.8507, accuracy: 72.05%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5444, accuracy: 81.42%), test: (loss: 0.9303, accuracy: 70.23%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5276, accuracy: 81.79%), test: (loss: 0.8032, accuracy: 73.88%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5069, accuracy: 82.40%), test: (loss: 0.7684, accuracy: 74.28%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5008, accuracy: 82.82%), test: (loss: 0.7129, accuracy: 76.17%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.486, accuracy: 83.43%), test: (loss: 0.6639, accuracy: 77.87%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.4849, accuracy: 83.37%), test: (loss: 0.6975, accuracy: 76.96%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4707, accuracy: 83.77%), test: (loss: 0.7885, accuracy: 75.28%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.4588, accuracy: 83.93%), test: (loss: 0.6806, accuracy: 77.98%), lr: 1.0000e-03
    -> best accuracy, train: 83.93% (epoch 25), test: 77.98% (epoch 25)
eval (test) with no augments: (loss: 0.9697, accuracy: 74.32%)
totalTime: 4 min 13.9 sec, trainTime: 3 min 48.5 sec, testTime: 25.410 sec
{
    all: 100.00%,
    getBatch: 14.98%,
    predict+loss: 24.60%,
    backward: 44.12%,
    step: 2.57%,
    metrics_base: 0.55%,
    metrics_moe: 1.84%,
    evaluate: 10.01%,
    progressBar: 1.03%,
    other: 0.29%
}
-> RESULT
mean: [0.216 0.155 0.17  0.177 0.146 0.136] (std: 0.026)
std: [0.155 0.128 0.084 0.159 0.127 0.152] (mean: 0.134)
perClassPred: 
[[0.37 0.4  0.1  0.08 0.06 0.06 0.09 0.13 0.46 0.34]
 [0.02 0.04 0.15 0.19 0.26 0.24 0.14 0.46 0.01 0.1 ]
 [0.28 0.04 0.29 0.24 0.16 0.18 0.08 0.21 0.14 0.07]
 [0.24 0.47 0.06 0.05 0.08 0.03 0.05 0.05 0.29 0.41]
 [0.07 0.03 0.26 0.29 0.08 0.42 0.16 0.07 0.07 0.03]
 [0.01 0.02 0.14 0.15 0.36 0.07 0.49 0.08 0.02 0.04]]


model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v3(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 1_127_558 params
    └── blocks: 1_127_558 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_FFD_Moe[5]: 791_820 params
        │   ├── gating: 1_548 params
        │   └── experts: 790_272 params
        ├── Block_CNN[6]: 221_568 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.715, accuracy: 36.49%), test: (loss: 1.544, accuracy: 43.48%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.392, accuracy: 49.50%), test: (loss: 1.418, accuracy: 50.02%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.247, accuracy: 55.75%), test: (loss: 1.32, accuracy: 53.75%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.151, accuracy: 59.27%), test: (loss: 1.262, accuracy: 56.12%), lr: 1.0000e-03
        Epoch 5, train: (loss: 1.079, accuracy: 61.97%), test: (loss: 1.269, accuracy: 57.12%), lr: 1.0000e-03
        Epoch 6, train: (loss: 1.006, accuracy: 64.70%), test: (loss: 1.228, accuracy: 58.31%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.9537, accuracy: 66.75%), test: (loss: 1.079, accuracy: 62.78%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8995, accuracy: 68.80%), test: (loss: 0.956, accuracy: 67.19%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.8552, accuracy: 70.45%), test: (loss: 0.9442, accuracy: 67.19%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.8293, accuracy: 71.12%), test: (loss: 0.9586, accuracy: 67.31%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7982, accuracy: 72.53%), test: (loss: 0.9246, accuracy: 68.20%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.7747, accuracy: 73.35%), test: (loss: 0.8964, accuracy: 69.19%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.7489, accuracy: 74.32%), test: (loss: 0.8413, accuracy: 70.97%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.7152, accuracy: 75.46%), test: (loss: 0.8411, accuracy: 71.42%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.7068, accuracy: 75.84%), test: (loss: 0.843, accuracy: 71.03%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.6937, accuracy: 76.13%), test: (loss: 0.7727, accuracy: 73.49%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.6812, accuracy: 76.78%), test: (loss: 0.7565, accuracy: 74.29%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.6592, accuracy: 77.48%), test: (loss: 0.8068, accuracy: 73.22%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.6452, accuracy: 77.85%), test: (loss: 0.8328, accuracy: 71.96%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.6284, accuracy: 78.59%), test: (loss: 0.7355, accuracy: 74.52%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.6171, accuracy: 79.00%), test: (loss: 0.7341, accuracy: 75.41%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.6077, accuracy: 79.44%), test: (loss: 0.7148, accuracy: 76.02%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5903, accuracy: 80.08%), test: (loss: 0.7092, accuracy: 76.20%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5835, accuracy: 80.10%), test: (loss: 0.7127, accuracy: 76.22%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.5954, accuracy: 79.64%), test: (loss: 0.795, accuracy: 74.32%), lr: 1.0000e-03
    -> best accuracy, train: 80.10% (epoch 24), test: 76.22% (epoch 24)
eval (test) with no augments: (loss: 1.068, accuracy: 69.76%)
totalTime: 4 min 45.1 sec, trainTime: 4 min 11.6 sec, testTime: 33.524 sec
{
    all: 100.00%,
    getBatch: 13.17%,
    predict+loss: 19.59%,
    backward: 36.16%,
    step: 1.96%,
    metrics_base: 0.50%,
    metrics_moe: 15.38%,
    evaluate: 11.76%,
    progressBar: 1.23%,
    other: 0.26%
}
-> RESULT
mean: [0.133 0.168 0.208 0.14  0.202 0.15 ] (std: 0.029)
std: [0.035 0.025 0.037 0.027 0.055 0.03 ] (mean: 0.035)
perClassPred: 
[[0.14 0.07 0.15 0.18 0.14 0.19 0.12 0.13 0.13 0.08]
 [0.18 0.2  0.16 0.14 0.17 0.12 0.18 0.15 0.2  0.19]
 [0.16 0.2  0.2  0.19 0.23 0.23 0.23 0.26 0.12 0.22]
 [0.1  0.17 0.12 0.13 0.12 0.12 0.19 0.11 0.15 0.17]
 [0.31 0.21 0.22 0.19 0.16 0.18 0.13 0.16 0.3  0.19]
 [0.1  0.14 0.14 0.18 0.18 0.15 0.15 0.19 0.1  0.15]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v4(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 1_326_866 params
    └── blocks: 1_326_866 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_FFD_Moe[4]: 199_308 params
        │   ├── gating: 780 params
        │   └── experts: 198_528 params
        ├── Block_CNN[5]: 73_728 params
        ├── Block_FFD_Moe[6]: 791_820 params
        │   ├── gating: 1_548 params
        │   └── experts: 790_272 params
        ├── Block_CNN[7]: 221_568 params
        ├── Dropout[8]: 0 params
        ├── Flatten[9]: 0 params
        └── Linear[10]: 7_690 params
Epoch 1, train: (loss: 1.836, accuracy: 32.29%), test: (loss: 1.658, accuracy: 39.53%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.482, accuracy: 46.33%), test: (loss: 1.426, accuracy: 48.87%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.336, accuracy: 52.29%), test: (loss: 1.429, accuracy: 49.27%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.228, accuracy: 56.44%), test: (loss: 1.298, accuracy: 55.02%), lr: 1.0000e-03
        Epoch 5, train: (loss: 1.156, accuracy: 59.49%), test: (loss: 1.314, accuracy: 54.99%), lr: 1.0000e-03
        Epoch 6, train: (loss: 1.097, accuracy: 61.47%), test: (loss: 1.561, accuracy: 49.70%), lr: 1.0000e-03
        Epoch 7, train: (loss: 1.041, accuracy: 63.80%), test: (loss: 1.097, accuracy: 62.02%), lr: 1.0000e-03
        Epoch 8, train: (loss: 1.008, accuracy: 64.75%), test: (loss: 1.153, accuracy: 60.47%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.9772, accuracy: 66.12%), test: (loss: 1.068, accuracy: 64.01%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.957, accuracy: 66.94%), test: (loss: 1.015, accuracy: 65.19%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.936, accuracy: 67.51%), test: (loss: 0.9945, accuracy: 66.08%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.8975, accuracy: 69.09%), test: (loss: 0.9649, accuracy: 66.91%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.8843, accuracy: 69.46%), test: (loss: 0.96, accuracy: 67.03%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.8624, accuracy: 70.16%), test: (loss: 0.9385, accuracy: 68.02%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.84, accuracy: 71.19%), test: (loss: 0.9863, accuracy: 67.29%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.8151, accuracy: 72.02%), test: (loss: 0.9345, accuracy: 68.31%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.8072, accuracy: 72.18%), test: (loss: 0.9573, accuracy: 68.42%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.7945, accuracy: 72.79%), test: (loss: 0.8851, accuracy: 70.35%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.7713, accuracy: 73.81%), test: (loss: 0.8459, accuracy: 71.42%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.7477, accuracy: 74.40%), test: (loss: 0.9448, accuracy: 68.23%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.7487, accuracy: 74.46%), test: (loss: 0.8434, accuracy: 71.81%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.734, accuracy: 75.14%), test: (loss: 0.9077, accuracy: 69.73%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.7279, accuracy: 75.39%), test: (loss: 0.8374, accuracy: 72.07%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.7029, accuracy: 75.93%), test: (loss: 0.8411, accuracy: 71.97%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.6954, accuracy: 76.35%), test: (loss: 0.8063, accuracy: 72.77%), lr: 1.0000e-03
    -> best accuracy, train: 76.35% (epoch 25), test: 72.77% (epoch 25)
eval (test) with no augments: (loss: 0.8935, accuracy: 73.01%)
totalTime: 12 min 56.0 sec, trainTime: 11 min 5.4 sec, testTime: 1 min 50.6 sec
{
    all: 100.00%,
    getBatch: 5.00%,
    predict+loss: 15.33%,
    backward: 29.63%,
    step: 1.08%,
    metrics_base: 0.20%,
    metrics_moe: 33.86%,
    evaluate: 14.25%,
    progressBar: 0.54%,
    other: 0.12%
}
-> RESULT
mean: [0.189 0.165 0.146 0.156 0.17  0.174] (std: 0.013)
std: [0.008 0.019 0.01  0.029 0.006 0.013] (mean: 0.014)
perClassPred: 
[[0.2  0.18 0.2  0.19 0.19 0.19 0.18 0.18 0.19 0.18]
 [0.13 0.17 0.16 0.17 0.18 0.17 0.18 0.18 0.14 0.18]
 [0.13 0.13 0.15 0.15 0.16 0.14 0.16 0.15 0.14 0.14]
 [0.22 0.17 0.15 0.15 0.12 0.15 0.12 0.14 0.18 0.16]
 [0.17 0.17 0.17 0.17 0.16 0.18 0.16 0.18 0.17 0.17]
 [0.15 0.18 0.17 0.17 0.18 0.16 0.2  0.17 0.17 0.17]]
-> RESULT
mean: [0.13  0.188 0.169 0.151 0.162 0.2  ] (std: 0.023)
std: [0.029 0.08  0.053 0.047 0.044 0.038] (mean: 0.049)
perClassPred: 
[[0.12 0.18 0.11 0.11 0.11 0.1  0.16 0.1  0.13 0.18]
 [0.35 0.13 0.25 0.21 0.14 0.21 0.08 0.12 0.24 0.11]
 [0.21 0.19 0.19 0.14 0.15 0.1  0.11 0.13 0.29 0.15]
 [0.1  0.12 0.15 0.15 0.19 0.18 0.23 0.21 0.07 0.16]
 [0.09 0.19 0.13 0.19 0.16 0.2  0.17 0.19 0.1  0.23]
 [0.14 0.19 0.17 0.21 0.24 0.21 0.26 0.25 0.16 0.17]]








model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v5(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 535_046 params
    └── blocks: 535_046 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_FFD_Moe[4]: 199_308 params
        │   ├── gating: 780 params
        │   └── experts: 198_528 params
        ├── Block_CNN[5]: 73_728 params
        ├── Block_CNN[6]: 221_568 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.64, accuracy: 40.12%), test: (loss: 1.527, accuracy: 45.33%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.293, accuracy: 53.41%), test: (loss: 1.351, accuracy: 53.26%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.157, accuracy: 59.02%), test: (loss: 1.275, accuracy: 55.97%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.07, accuracy: 62.18%), test: (loss: 1.286, accuracy: 55.26%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9992, accuracy: 64.74%), test: (loss: 1.072, accuracy: 63.47%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.9376, accuracy: 67.23%), test: (loss: 1.097, accuracy: 63.20%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8884, accuracy: 68.81%), test: (loss: 0.9577, accuracy: 66.66%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8484, accuracy: 70.38%), test: (loss: 0.9732, accuracy: 67.64%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.8196, accuracy: 71.44%), test: (loss: 0.9128, accuracy: 67.83%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.784, accuracy: 73.06%), test: (loss: 0.9518, accuracy: 66.61%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7641, accuracy: 73.34%), test: (loss: 0.8038, accuracy: 72.10%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.7513, accuracy: 73.97%), test: (loss: 0.8417, accuracy: 71.44%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.7189, accuracy: 74.91%), test: (loss: 0.8602, accuracy: 70.78%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6903, accuracy: 76.25%), test: (loss: 0.9661, accuracy: 68.89%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6851, accuracy: 76.27%), test: (loss: 0.781, accuracy: 73.48%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.659, accuracy: 77.26%), test: (loss: 0.7658, accuracy: 73.84%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.6481, accuracy: 77.70%), test: (loss: 0.6861, accuracy: 76.33%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.648, accuracy: 77.79%), test: (loss: 0.7391, accuracy: 74.78%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.626, accuracy: 78.64%), test: (loss: 0.7293, accuracy: 75.41%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.6099, accuracy: 79.05%), test: (loss: 0.6904, accuracy: 76.33%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5999, accuracy: 79.51%), test: (loss: 0.7112, accuracy: 75.86%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5906, accuracy: 79.75%), test: (loss: 0.7069, accuracy: 76.01%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.592, accuracy: 79.58%), test: (loss: 0.6949, accuracy: 76.75%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5858, accuracy: 80.05%), test: (loss: 0.7521, accuracy: 75.51%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.5495, accuracy: 81.24%), test: (loss: 0.6987, accuracy: 76.46%), lr: 1.0000e-03
    -> best accuracy, train: 81.24% (epoch 25), test: 76.75% (epoch 23)
eval (test) with no augments: (loss: 0.702, accuracy: 77.78%)
totalTime: 10 min 3.1 sec, trainTime: 8 min 34.1 sec, testTime: 1 min 29.0 sec
{
    all: 100.00%,
    getBatch: 6.38%,
    predict+loss: 13.46%,
    backward: 26.44%,
    step: 0.91%,
    metrics_base: 0.24%,
    metrics_moe: 36.99%,
    evaluate: 14.75%,
    progressBar: 0.70%,
    other: 0.13%
}
-> RESULT
mean: [0.188 0.153 0.171 0.191 0.149 0.148] (std: 0.018)
std: [0.018 0.033 0.014 0.017 0.019 0.019] (mean: 0.02)
perClassPred: 
[[0.16 0.19 0.18 0.19 0.19 0.2  0.19 0.21 0.15 0.2 ]
 [0.22 0.17 0.16 0.14 0.12 0.14 0.11 0.13 0.2  0.15]
 [0.15 0.16 0.17 0.17 0.19 0.15 0.19 0.16 0.18 0.16]
 [0.16 0.2  0.19 0.19 0.2  0.2  0.2  0.21 0.16 0.19]
 [0.18 0.15 0.14 0.15 0.13 0.14 0.12 0.14 0.18 0.16]
 [0.13 0.12 0.16 0.16 0.17 0.16 0.18 0.15 0.13 0.13]]



model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=1, topK=1, modelConfig="large", memoryMode=False).to(device)
└── Model: 2_395_916 params
    └── blocks: 2_395_916 params
        ├── Block_CNN[0]: 1_728 params
        ├── Block_CNN[1]: 73_984 params
        ├── Block_CNN[2]: 147_456 params
        ├── Block_CNN[3]: 147_456 params
        ├── Block_CNN[4]: 294_912 params
        ├── Block_CNN[5]: 1_180_672 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 393_408 params
        └── Block_FFD_Moe[9]: 156_300 params
            ├── gating: 386 params
            └── experts: 155_914 params
Epoch 1, train: (loss: 1.609, accuracy: 40.41%), test: (loss: 1.85, accuracy: 39.96%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.27, accuracy: 54.16%), test: (loss: 1.371, accuracy: 53.00%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.074, accuracy: 61.67%), test: (loss: 1.154, accuracy: 59.36%), lr: 1.0000e-03
        Epoch 4, train: (loss: 0.9502, accuracy: 66.58%), test: (loss: 1.082, accuracy: 62.50%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.8791, accuracy: 69.32%), test: (loss: 0.9447, accuracy: 66.86%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8001, accuracy: 72.03%), test: (loss: 0.8097, accuracy: 71.64%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.7353, accuracy: 74.30%), test: (loss: 0.8748, accuracy: 69.53%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.6964, accuracy: 75.81%), test: (loss: 0.8128, accuracy: 72.04%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.6653, accuracy: 76.76%), test: (loss: 0.833, accuracy: 71.23%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.6129, accuracy: 78.62%), test: (loss: 0.7154, accuracy: 75.76%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.6023, accuracy: 79.05%), test: (loss: 0.6943, accuracy: 76.76%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.5704, accuracy: 80.16%), test: (loss: 0.6671, accuracy: 76.86%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.5383, accuracy: 81.24%), test: (loss: 0.6618, accuracy: 77.16%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.5133, accuracy: 81.83%), test: (loss: 0.6458, accuracy: 77.63%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.5027, accuracy: 82.70%), test: (loss: 0.6496, accuracy: 77.64%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.4736, accuracy: 83.65%), test: (loss: 0.6586, accuracy: 77.15%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.4588, accuracy: 84.05%), test: (loss: 0.5766, accuracy: 80.02%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.4466, accuracy: 84.40%), test: (loss: 0.6101, accuracy: 79.92%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.4254, accuracy: 85.09%), test: (loss: 0.5866, accuracy: 80.35%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.4236, accuracy: 85.34%), test: (loss: 0.6024, accuracy: 80.32%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.4186, accuracy: 85.50%), test: (loss: 0.6384, accuracy: 78.82%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.3961, accuracy: 86.02%), test: (loss: 0.5644, accuracy: 81.23%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.3984, accuracy: 85.98%), test: (loss: 0.5527, accuracy: 81.64%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.38, accuracy: 86.73%), test: (loss: 0.533, accuracy: 82.25%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.3747, accuracy: 86.94%), test: (loss: 0.5467, accuracy: 81.51%), lr: 1.0000e-03
    -> best accuracy, train: 86.94% (epoch 25), test: 82.25% (epoch 24)
eval (test) with no augments: (loss: 0.6603, accuracy: 79.66%)
totalTime: 4 min 9.7 sec, trainTime: 3 min 46.9 sec, testTime: 22.795 sec
{
    all: 100.00%,
    getBatch: 15.34%,
    predict+loss: 22.81%,
    backward: 48.32%,
    step: 1.97%,
    metrics_base: 0.60%,
    metrics_moe: 0.52%,
    evaluate: 9.08%,
    progressBar: 1.10%,
    other: 0.26%
}
-> RESULT
mean: [1.] (std: 0.0)
std: [0.] (mean: 0.0)
perClassPred: 
[[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]






model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="large", memoryMode=False).to(device)
└── Model: 3_177_416 params
    └── blocks: 3_177_416 params
        ├── Block_CNN[0]: 1_728 params
        ├── Block_CNN[1]: 73_984 params
        ├── Block_CNN[2]: 147_456 params
        ├── Block_CNN[3]: 147_456 params
        ├── Block_CNN[4]: 294_912 params
        ├── Block_CNN[5]: 1_180_672 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 393_408 params
        └── Block_FFD_Moe[9]: 937_800 params
            ├── gating: 2_316 params
            └── experts: 935_484 params
Epoch 1, train: (loss: 1.772, accuracy: 37.24%), test: (loss: 1.682, accuracy: 44.04%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.392, accuracy: 51.61%), test: (loss: 1.662, accuracy: 45.40%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.229, accuracy: 57.79%), test: (loss: 1.344, accuracy: 55.89%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.092, accuracy: 62.76%), test: (loss: 1.305, accuracy: 56.99%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9957, accuracy: 66.61%), test: (loss: 1.222, accuracy: 59.74%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.9176, accuracy: 69.64%), test: (loss: 1.284, accuracy: 60.28%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8616, accuracy: 71.64%), test: (loss: 1.132, accuracy: 64.82%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.801, accuracy: 73.62%), test: (loss: 0.9448, accuracy: 69.09%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7461, accuracy: 75.61%), test: (loss: 0.8541, accuracy: 72.27%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7131, accuracy: 76.82%), test: (loss: 0.9314, accuracy: 71.14%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.6847, accuracy: 77.69%), test: (loss: 0.8346, accuracy: 72.80%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6472, accuracy: 79.05%), test: (loss: 0.8801, accuracy: 72.40%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6008, accuracy: 79.92%), test: (loss: 0.8425, accuracy: 73.26%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.5875, accuracy: 80.60%), test: (loss: 0.7643, accuracy: 75.04%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.5642, accuracy: 81.17%), test: (loss: 0.7288, accuracy: 76.95%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.5391, accuracy: 82.18%), test: (loss: 0.6202, accuracy: 79.56%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5215, accuracy: 82.33%), test: (loss: 0.7345, accuracy: 76.11%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.4869, accuracy: 83.53%), test: (loss: 0.6377, accuracy: 79.01%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.4925, accuracy: 83.46%), test: (loss: 0.6831, accuracy: 77.58%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.4655, accuracy: 84.26%), test: (loss: 0.6674, accuracy: 78.27%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.4434, accuracy: 84.85%), test: (loss: 0.6289, accuracy: 79.60%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.4244, accuracy: 85.81%), test: (loss: 0.6315, accuracy: 79.58%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.4242, accuracy: 85.60%), test: (loss: 0.5882, accuracy: 80.88%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4186, accuracy: 85.77%), test: (loss: 0.5616, accuracy: 81.49%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.3942, accuracy: 86.76%), test: (loss: 0.5559, accuracy: 81.94%), lr: 1.0000e-03
    -> best accuracy, train: 86.76% (epoch 25), test: 81.94% (epoch 25)
eval (test) with no augments: (loss: 0.6412, accuracy: 81.52%)
totalTime: 4 min 42.8 sec, trainTime: 4 min 16.7 sec, testTime: 26.031 sec
{
    all: 100.00%,
    getBatch: 15.86%,
    predict+loss: 21.85%,
    backward: 48.22%,
    step: 2.15%,
    metrics_base: 0.50%,
    metrics_moe: 0.70%,
    evaluate: 9.21%,
    progressBar: 1.23%,
    other: 0.28%
}
-> RESULT
mean: [0.209 0.141 0.157 0.171 0.198 0.124] (std: 0.030)
std: [0.259 0.212 0.195 0.211 0.172 0.244] (mean: 0.215)
perClassPred: 
[[0.   0.   0.22 0.34 0.45 0.06 0.83 0.06 0.01 0.01]
 [0.03 0.67 0.04 0.02 0.01 0.02 0.05 0.18 0.01 0.41]
 [0.08 0.   0.39 0.39 0.05 0.56 0.03 0.1  0.01 0.  ]
 [0.   0.   0.15 0.13 0.43 0.35 0.04 0.63 0.   0.  ]
 [0.34 0.32 0.17 0.12 0.05 0.01 0.04 0.03 0.3  0.56]
 [0.55 0.   0.03 0.   0.01 0.   0.   0.   0.68 0.01]]



model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="large", memoryMode=False).to(device)
└── Model: 4_422_614 params
    └── blocks: 4_422_614 params
        ├── Block_CNN[0]: 1_728 params
        ├── Block_CNN[1]: 73_984 params
        ├── Block_CNN[2]: 147_456 params
        ├── Block_CNN[3]: 147_456 params
        ├── Block_CNN[4]: 294_912 params
        ├── Block_CNN[5]: 590_336 params
        ├── Block_FFD_Moe[6]: 3_156_492 params
        │   ├── gating: 3_084 params
        │   └── experts: 3_153_408 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 10_250 params
Epoch 1, train: (loss: 1.661, accuracy: 38.57%), test: (loss: 1.732, accuracy: 40.44%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.35, accuracy: 51.35%), test: (loss: 1.462, accuracy: 50.25%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.173, accuracy: 58.26%), test: (loss: 1.38, accuracy: 53.11%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.046, accuracy: 63.08%), test: (loss: 1.186, accuracy: 59.80%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9602, accuracy: 66.23%), test: (loss: 1.213, accuracy: 61.21%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8672, accuracy: 69.58%), test: (loss: 0.9305, accuracy: 68.07%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.7963, accuracy: 72.30%), test: (loss: 0.9818, accuracy: 66.94%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7524, accuracy: 73.80%), test: (loss: 0.8415, accuracy: 71.75%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.722, accuracy: 75.06%), test: (loss: 0.7857, accuracy: 73.44%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.6669, accuracy: 76.90%), test: (loss: 0.9153, accuracy: 70.73%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.639, accuracy: 77.92%), test: (loss: 0.8295, accuracy: 73.30%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6144, accuracy: 78.92%), test: (loss: 0.8731, accuracy: 71.57%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.573, accuracy: 80.33%), test: (loss: 0.852, accuracy: 72.50%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.5646, accuracy: 80.55%), test: (loss: 0.7452, accuracy: 75.04%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.5261, accuracy: 82.07%), test: (loss: 0.8349, accuracy: 72.68%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.5095, accuracy: 82.37%), test: (loss: 0.7156, accuracy: 76.13%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5068, accuracy: 82.64%), test: (loss: 0.7817, accuracy: 74.16%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.4907, accuracy: 83.02%), test: (loss: 0.6872, accuracy: 77.25%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.4529, accuracy: 84.26%), test: (loss: 0.7118, accuracy: 76.98%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.458, accuracy: 84.24%), test: (loss: 0.6116, accuracy: 79.55%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.4344, accuracy: 85.05%), test: (loss: 0.6331, accuracy: 78.93%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.427, accuracy: 85.33%), test: (loss: 0.628, accuracy: 79.46%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.4029, accuracy: 86.06%), test: (loss: 0.5949, accuracy: 80.64%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4121, accuracy: 85.71%), test: (loss: 0.6385, accuracy: 79.46%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.3781, accuracy: 86.86%), test: (loss: 0.569, accuracy: 81.17%), lr: 1.0000e-03
    -> best accuracy, train: 86.86% (epoch 25), test: 81.17% (epoch 25)
eval (test) with no augments: (loss: 0.7002, accuracy: 79.48%)
totalTime: 4 min 54.0 sec, trainTime: 4 min 27.8 sec, testTime: 26.207 sec
{
    all: 100.00%,
    getBatch: 13.14%,
    predict+loss: 22.79%,
    backward: 49.06%,
    step: 2.34%,
    metrics_base: 0.51%,
    metrics_moe: 1.62%,
    evaluate: 8.92%,
    progressBar: 1.37%,
    other: 0.26%
}
-> RESULT
mean: [0.195 0.17  0.144 0.191 0.138 0.162] (std: 0.021)
std: [0.196 0.115 0.155 0.134 0.106 0.126] (mean: 0.139)
perClassPred: 
[[0.35 0.53 0.05 0.04 0.04 0.03 0.03 0.05 0.42 0.43]
 [0.24 0.02 0.35 0.27 0.1  0.34 0.08 0.13 0.11 0.04]
 [0.01 0.02 0.13 0.3  0.16 0.24 0.52 0.06 0.02 0.03]
 [0.17 0.09 0.12 0.14 0.23 0.17 0.06 0.55 0.1  0.24]
 [0.19 0.32 0.09 0.06 0.05 0.06 0.04 0.06 0.32 0.21]
 [0.05 0.02 0.26 0.19 0.43 0.16 0.27 0.14 0.04 0.05]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v3(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="large", memoryMode=False).to(device)
└── Model: 4_422_614 params
    └── blocks: 4_422_614 params
        ├── Block_CNN[0]: 1_728 params
        ├── Block_CNN[1]: 73_984 params
        ├── Block_CNN[2]: 147_456 params
        ├── Block_CNN[3]: 147_456 params
        ├── Block_CNN[4]: 294_912 params
        ├── Block_FFD_Moe[5]: 3_156_492 params
        │   ├── gating: 3_084 params
        │   └── experts: 3_153_408 params
        ├── Block_CNN[6]: 590_336 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 10_250 params
Epoch 1, train: (loss: 1.715, accuracy: 37.51%), test: (loss: 1.759, accuracy: 40.12%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.378, accuracy: 50.56%), test: (loss: 1.454, accuracy: 49.59%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.228, accuracy: 56.65%), test: (loss: 1.236, accuracy: 57.33%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.097, accuracy: 61.38%), test: (loss: 1.158, accuracy: 59.83%), lr: 1.0000e-03
        Epoch 5, train: (loss: 1.007, accuracy: 64.86%), test: (loss: 1.417, accuracy: 56.40%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.9391, accuracy: 67.44%), test: (loss: 1.002, accuracy: 65.70%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8773, accuracy: 69.55%), test: (loss: 1.078, accuracy: 65.14%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8291, accuracy: 71.53%), test: (loss: 0.9184, accuracy: 68.36%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.779, accuracy: 73.25%), test: (loss: 0.8881, accuracy: 70.26%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7439, accuracy: 74.36%), test: (loss: 0.8423, accuracy: 71.26%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7074, accuracy: 75.93%), test: (loss: 0.8098, accuracy: 72.67%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6873, accuracy: 76.41%), test: (loss: 0.9761, accuracy: 68.31%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6542, accuracy: 77.52%), test: (loss: 0.7589, accuracy: 74.42%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6257, accuracy: 78.54%), test: (loss: 0.8354, accuracy: 71.33%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6212, accuracy: 79.12%), test: (loss: 0.7538, accuracy: 74.58%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.5867, accuracy: 79.95%), test: (loss: 0.6935, accuracy: 76.31%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5875, accuracy: 80.05%), test: (loss: 0.7416, accuracy: 75.48%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5591, accuracy: 81.11%), test: (loss: 0.695, accuracy: 77.12%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5515, accuracy: 81.33%), test: (loss: 0.7176, accuracy: 76.12%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5294, accuracy: 82.02%), test: (loss: 0.679, accuracy: 77.45%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5163, accuracy: 82.56%), test: (loss: 0.7491, accuracy: 75.15%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5024, accuracy: 82.92%), test: (loss: 0.7302, accuracy: 75.68%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.4922, accuracy: 83.25%), test: (loss: 0.668, accuracy: 77.57%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4865, accuracy: 83.39%), test: (loss: 0.6395, accuracy: 78.65%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.4644, accuracy: 84.23%), test: (loss: 0.6128, accuracy: 79.58%), lr: 1.0000e-03
    -> best accuracy, train: 84.23% (epoch 25), test: 79.58% (epoch 25)
eval (test) with no augments: (loss: 0.8045, accuracy: 77.19%)
totalTime: 7 min 2.9 sec, trainTime: 6 min 20.9 sec, testTime: 41.910 sec
{
    all: 100.00%,
    getBatch: 8.78%,
    predict+loss: 21.65%,
    backward: 46.40%,
    step: 1.56%,
    metrics_base: 0.34%,
    metrics_moe: 10.24%,
    evaluate: 9.91%,
    progressBar: 0.93%,
    other: 0.18%
}
-> RESULT
mean: [0.144 0.195 0.166 0.132 0.201 0.162] (std: 0.025)
std: [0.043 0.077 0.037 0.026 0.051 0.051] (mean: 0.048)
perClassPred: 
[[0.1  0.1  0.17 0.17 0.21 0.16 0.16 0.2  0.08 0.11]
 [0.29 0.22 0.21 0.17 0.12 0.13 0.12 0.12 0.36 0.19]
 [0.12 0.14 0.14 0.14 0.19 0.13 0.26 0.18 0.17 0.16]
 [0.1  0.13 0.11 0.17 0.13 0.13 0.15 0.12 0.1  0.18]
 [0.29 0.15 0.23 0.2  0.22 0.24 0.11 0.24 0.2  0.14]
 [0.1  0.25 0.14 0.15 0.14 0.2  0.21 0.14 0.09 0.22]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v4(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=6, topK=2, modelConfig="large", memoryMode=False).to(device)
└── Model: 5_214_434 params
    └── blocks: 5_214_434 params
        ├── Block_CNN[0]: 1_728 params
        ├── Block_CNN[1]: 73_984 params
        ├── Block_CNN[2]: 147_456 params
        ├── Block_CNN[3]: 147_456 params
        ├── Block_FFD_Moe[4]: 791_820 params
        │   ├── gating: 1_548 params
        │   └── experts: 790_272 params
        ├── Block_CNN[5]: 294_912 params
        ├── Block_FFD_Moe[6]: 3_156_492 params
        │   ├── gating: 3_084 params
        │   └── experts: 3_153_408 params
        ├── Block_CNN[7]: 590_336 params
        ├── Dropout[8]: 0 params
        ├── Flatten[9]: 0 params
        └── Linear[10]: 10_250 params
Epoch 1, train: (loss: 1.787, accuracy: 34.86%), test: (loss: 1.668, accuracy: 40.58%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.47, accuracy: 47.46%), test: (loss: 1.542, accuracy: 47.72%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.31, accuracy: 53.81%), test: (loss: 1.395, accuracy: 51.70%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.197, accuracy: 58.25%), test: (loss: 1.361, accuracy: 54.38%), lr: 1.0000e-03
        Epoch 5, train: (loss: 1.102, accuracy: 61.75%), test: (loss: 1.219, accuracy: 58.53%), lr: 1.0000e-03
        Epoch 6, train: (loss: 1.027, accuracy: 64.34%), test: (loss: 1.064, accuracy: 63.50%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.9777, accuracy: 66.19%), test: (loss: 1.042, accuracy: 64.24%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.9198, accuracy: 68.40%), test: (loss: 1.054, accuracy: 64.02%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.8828, accuracy: 69.55%), test: (loss: 1.029, accuracy: 65.97%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.8483, accuracy: 71.06%), test: (loss: 0.9707, accuracy: 66.59%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.8261, accuracy: 71.87%), test: (loss: 0.9308, accuracy: 68.75%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.7752, accuracy: 73.55%), test: (loss: 1.057, accuracy: 65.81%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.7575, accuracy: 74.17%), test: (loss: 0.8221, accuracy: 72.57%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.7277, accuracy: 75.28%), test: (loss: 0.9314, accuracy: 69.44%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.7144, accuracy: 75.64%), test: (loss: 0.8018, accuracy: 73.41%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.6879, accuracy: 76.71%), test: (loss: 0.8291, accuracy: 73.64%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.6639, accuracy: 77.51%), test: (loss: 0.8071, accuracy: 73.08%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.662, accuracy: 77.58%), test: (loss: 0.8063, accuracy: 74.14%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.6352, accuracy: 78.73%), test: (loss: 0.8114, accuracy: 73.24%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.618, accuracy: 79.22%), test: (loss: 0.7999, accuracy: 74.28%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.6107, accuracy: 79.54%), test: (loss: 0.7136, accuracy: 76.36%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5989, accuracy: 79.96%), test: (loss: 0.7386, accuracy: 75.51%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5776, accuracy: 80.81%), test: (loss: 0.7106, accuracy: 76.59%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5638, accuracy: 81.05%), test: (loss: 0.735, accuracy: 75.88%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.552, accuracy: 81.60%), test: (loss: 0.6953, accuracy: 77.12%), lr: 1.0000e-03
    -> best accuracy, train: 81.60% (epoch 25), test: 77.12% (epoch 25)
eval (test) with no augments: (loss: 0.6961, accuracy: 78.55%)
totalTime: 16 min 38.0 sec, trainTime: 14 min 33.9 sec, testTime: 2 min 4.0 sec
{
    all: 100.00%,
    getBatch: 3.93%,
    predict+loss: 17.54%,
    backward: 37.52%,
    step: 0.94%,
    metrics_base: 0.14%,
    metrics_moe: 26.93%,
    evaluate: 12.43%,
    progressBar: 0.48%,
    other: 0.10%
}
-> RESULT
mean: [0.146 0.179 0.163 0.169 0.175 0.168] (std: 0.01)
std: [0.018 0.037 0.022 0.016 0.014 0.026] (mean: 0.022)
perClassPred: 
[[0.11 0.15 0.14 0.15 0.15 0.16 0.17 0.15 0.12 0.16]
 [0.12 0.13 0.19 0.18 0.24 0.19 0.2  0.22 0.13 0.15]
 [0.15 0.2  0.15 0.17 0.13 0.16 0.18 0.15 0.16 0.2 ]
 [0.2  0.16 0.18 0.16 0.18 0.16 0.16 0.16 0.19 0.15]
 [0.2  0.18 0.18 0.18 0.16 0.17 0.16 0.16 0.2  0.17]
 [0.21 0.18 0.17 0.17 0.14 0.17 0.13 0.15 0.21 0.17]]
-> RESULT
mean: [0.175 0.15  0.131 0.221 0.151 0.172] (std: 0.029)
std: [0.056 0.037 0.048 0.072 0.077 0.05 ] (mean: 0.057)
perClassPred: 
[[0.15 0.27 0.12 0.15 0.14 0.17 0.19 0.15 0.15 0.3 ]
 [0.12 0.12 0.16 0.16 0.19 0.12 0.24 0.13 0.13 0.13]
 [0.09 0.21 0.09 0.12 0.08 0.17 0.14 0.14 0.08 0.21]
 [0.16 0.15 0.23 0.28 0.28 0.26 0.26 0.32 0.11 0.12]
 [0.3  0.09 0.2  0.17 0.09 0.17 0.05 0.09 0.25 0.09]
 [0.18 0.16 0.2  0.13 0.23 0.11 0.13 0.16 0.28 0.14]]




model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=24, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 7_445_930 params
    └── blocks: 7_445_930 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Block_FFD_Moe[6]: 7_110_192 params
        │   ├── gating: 9_264 params
        │   └── experts: 7_100_928 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.761, accuracy: 36.84%), test: (loss: 2.077, accuracy: 37.24%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.404, accuracy: 51.16%), test: (loss: 1.499, accuracy: 50.20%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.235, accuracy: 57.55%), test: (loss: 1.476, accuracy: 52.83%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.128, accuracy: 61.46%), test: (loss: 1.318, accuracy: 56.80%), lr: 1.0000e-03
        Epoch 5, train: (loss: 1.033, accuracy: 65.38%), test: (loss: 1.3, accuracy: 59.46%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.9696, accuracy: 67.57%), test: (loss: 1.333, accuracy: 58.41%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.9006, accuracy: 70.25%), test: (loss: 1.081, accuracy: 66.31%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8573, accuracy: 71.72%), test: (loss: 1.255, accuracy: 62.47%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.8136, accuracy: 72.95%), test: (loss: 1.02, accuracy: 67.78%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7846, accuracy: 74.02%), test: (loss: 0.906, accuracy: 70.97%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7491, accuracy: 75.44%), test: (loss: 0.9928, accuracy: 68.27%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.7084, accuracy: 76.59%), test: (loss: 0.88, accuracy: 71.73%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6919, accuracy: 77.38%), test: (loss: 0.8021, accuracy: 74.29%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6683, accuracy: 78.01%), test: (loss: 0.9176, accuracy: 71.07%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6484, accuracy: 78.94%), test: (loss: 0.8522, accuracy: 73.35%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.6426, accuracy: 78.87%), test: (loss: 0.9213, accuracy: 72.46%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.6266, accuracy: 79.42%), test: (loss: 0.9694, accuracy: 69.14%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.6036, accuracy: 80.08%), test: (loss: 0.9892, accuracy: 71.29%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.5743, accuracy: 81.31%), test: (loss: 0.7822, accuracy: 75.04%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5746, accuracy: 81.18%), test: (loss: 0.8538, accuracy: 73.57%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5618, accuracy: 81.54%), test: (loss: 0.7726, accuracy: 75.92%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5448, accuracy: 82.29%), test: (loss: 0.7739, accuracy: 75.50%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5444, accuracy: 82.31%), test: (loss: 0.8728, accuracy: 73.40%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.5353, accuracy: 82.53%), test: (loss: 0.7347, accuracy: 77.19%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.521, accuracy: 83.02%), test: (loss: 0.7527, accuracy: 77.12%), lr: 1.0000e-03
    -> best accuracy, train: 83.02% (epoch 25), test: 77.19% (epoch 24)
eval (test) with no augments: (loss: 0.8513, accuracy: 76.59%)
totalTime: 5 min 50.0 sec, trainTime: 5 min 19.4 sec, testTime: 30.568 sec
{
    all: 100.00%,
    getBatch: 11.21%,
    predict+loss: 21.77%,
    backward: 47.29%,
    step: 5.09%,
    metrics_base: 0.41%,
    metrics_moe: 3.99%,
    evaluate: 8.73%,
    progressBar: 1.16%,
    other: 0.35%
}
-> RESULT
mean: [0.047 0.074 0.032 0.054 0.023 0.    0.043 0.049 0.046 0.025 0.    0.035 0.049 0.077 0.031 0.028 0.022 0.051 0.055 0.072 0.039 0.047 0.027 0.074] (std: 0.02)
std: [0.077 0.072 0.03  0.048 0.05  0.    0.033 0.044 0.026 0.054 0.    0.043 0.055 0.061 0.039 0.019 0.038 0.032 0.042 0.067 0.054 0.074 0.033 0.066] (mean: 0.044)
perClassPred: 
[[0.12 0.02 0.02 0.01 0.02 0.01 0.01 0.   0.26 0.01]
 [0.01 0.01 0.02 0.08 0.17 0.09 0.06 0.23 0.   0.03]
 [0.11 0.04 0.03 0.02 0.01 0.01 0.   0.02 0.04 0.02]
 [0.01 0.04 0.01 0.07 0.02 0.05 0.08 0.03 0.03 0.18]
 [0.03 0.17 0.01 0.   0.   0.   0.   0.   0.03 0.02]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.05 0.02 0.13 0.05 0.03 0.03 0.03 0.06 0.02 0.01]
 [0.03 0.09 0.05 0.03 0.03 0.03 0.02 0.03 0.02 0.17]
 [0.09 0.02 0.08 0.04 0.08 0.03 0.04 0.06 0.02 0.01]
 [0.   0.   0.03 0.02 0.02 0.02 0.19 0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.06 0.02 0.03 0.15 0.01 0.04 0.   0.01]
 [0.09 0.06 0.01 0.01 0.01 0.   0.   0.02 0.11 0.18]
 [0.03 0.04 0.06 0.18 0.04 0.2  0.03 0.08 0.04 0.03]
 [0.01 0.   0.06 0.01 0.11 0.01 0.1  0.01 0.01 0.01]
 [0.02 0.01 0.07 0.05 0.02 0.04 0.02 0.03 0.01 0.01]
 [0.   0.   0.01 0.01 0.05 0.01 0.13 0.02 0.   0.  ]
 [0.07 0.04 0.03 0.02 0.07 0.01 0.01 0.12 0.07 0.05]
 [0.08 0.01 0.07 0.03 0.09 0.02 0.01 0.15 0.05 0.03]
 [0.02 0.02 0.07 0.17 0.14 0.07 0.2  0.02 0.02 0.01]
 [0.13 0.04 0.02 0.01 0.01 0.   0.   0.   0.16 0.03]
 [0.05 0.25 0.01 0.01 0.01 0.01 0.   0.02 0.03 0.12]
 [0.05 0.09 0.   0.01 0.   0.   0.   0.   0.08 0.05]
 [0.01 0.   0.12 0.16 0.05 0.21 0.06 0.06 0.01 0.02]]






model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v2(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=12, topK=2, modelConfig="medium", memoryMode=False).to(device)
└── Model: 3_890_834 params
    └── blocks: 3_890_834 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Block_FFD_Moe[6]: 3_555_096 params
        │   ├── gating: 4_632 params
        │   └── experts: 3_550_464 params
        ├── Dropout[7]: 0 params
        ├── Flatten[8]: 0 params
        └── Linear[9]: 7_690 params
Epoch 1, train: (loss: 1.706, accuracy: 37.37%), test: (loss: 1.693, accuracy: 42.27%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.359, accuracy: 51.23%), test: (loss: 1.766, accuracy: 41.08%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.209, accuracy: 57.21%), test: (loss: 1.358, accuracy: 54.47%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.092, accuracy: 61.73%), test: (loss: 1.333, accuracy: 56.97%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9906, accuracy: 65.51%), test: (loss: 1.181, accuracy: 60.32%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.9236, accuracy: 68.05%), test: (loss: 1.125, accuracy: 63.48%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8794, accuracy: 69.52%), test: (loss: 1.088, accuracy: 63.99%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.8255, accuracy: 71.67%), test: (loss: 1.184, accuracy: 62.71%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7761, accuracy: 73.37%), test: (loss: 0.9057, accuracy: 69.35%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7341, accuracy: 74.80%), test: (loss: 1.041, accuracy: 65.89%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7302, accuracy: 75.17%), test: (loss: 0.9411, accuracy: 68.96%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.6828, accuracy: 76.57%), test: (loss: 0.8903, accuracy: 70.99%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6747, accuracy: 76.96%), test: (loss: 0.786, accuracy: 73.64%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6491, accuracy: 77.86%), test: (loss: 0.7971, accuracy: 73.18%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6283, accuracy: 78.39%), test: (loss: 0.7749, accuracy: 74.32%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.6067, accuracy: 79.12%), test: (loss: 0.8361, accuracy: 72.60%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.5886, accuracy: 79.87%), test: (loss: 0.8224, accuracy: 73.30%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5754, accuracy: 80.19%), test: (loss: 0.8107, accuracy: 73.61%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.578, accuracy: 80.17%), test: (loss: 0.7808, accuracy: 74.88%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5446, accuracy: 81.38%), test: (loss: 0.784, accuracy: 74.35%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5434, accuracy: 81.40%), test: (loss: 0.784, accuracy: 74.70%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.519, accuracy: 82.19%), test: (loss: 0.794, accuracy: 74.40%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5122, accuracy: 82.39%), test: (loss: 0.788, accuracy: 74.33%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.4994, accuracy: 83.03%), test: (loss: 0.7816, accuracy: 74.52%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.4877, accuracy: 83.35%), test: (loss: 0.724, accuracy: 77.31%), lr: 1.0000e-03
    -> best accuracy, train: 83.35% (epoch 25), test: 77.31% (epoch 25)
eval (test) with no augments: (loss: 0.8655, accuracy: 76.26%)
totalTime: 4 min 12.9 sec, trainTime: 3 min 48.0 sec, testTime: 24.851 sec
{
    all: 100.00%,
    getBatch: 16.10%,
    predict+loss: 21.76%,
    backward: 43.46%,
    step: 3.58%,
    metrics_base: 0.62%,
    metrics_moe: 3.19%,
    evaluate: 9.83%,
    progressBar: 1.09%,
    other: 0.38%
}
-> RESULT
mean: [0.098 0.085 0.098 0.064 0.116 0.085 0.098 0.073 0.044 0.095 0.077 0.067] (std: 0.019)
std: [0.098 0.089 0.074 0.08  0.055 0.101 0.128 0.057 0.031 0.033 0.058 0.079] (mean: 0.074)
perClassPred: 
[[0.01 0.01 0.11 0.07 0.23 0.09 0.14 0.31 0.01 0.01]
 [0.02 0.01 0.13 0.22 0.04 0.27 0.03 0.08 0.01 0.02]
 [0.23 0.08 0.11 0.07 0.04 0.03 0.1  0.02 0.24 0.05]
 [0.02 0.26 0.02 0.02 0.04 0.02 0.03 0.07 0.01 0.18]
 [0.06 0.02 0.13 0.17 0.22 0.15 0.09 0.1  0.12 0.1 ]
 [0.08 0.31 0.02 0.02 0.02 0.01 0.01 0.03 0.17 0.21]
 [0.01 0.01 0.12 0.1  0.2  0.04 0.44 0.02 0.01 0.02]
 [0.02 0.1  0.03 0.07 0.02 0.14 0.05 0.07 0.01 0.2 ]
 [0.02 0.   0.1  0.07 0.05 0.05 0.06 0.08 0.01 0.01]
 [0.1  0.07 0.08 0.09 0.07 0.13 0.02 0.13 0.12 0.12]
 [0.22 0.03 0.13 0.09 0.06 0.06 0.02 0.06 0.06 0.01]
 [0.2  0.09 0.02 0.01 0.02 0.   0.01 0.02 0.22 0.07]]













###### bonnus (using "basic+degrade")

model = moeModel = MoE_models.paper2.VisionModelMoe.get_cifar_v1(
    nbClasses=datasHandler.nbClasses, wImp=0.1, wLoad=0.1,
    nbExperts=1, topK=1, modelConfig="medium", memoryMode=False).to(device)
└── Model: 497_916 params
    └── blocks: 497_916 params
        ├── Block_CNN[0]: 432 params
        ├── Block_CNN[1]: 4_672 params
        ├── Block_CNN[2]: 9_216 params
        ├── Block_CNN[3]: 18_432 params
        ├── Block_CNN[4]: 73_728 params
        ├── Block_CNN[5]: 221_568 params
        ├── Dropout[6]: 0 params
        ├── Flatten[7]: 0 params
        ├── Linear[8]: 98_432 params
        └── Block_FFD_Moe[9]: 71_436 params
            ├── gating: 258 params
            └── experts: 71_178 params
Epoch 1, train: (loss: 1.591, accuracy: 41.34%), test: (loss: 1.366, accuracy: 50.87%), lr: 1.0000e-03
        Epoch 2, train: (loss: 1.284, accuracy: 53.85%), test: (loss: 1.297, accuracy: 53.31%), lr: 1.0000e-03
        Epoch 3, train: (loss: 1.12, accuracy: 60.07%), test: (loss: 1.157, accuracy: 59.38%), lr: 1.0000e-03
        Epoch 4, train: (loss: 1.013, accuracy: 64.33%), test: (loss: 1.074, accuracy: 62.50%), lr: 1.0000e-03
        Epoch 5, train: (loss: 0.9427, accuracy: 66.94%), test: (loss: 0.916, accuracy: 67.92%), lr: 1.0000e-03
        Epoch 6, train: (loss: 0.8796, accuracy: 68.98%), test: (loss: 0.9225, accuracy: 67.88%), lr: 1.0000e-03
        Epoch 7, train: (loss: 0.8299, accuracy: 70.75%), test: (loss: 0.8084, accuracy: 71.79%), lr: 1.0000e-03
        Epoch 8, train: (loss: 0.7895, accuracy: 72.57%), test: (loss: 0.8411, accuracy: 71.30%), lr: 1.0000e-03
        Epoch 9, train: (loss: 0.7492, accuracy: 73.76%), test: (loss: 0.7976, accuracy: 72.53%), lr: 1.0000e-03
        Epoch 10, train: (loss: 0.7297, accuracy: 74.45%), test: (loss: 0.7462, accuracy: 74.47%), lr: 1.0000e-03
        Epoch 11, train: (loss: 0.7035, accuracy: 75.39%), test: (loss: 0.7423, accuracy: 74.76%), lr: 1.0000e-03
        Epoch 12, train: (loss: 0.684, accuracy: 76.33%), test: (loss: 0.7445, accuracy: 74.65%), lr: 1.0000e-03
        Epoch 13, train: (loss: 0.6645, accuracy: 76.83%), test: (loss: 0.695, accuracy: 75.91%), lr: 1.0000e-03
        Epoch 14, train: (loss: 0.6453, accuracy: 77.39%), test: (loss: 0.7333, accuracy: 74.58%), lr: 1.0000e-03
        Epoch 15, train: (loss: 0.6299, accuracy: 78.19%), test: (loss: 0.6841, accuracy: 76.26%), lr: 1.0000e-03
        Epoch 16, train: (loss: 0.614, accuracy: 78.59%), test: (loss: 0.6666, accuracy: 77.36%), lr: 1.0000e-03
        Epoch 17, train: (loss: 0.617, accuracy: 78.61%), test: (loss: 0.6687, accuracy: 77.35%), lr: 1.0000e-03
        Epoch 18, train: (loss: 0.5934, accuracy: 79.21%), test: (loss: 0.6478, accuracy: 77.68%), lr: 1.0000e-03
        Epoch 19, train: (loss: 0.581, accuracy: 79.78%), test: (loss: 0.7126, accuracy: 76.14%), lr: 1.0000e-03
        Epoch 20, train: (loss: 0.5631, accuracy: 80.41%), test: (loss: 0.6787, accuracy: 76.97%), lr: 1.0000e-03
        Epoch 21, train: (loss: 0.5598, accuracy: 80.49%), test: (loss: 0.6205, accuracy: 78.49%), lr: 1.0000e-03
        Epoch 22, train: (loss: 0.5555, accuracy: 80.69%), test: (loss: 0.6136, accuracy: 78.85%), lr: 1.0000e-03
        Epoch 23, train: (loss: 0.5442, accuracy: 81.01%), test: (loss: 0.6123, accuracy: 79.45%), lr: 1.0000e-03
        Epoch 24, train: (loss: 0.532, accuracy: 81.46%), test: (loss: 0.7373, accuracy: 76.12%), lr: 1.0000e-03
        Epoch 25, train: (loss: 0.5251, accuracy: 81.75%), test: (loss: 0.6006, accuracy: 79.70%), lr: 1.0000e-03
        Epoch 26, train: (loss: 0.5227, accuracy: 81.78%), test: (loss: 0.5826, accuracy: 80.18%), lr: 1.0000e-03
        Epoch 27, train: (loss: 0.5136, accuracy: 82.00%), test: (loss: 0.6124, accuracy: 79.43%), lr: 1.0000e-03
        Epoch 28, train: (loss: 0.5101, accuracy: 82.05%), test: (loss: 0.5873, accuracy: 80.10%), lr: 1.0000e-03
        Epoch 29, train: (loss: 0.4963, accuracy: 82.63%), test: (loss: 0.6192, accuracy: 78.90%), lr: 1.0000e-03
        Epoch 30, train: (loss: 0.4946, accuracy: 82.86%), test: (loss: 0.5922, accuracy: 80.29%), lr: 1.0000e-03
        Epoch 31, train: (loss: 0.4915, accuracy: 82.91%), test: (loss: 0.6037, accuracy: 79.33%), lr: 1.0000e-03
        Epoch 32, train: (loss: 0.4845, accuracy: 83.01%), test: (loss: 0.5702, accuracy: 80.41%), lr: 1.0000e-03
        Epoch 33, train: (loss: 0.4766, accuracy: 83.51%), test: (loss: 0.5665, accuracy: 80.76%), lr: 1.0000e-03
        Epoch 34, train: (loss: 0.4796, accuracy: 83.26%), test: (loss: 0.5588, accuracy: 80.59%), lr: 1.0000e-03
        Epoch 35, train: (loss: 0.471, accuracy: 83.50%), test: (loss: 0.5714, accuracy: 81.12%), lr: 1.0000e-03
        Epoch 36, train: (loss: 0.4636, accuracy: 83.73%), test: (loss: 0.5758, accuracy: 80.73%), lr: 1.0000e-03
        Epoch 37, train: (loss: 0.4584, accuracy: 83.78%), test: (loss: 0.5519, accuracy: 81.76%), lr: 1.0000e-03
        Epoch 38, train: (loss: 0.4572, accuracy: 84.20%), test: (loss: 0.5724, accuracy: 80.73%), lr: 1.0000e-03
        Epoch 39, train: (loss: 0.4516, accuracy: 84.25%), test: (loss: 0.5753, accuracy: 80.67%), lr: 1.0000e-03
        Epoch 40, train: (loss: 0.4446, accuracy: 84.52%), test: (loss: 0.5783, accuracy: 80.93%), lr: 1.0000e-03
        Epoch 41, train: (loss: 0.442, accuracy: 84.60%), test: (loss: 0.5685, accuracy: 81.39%), lr: 1.0000e-03
        Epoch 42, train: (loss: 0.4408, accuracy: 84.67%), test: (loss: 0.5686, accuracy: 80.61%), lr: 1.0000e-03
        Epoch 43, train: (loss: 0.4395, accuracy: 84.66%), test: (loss: 0.5912, accuracy: 80.63%), lr: 1.0000e-03
        Epoch 44, train: (loss: 0.4364, accuracy: 84.73%), test: (loss: 0.585, accuracy: 80.37%), lr: 1.0000e-03
        Epoch 45, train: (loss: 0.4301, accuracy: 84.99%), test: (loss: 0.5377, accuracy: 81.92%), lr: 1.0000e-03
        Epoch 46, train: (loss: 0.4236, accuracy: 85.36%), test: (loss: 0.5896, accuracy: 80.58%), lr: 1.0000e-03
        Epoch 47, train: (loss: 0.4175, accuracy: 85.39%), test: (loss: 0.5253, accuracy: 82.03%), lr: 1.0000e-03
        Epoch 48, train: (loss: 0.4154, accuracy: 85.45%), test: (loss: 0.542, accuracy: 81.79%), lr: 1.0000e-03
        Epoch 49, train: (loss: 0.4143, accuracy: 85.52%), test: (loss: 0.5419, accuracy: 81.80%), lr: 1.0000e-03
        Epoch 50, train: (loss: 0.4116, accuracy: 85.54%), test: (loss: 0.5345, accuracy: 81.88%), lr: 1.0000e-03
        Epoch 51, train: (loss: 0.4056, accuracy: 85.86%), test: (loss: 0.5038, accuracy: 83.38%), lr: 1.0000e-03
        Epoch 52, train: (loss: 0.4072, accuracy: 85.71%), test: (loss: 0.5459, accuracy: 81.42%), lr: 1.0000e-03
        Epoch 53, train: (loss: 0.4026, accuracy: 85.80%), test: (loss: 0.5265, accuracy: 82.38%), lr: 1.0000e-03
        Epoch 54, train: (loss: 0.4009, accuracy: 85.99%), test: (loss: 0.5236, accuracy: 82.51%), lr: 1.0000e-03
        Epoch 55, train: (loss: 0.3967, accuracy: 86.22%), test: (loss: 0.5259, accuracy: 82.83%), lr: 1.0000e-03
        Epoch 56, train: (loss: 0.3929, accuracy: 86.25%), test: (loss: 0.5028, accuracy: 83.50%), lr: 1.0000e-03
        Epoch 57, train: (loss: 0.3887, accuracy: 86.27%), test: (loss: 0.5272, accuracy: 82.56%), lr: 1.0000e-03
        Epoch 58, train: (loss: 0.3906, accuracy: 86.22%), test: (loss: 0.5359, accuracy: 82.50%), lr: 1.0000e-03
        Epoch 59, train: (loss: 0.3852, accuracy: 86.40%), test: (loss: 0.5556, accuracy: 81.78%), lr: 1.0000e-03
        Epoch 60, train: (loss: 0.381, accuracy: 86.75%), test: (loss: 0.5243, accuracy: 82.57%), lr: 1.0000e-03
        Epoch 61, train: (loss: 0.3807, accuracy: 86.52%), test: (loss: 0.5227, accuracy: 82.66%), lr: 1.0000e-03
        Epoch 62, train: (loss: 0.3828, accuracy: 86.52%), test: (loss: 0.514, accuracy: 82.53%), lr: 1.0000e-03
        Epoch 63, train: (loss: 0.3729, accuracy: 86.88%), test: (loss: 0.5114, accuracy: 83.08%), lr: 1.0000e-03
        Epoch 64, train: (loss: 0.3787, accuracy: 86.72%), test: (loss: 0.5169, accuracy: 82.99%), lr: 1.0000e-03
        Epoch 65, train: (loss: 0.3686, accuracy: 86.96%), test: (loss: 0.5171, accuracy: 82.88%), lr: 1.0000e-03
        Epoch 66, train: (loss: 0.3665, accuracy: 87.10%), test: (loss: 0.5112, accuracy: 83.07%), lr: 1.0000e-03
        Epoch 67, train: (loss: 0.3611, accuracy: 87.33%), test: (loss: 0.5141, accuracy: 83.15%), lr: 1.0000e-03
        Epoch 68, train: (loss: 0.3706, accuracy: 87.16%), test: (loss: 0.5392, accuracy: 82.47%), lr: 1.0000e-03
        Epoch 69, train: (loss: 0.3624, accuracy: 87.21%), test: (loss: 0.5778, accuracy: 81.51%), lr: 1.0000e-03
        Epoch 70, train: (loss: 0.3585, accuracy: 87.49%), test: (loss: 0.5032, accuracy: 83.14%), lr: 1.0000e-03
        Epoch 71, train: (loss: 0.3597, accuracy: 87.31%), test: (loss: 0.5238, accuracy: 82.38%), lr: 1.0000e-03
        Epoch 72, train: (loss: 0.3583, accuracy: 87.36%), test: (loss: 0.5105, accuracy: 83.16%), lr: 1.0000e-03
        Epoch 73, train: (loss: 0.3552, accuracy: 87.60%), test: (loss: 0.5085, accuracy: 82.92%), lr: 1.0000e-03
        Epoch 74, train: (loss: 0.3546, accuracy: 87.44%), test: (loss: 0.5148, accuracy: 83.25%), lr: 1.0000e-03
        Epoch 75, train: (loss: 0.3493, accuracy: 87.82%), test: (loss: 0.5101, accuracy: 83.43%), lr: 1.0000e-03
        Epoch 76, train: (loss: 0.3497, accuracy: 87.76%), test: (loss: 0.5191, accuracy: 82.70%), lr: 1.0000e-03
        Epoch 77, train: (loss: 0.3467, accuracy: 87.91%), test: (loss: 0.4967, accuracy: 83.68%), lr: 1.0000e-03
        Epoch 78, train: (loss: 0.3417, accuracy: 88.04%), test: (loss: 0.5328, accuracy: 82.76%), lr: 1.0000e-03
        Epoch 79, train: (loss: 0.3464, accuracy: 87.85%), test: (loss: 0.5159, accuracy: 83.21%), lr: 1.0000e-03
        Epoch 80, train: (loss: 0.3431, accuracy: 87.87%), test: (loss: 0.4989, accuracy: 83.40%), lr: 1.0000e-03
        Epoch 81, train: (loss: 0.3413, accuracy: 88.08%), test: (loss: 0.5085, accuracy: 83.01%), lr: 1.0000e-03
        Epoch 82, train: (loss: 0.3399, accuracy: 87.80%), test: (loss: 0.5058, accuracy: 83.42%), lr: 1.0000e-03
        Epoch 83, train: (loss: 0.3387, accuracy: 88.16%), test: (loss: 0.522, accuracy: 82.89%), lr: 1.0000e-03
        Epoch 84, train: (loss: 0.338, accuracy: 88.18%), test: (loss: 0.4982, accuracy: 83.45%), lr: 1.0000e-03
        Epoch 85, train: (loss: 0.3291, accuracy: 88.34%), test: (loss: 0.5116, accuracy: 83.42%), lr: 1.0000e-03
        Epoch 86, train: (loss: 0.3365, accuracy: 88.16%), test: (loss: 0.4919, accuracy: 83.78%), lr: 1.0000e-03
        Epoch 87, train: (loss: 0.3361, accuracy: 88.27%), test: (loss: 0.5155, accuracy: 83.17%), lr: 1.0000e-03
        Epoch 88, train: (loss: 0.3296, accuracy: 88.44%), test: (loss: 0.5152, accuracy: 84.04%), lr: 1.0000e-03
        Epoch 89, train: (loss: 0.3287, accuracy: 88.43%), test: (loss: 0.4822, accuracy: 84.42%), lr: 1.0000e-03
        Epoch 90, train: (loss: 0.3269, accuracy: 88.42%), test: (loss: 0.4953, accuracy: 84.18%), lr: 1.0000e-03
        Epoch 91, train: (loss: 0.3229, accuracy: 88.61%), test: (loss: 0.4738, accuracy: 84.30%), lr: 1.0000e-03
        Epoch 92, train: (loss: 0.3279, accuracy: 88.51%), test: (loss: 0.4913, accuracy: 83.95%), lr: 1.0000e-03
        Epoch 93, train: (loss: 0.3206, accuracy: 88.76%), test: (loss: 0.5094, accuracy: 83.19%), lr: 1.0000e-03
        Epoch 94, train: (loss: 0.3223, accuracy: 88.72%), test: (loss: 0.4906, accuracy: 84.47%), lr: 1.0000e-03
        Epoch 95, train: (loss: 0.3155, accuracy: 88.91%), test: (loss: 0.4872, accuracy: 84.31%), lr: 1.0000e-03
        Epoch 96, train: (loss: 0.3135, accuracy: 89.00%), test: (loss: 0.5128, accuracy: 83.55%), lr: 1.0000e-03
        Epoch 97, train: (loss: 0.3204, accuracy: 88.81%), test: (loss: 0.5086, accuracy: 83.37%), lr: 1.0000e-03
        Epoch 98, train: (loss: 0.3148, accuracy: 88.87%), test: (loss: 0.5006, accuracy: 83.25%), lr: 1.0000e-03
        Epoch 99, train: (loss: 0.3134, accuracy: 88.87%), test: (loss: 0.4865, accuracy: 84.13%), lr: 1.0000e-03
        Epoch 100, train: (loss: 0.3124, accuracy: 89.03%), test: (loss: 0.4799, accuracy: 84.40%), lr: 1.0000e-03
        Epoch 101, train: (loss: 0.3094, accuracy: 89.02%), test: (loss: 0.5002, accuracy: 83.62%), lr: 1.0000e-03
        Epoch 102, train: (loss: 0.3102, accuracy: 89.05%), test: (loss: 0.4803, accuracy: 84.52%), lr: 1.0000e-03
        Epoch 103, train: (loss: 0.3132, accuracy: 88.87%), test: (loss: 0.485, accuracy: 84.38%), lr: 1.0000e-03
        Epoch 104, train: (loss: 0.3091, accuracy: 89.00%), test: (loss: 0.54, accuracy: 83.25%), lr: 1.0000e-03
        Epoch 105, train: (loss: 0.3081, accuracy: 89.22%), test: (loss: 0.4782, accuracy: 84.19%), lr: 1.0000e-03
        Epoch 106, train: (loss: 0.3077, accuracy: 89.24%), test: (loss: 0.501, accuracy: 83.79%), lr: 1.0000e-03
        Epoch 107, train: (loss: 0.3048, accuracy: 89.28%), test: (loss: 0.5014, accuracy: 83.87%), lr: 1.0000e-03
        Epoch 108, train: (loss: 0.3035, accuracy: 89.31%), test: (loss: 0.484, accuracy: 84.22%), lr: 1.0000e-03
        Epoch 109, train: (loss: 0.3009, accuracy: 89.30%), test: (loss: 0.4791, accuracy: 84.58%), lr: 1.0000e-03
        Epoch 110, train: (loss: 0.3044, accuracy: 89.04%), test: (loss: 0.4994, accuracy: 84.12%), lr: 1.0000e-03
        Epoch 111, train: (loss: 0.295, accuracy: 89.62%), test: (loss: 0.5316, accuracy: 83.23%), lr: 1.0000e-03
        Epoch 112, train: (loss: 0.3022, accuracy: 89.45%), test: (loss: 0.4781, accuracy: 84.40%), lr: 1.0000e-03
        Epoch 113, train: (loss: 0.2974, accuracy: 89.50%), test: (loss: 0.5365, accuracy: 83.60%), lr: 1.0000e-03
        Epoch 114, train: (loss: 0.2952, accuracy: 89.69%), test: (loss: 0.5191, accuracy: 83.44%), lr: 1.0000e-03
        Epoch 115, train: (loss: 0.2923, accuracy: 89.81%), test: (loss: 0.4892, accuracy: 84.10%), lr: 1.0000e-03
        Epoch 116, train: (loss: 0.2965, accuracy: 89.51%), test: (loss: 0.5061, accuracy: 83.97%), lr: 1.0000e-03
        Epoch 117, train: (loss: 0.296, accuracy: 89.51%), test: (loss: 0.498, accuracy: 83.63%), lr: 1.0000e-03
        Epoch 118, train: (loss: 0.2977, accuracy: 89.63%), test: (loss: 0.513, accuracy: 83.76%), lr: 1.0000e-03
        Epoch 119, train: (loss: 0.2966, accuracy: 89.55%), test: (loss: 0.4746, accuracy: 84.74%), lr: 1.0000e-03
        Epoch 120, train: (loss: 0.2878, accuracy: 89.81%), test: (loss: 0.4695, accuracy: 84.65%), lr: 1.0000e-03
        Epoch 121, train: (loss: 0.2939, accuracy: 89.65%), test: (loss: 0.4656, accuracy: 84.66%), lr: 1.0000e-03
        Epoch 122, train: (loss: 0.2903, accuracy: 89.77%), test: (loss: 0.4787, accuracy: 84.66%), lr: 1.0000e-03
        Epoch 123, train: (loss: 0.2928, accuracy: 89.81%), test: (loss: 0.4652, accuracy: 84.43%), lr: 1.0000e-03
        Epoch 124, train: (loss: 0.2823, accuracy: 89.91%), test: (loss: 0.51, accuracy: 83.41%), lr: 1.0000e-03
        Epoch 125, train: (loss: 0.2851, accuracy: 90.01%), test: (loss: 0.4968, accuracy: 84.63%), lr: 1.0000e-03
        Epoch 126, train: (loss: 0.287, accuracy: 89.97%), test: (loss: 0.4733, accuracy: 84.72%), lr: 1.0000e-03
        Epoch 127, train: (loss: 0.2809, accuracy: 90.20%), test: (loss: 0.4659, accuracy: 85.08%), lr: 1.0000e-03
        Epoch 128, train: (loss: 0.2791, accuracy: 90.14%), test: (loss: 0.4833, accuracy: 84.55%), lr: 1.0000e-03
        Epoch 129, train: (loss: 0.2807, accuracy: 90.12%), test: (loss: 0.5024, accuracy: 83.68%), lr: 1.0000e-03
        Epoch 130, train: (loss: 0.2828, accuracy: 90.08%), test: (loss: 0.4743, accuracy: 85.05%), lr: 1.0000e-03
        Epoch 131, train: (loss: 0.2784, accuracy: 90.04%), test: (loss: 0.4855, accuracy: 84.37%), lr: 1.0000e-03
        Epoch 132, train: (loss: 0.2759, accuracy: 90.21%), test: (loss: 0.4687, accuracy: 84.95%), lr: 1.0000e-03
        Epoch 133, train: (loss: 0.2771, accuracy: 90.30%), test: (loss: 0.4813, accuracy: 84.65%), lr: 1.0000e-03
        Epoch 134, train: (loss: 0.2775, accuracy: 90.07%), test: (loss: 0.4956, accuracy: 84.28%), lr: 1.0000e-03
        Epoch 135, train: (loss: 0.2814, accuracy: 90.16%), test: (loss: 0.4717, accuracy: 84.39%), lr: 1.0000e-03
        Epoch 136, train: (loss: 0.2795, accuracy: 90.36%), test: (loss: 0.4808, accuracy: 84.29%), lr: 1.0000e-03
        Epoch 137, train: (loss: 0.2771, accuracy: 90.30%), test: (loss: 0.468, accuracy: 84.99%), lr: 1.0000e-03
        Epoch 138, train: (loss: 0.2729, accuracy: 90.28%), test: (loss: 0.4784, accuracy: 84.78%), lr: 1.0000e-03
        Epoch 139, train: (loss: 0.2753, accuracy: 90.34%), test: (loss: 0.4792, accuracy: 84.79%), lr: 1.0000e-03
        Epoch 140, train: (loss: 0.271, accuracy: 90.54%), test: (loss: 0.4978, accuracy: 84.29%), lr: 1.0000e-03
        Epoch 141, train: (loss: 0.2714, accuracy: 90.39%), test: (loss: 0.4696, accuracy: 84.78%), lr: 1.0000e-03
        Epoch 142, train: (loss: 0.2749, accuracy: 90.42%), test: (loss: 0.4736, accuracy: 84.77%), lr: 1.0000e-03
        Epoch 143, train: (loss: 0.2654, accuracy: 90.69%), test: (loss: 0.4839, accuracy: 84.67%), lr: 1.0000e-03
        Epoch 144, train: (loss: 0.2671, accuracy: 90.53%), test: (loss: 0.4686, accuracy: 85.13%), lr: 1.0000e-03
        Epoch 145, train: (loss: 0.2638, accuracy: 90.63%), test: (loss: 0.4961, accuracy: 84.24%), lr: 1.0000e-03
        Epoch 146, train: (loss: 0.2652, accuracy: 90.42%), test: (loss: 0.509, accuracy: 84.47%), lr: 1.0000e-03
        Epoch 147, train: (loss: 0.2702, accuracy: 90.44%), test: (loss: 0.4642, accuracy: 85.35%), lr: 1.0000e-03
        Epoch 148, train: (loss: 0.2714, accuracy: 90.48%), test: (loss: 0.4752, accuracy: 84.89%), lr: 1.0000e-03
        Epoch 149, train: (loss: 0.2677, accuracy: 90.58%), test: (loss: 0.4671, accuracy: 84.89%), lr: 1.0000e-03
        Epoch 150, train: (loss: 0.266, accuracy: 90.61%), test: (loss: 0.4875, accuracy: 84.49%), lr: 1.0000e-03
        Epoch 151, train: (loss: 0.2663, accuracy: 90.55%), test: (loss: 0.4805, accuracy: 84.86%), lr: 1.0000e-03
        Epoch 152, train: (loss: 0.2649, accuracy: 90.72%), test: (loss: 0.4895, accuracy: 84.88%), lr: 1.0000e-03
        Epoch 153, train: (loss: 0.2638, accuracy: 90.72%), test: (loss: 0.4764, accuracy: 84.77%), lr: 1.0000e-03
        Epoch 154, train: (loss: 0.26, accuracy: 90.93%), test: (loss: 0.4646, accuracy: 85.08%), lr: 1.0000e-03
        Epoch 155, train: (loss: 0.2592, accuracy: 90.88%), test: (loss: 0.4948, accuracy: 84.52%), lr: 1.0000e-03
        Epoch 156, train: (loss: 0.262, accuracy: 90.85%), test: (loss: 0.4795, accuracy: 84.79%), lr: 1.0000e-03
        Epoch 157, train: (loss: 0.2577, accuracy: 90.93%), test: (loss: 0.4675, accuracy: 85.16%), lr: 1.0000e-03
        Epoch 158, train: (loss: 0.2612, accuracy: 90.77%), test: (loss: 0.4796, accuracy: 84.89%), lr: 1.0000e-03
        Epoch 159, train: (loss: 0.2591, accuracy: 90.89%), test: (loss: 0.4985, accuracy: 84.48%), lr: 1.0000e-03
        Epoch 160, train: (loss: 0.2566, accuracy: 90.98%), test: (loss: 0.5027, accuracy: 84.18%), lr: 1.0000e-03
        Epoch 161, train: (loss: 0.2593, accuracy: 90.92%), test: (loss: 0.4781, accuracy: 85.21%), lr: 1.0000e-03
        Epoch 162, train: (loss: 0.2558, accuracy: 91.17%), test: (loss: 0.5004, accuracy: 84.70%), lr: 1.0000e-03
        Epoch 163, train: (loss: 0.2538, accuracy: 91.04%), test: (loss: 0.4921, accuracy: 84.19%), lr: 1.0000e-03
        Epoch 164, train: (loss: 0.2596, accuracy: 90.82%), test: (loss: 0.4686, accuracy: 85.57%), lr: 1.0000e-03
        Epoch 165, train: (loss: 0.255, accuracy: 90.96%), test: (loss: 0.4611, accuracy: 85.12%), lr: 1.0000e-03
        Epoch 166, train: (loss: 0.2574, accuracy: 90.85%), test: (loss: 0.4754, accuracy: 85.14%), lr: 1.0000e-03
        Epoch 167, train: (loss: 0.2588, accuracy: 90.94%), test: (loss: 0.4812, accuracy: 85.05%), lr: 1.0000e-03
        Epoch 168, train: (loss: 0.2488, accuracy: 91.28%), test: (loss: 0.4662, accuracy: 84.84%), lr: 1.0000e-03
        Epoch 169, train: (loss: 0.2595, accuracy: 90.85%), test: (loss: 0.4855, accuracy: 84.90%), lr: 1.0000e-03
        Epoch 170, train: (loss: 0.2573, accuracy: 90.96%), test: (loss: 0.4651, accuracy: 85.11%), lr: 1.0000e-03
        Epoch 171, train: (loss: 0.2563, accuracy: 91.01%), test: (loss: 0.4648, accuracy: 85.17%), lr: 1.0000e-03
        Epoch 172, train: (loss: 0.2536, accuracy: 91.18%), test: (loss: 0.4614, accuracy: 84.81%), lr: 1.0000e-03
        Epoch 173, train: (loss: 0.2444, accuracy: 91.43%), test: (loss: 0.4822, accuracy: 85.11%), lr: 1.0000e-03
        Epoch 174, train: (loss: 0.2514, accuracy: 91.17%), test: (loss: 0.4935, accuracy: 84.83%), lr: 1.0000e-03
        Epoch 175, train: (loss: 0.2515, accuracy: 91.11%), test: (loss: 0.4783, accuracy: 85.09%), lr: 1.0000e-03
        Epoch 176, train: (loss: 0.2558, accuracy: 91.01%), test: (loss: 0.4673, accuracy: 85.38%), lr: 1.0000e-03
        Epoch 177, train: (loss: 0.2491, accuracy: 91.24%), test: (loss: 0.4846, accuracy: 84.57%), lr: 1.0000e-03
        Epoch 178, train: (loss: 0.2459, accuracy: 91.41%), test: (loss: 0.4831, accuracy: 85.02%), lr: 1.0000e-03
        Epoch 179, train: (loss: 0.2509, accuracy: 91.18%), test: (loss: 0.464, accuracy: 85.24%), lr: 1.0000e-03
        Epoch 180, train: (loss: 0.2493, accuracy: 91.17%), test: (loss: 0.4762, accuracy: 84.75%), lr: 1.0000e-03
        Epoch 181, train: (loss: 0.2457, accuracy: 91.33%), test: (loss: 0.4834, accuracy: 85.05%), lr: 1.0000e-03
        Epoch 182, train: (loss: 0.2479, accuracy: 91.42%), test: (loss: 0.4729, accuracy: 85.13%), lr: 1.0000e-03
        Epoch 183, train: (loss: 0.2487, accuracy: 91.24%), test: (loss: 0.4828, accuracy: 84.79%), lr: 1.0000e-03
        Epoch 184, train: (loss: 0.2499, accuracy: 91.19%), test: (loss: 0.4651, accuracy: 85.14%), lr: 1.0000e-03
        Epoch 185, train: (loss: 0.2441, accuracy: 91.39%), test: (loss: 0.5138, accuracy: 84.09%), lr: 1.0000e-03
        Epoch 186, train: (loss: 0.2424, accuracy: 91.52%), test: (loss: 0.464, accuracy: 85.84%), lr: 1.0000e-03
        Epoch 187, train: (loss: 0.2356, accuracy: 91.61%), test: (loss: 0.4796, accuracy: 85.43%), lr: 1.0000e-03
        Epoch 188, train: (loss: 0.2423, accuracy: 91.40%), test: (loss: 0.4816, accuracy: 84.92%), lr: 1.0000e-03
        Epoch 189, train: (loss: 0.2409, accuracy: 91.61%), test: (loss: 0.4659, accuracy: 85.49%), lr: 1.0000e-03
        Epoch 190, train: (loss: 0.2422, accuracy: 91.33%), test: (loss: 0.4736, accuracy: 85.52%), lr: 1.0000e-03
        Epoch 191, train: (loss: 0.2454, accuracy: 91.46%), test: (loss: 0.4831, accuracy: 84.47%), lr: 1.0000e-03
        Epoch 192, train: (loss: 0.242, accuracy: 91.37%), test: (loss: 0.4471, accuracy: 85.48%), lr: 1.0000e-03
        Epoch 193, train: (loss: 0.2402, accuracy: 91.50%), test: (loss: 0.486, accuracy: 84.77%), lr: 1.0000e-03
        Epoch 194, train: (loss: 0.2436, accuracy: 91.40%), test: (loss: 0.4591, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 195, train: (loss: 0.2346, accuracy: 91.78%), test: (loss: 0.4652, accuracy: 85.02%), lr: 1.0000e-03
        Epoch 196, train: (loss: 0.2377, accuracy: 91.59%), test: (loss: 0.4727, accuracy: 85.21%), lr: 1.0000e-03
        Epoch 197, train: (loss: 0.2374, accuracy: 91.51%), test: (loss: 0.4781, accuracy: 85.08%), lr: 1.0000e-03
        Epoch 198, train: (loss: 0.2326, accuracy: 91.71%), test: (loss: 0.4704, accuracy: 85.59%), lr: 1.0000e-03
        Epoch 199, train: (loss: 0.2458, accuracy: 91.28%), test: (loss: 0.4504, accuracy: 85.65%), lr: 1.0000e-03
        Epoch 200, train: (loss: 0.2312, accuracy: 91.87%), test: (loss: 0.4717, accuracy: 85.41%), lr: 1.0000e-03
        Epoch 201, train: (loss: 0.2331, accuracy: 91.94%), test: (loss: 0.4843, accuracy: 85.30%), lr: 1.0000e-03
        Epoch 202, train: (loss: 0.2406, accuracy: 91.42%), test: (loss: 0.4563, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 203, train: (loss: 0.2353, accuracy: 91.77%), test: (loss: 0.4811, accuracy: 85.28%), lr: 1.0000e-03
        Epoch 204, train: (loss: 0.234, accuracy: 91.72%), test: (loss: 0.4801, accuracy: 85.40%), lr: 1.0000e-03
        Epoch 205, train: (loss: 0.2364, accuracy: 91.64%), test: (loss: 0.473, accuracy: 85.02%), lr: 1.0000e-03
        Epoch 206, train: (loss: 0.233, accuracy: 91.90%), test: (loss: 0.4886, accuracy: 84.90%), lr: 1.0000e-03
        Epoch 207, train: (loss: 0.2366, accuracy: 91.85%), test: (loss: 0.4781, accuracy: 85.16%), lr: 1.0000e-03
        Epoch 208, train: (loss: 0.234, accuracy: 91.67%), test: (loss: 0.4421, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 209, train: (loss: 0.2378, accuracy: 91.60%), test: (loss: 0.4763, accuracy: 85.22%), lr: 1.0000e-03
        Epoch 210, train: (loss: 0.233, accuracy: 91.91%), test: (loss: 0.4942, accuracy: 84.69%), lr: 1.0000e-03
        Epoch 211, train: (loss: 0.2278, accuracy: 92.01%), test: (loss: 0.4991, accuracy: 84.46%), lr: 1.0000e-03
        Epoch 212, train: (loss: 0.2258, accuracy: 92.01%), test: (loss: 0.4736, accuracy: 84.75%), lr: 1.0000e-03
        Epoch 213, train: (loss: 0.2298, accuracy: 91.96%), test: (loss: 0.4699, accuracy: 85.00%), lr: 1.0000e-03
        Epoch 214, train: (loss: 0.2305, accuracy: 91.94%), test: (loss: 0.4691, accuracy: 85.06%), lr: 1.0000e-03
        Epoch 215, train: (loss: 0.2283, accuracy: 92.07%), test: (loss: 0.4765, accuracy: 85.21%), lr: 1.0000e-03
        Epoch 216, train: (loss: 0.2249, accuracy: 92.07%), test: (loss: 0.476, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 217, train: (loss: 0.2342, accuracy: 91.74%), test: (loss: 0.4544, accuracy: 86.03%), lr: 1.0000e-03
        Epoch 218, train: (loss: 0.226, accuracy: 92.04%), test: (loss: 0.5125, accuracy: 84.55%), lr: 1.0000e-03
        Epoch 219, train: (loss: 0.2284, accuracy: 92.04%), test: (loss: 0.4566, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 220, train: (loss: 0.2286, accuracy: 91.94%), test: (loss: 0.4588, accuracy: 85.39%), lr: 1.0000e-03
        Epoch 221, train: (loss: 0.2251, accuracy: 92.03%), test: (loss: 0.4627, accuracy: 85.68%), lr: 1.0000e-03
        Epoch 222, train: (loss: 0.2315, accuracy: 91.88%), test: (loss: 0.4659, accuracy: 85.43%), lr: 1.0000e-03
        Epoch 223, train: (loss: 0.2244, accuracy: 92.12%), test: (loss: 0.5153, accuracy: 84.36%), lr: 1.0000e-03
        Epoch 224, train: (loss: 0.2286, accuracy: 91.99%), test: (loss: 0.4995, accuracy: 84.83%), lr: 1.0000e-03
        Epoch 225, train: (loss: 0.2272, accuracy: 92.05%), test: (loss: 0.4626, accuracy: 85.58%), lr: 1.0000e-03
        Epoch 226, train: (loss: 0.2243, accuracy: 92.17%), test: (loss: 0.4664, accuracy: 85.40%), lr: 1.0000e-03
        Epoch 227, train: (loss: 0.2232, accuracy: 92.24%), test: (loss: 0.4568, accuracy: 85.37%), lr: 1.0000e-03
        Epoch 228, train: (loss: 0.225, accuracy: 92.14%), test: (loss: 0.4608, accuracy: 85.83%), lr: 1.0000e-03
        Epoch 229, train: (loss: 0.2223, accuracy: 92.08%), test: (loss: 0.4693, accuracy: 85.63%), lr: 1.0000e-03
        Epoch 230, train: (loss: 0.2219, accuracy: 92.29%), test: (loss: 0.4699, accuracy: 85.56%), lr: 1.0000e-03
        Epoch 231, train: (loss: 0.2204, accuracy: 92.36%), test: (loss: 0.4837, accuracy: 85.28%), lr: 1.0000e-03
        Epoch 232, train: (loss: 0.2256, accuracy: 92.06%), test: (loss: 0.4693, accuracy: 85.73%), lr: 1.0000e-03
        Epoch 233, train: (loss: 0.2231, accuracy: 92.11%), test: (loss: 0.4692, accuracy: 85.67%), lr: 1.0000e-03
        Epoch 234, train: (loss: 0.2226, accuracy: 92.13%), test: (loss: 0.4679, accuracy: 85.67%), lr: 1.0000e-03
        Epoch 235, train: (loss: 0.2201, accuracy: 92.31%), test: (loss: 0.4636, accuracy: 85.59%), lr: 1.0000e-03
        Epoch 236, train: (loss: 0.2155, accuracy: 92.46%), test: (loss: 0.4655, accuracy: 85.43%), lr: 1.0000e-03
        Epoch 237, train: (loss: 0.2215, accuracy: 92.13%), test: (loss: 0.4758, accuracy: 85.39%), lr: 1.0000e-03
        Epoch 238, train: (loss: 0.2167, accuracy: 92.41%), test: (loss: 0.4719, accuracy: 85.29%), lr: 1.0000e-03
        Epoch 239, train: (loss: 0.2184, accuracy: 92.42%), test: (loss: 0.49, accuracy: 85.12%), lr: 1.0000e-03
        Epoch 240, train: (loss: 0.2263, accuracy: 91.93%), test: (loss: 0.4639, accuracy: 85.53%), lr: 1.0000e-03
        Epoch 241, train: (loss: 0.2207, accuracy: 92.27%), test: (loss: 0.4694, accuracy: 85.41%), lr: 1.0000e-03
        Epoch 242, train: (loss: 0.2158, accuracy: 92.47%), test: (loss: 0.4817, accuracy: 85.32%), lr: 1.0000e-03
        Epoch 243, train: (loss: 0.2175, accuracy: 92.35%), test: (loss: 0.4641, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 244, train: (loss: 0.2207, accuracy: 92.20%), test: (loss: 0.4713, accuracy: 85.28%), lr: 1.0000e-03
        Epoch 245, train: (loss: 0.2212, accuracy: 92.25%), test: (loss: 0.464, accuracy: 85.32%), lr: 1.0000e-03
        Epoch 246, train: (loss: 0.2196, accuracy: 92.32%), test: (loss: 0.4755, accuracy: 85.12%), lr: 1.0000e-03
        Epoch 247, train: (loss: 0.2161, accuracy: 92.41%), test: (loss: 0.4851, accuracy: 85.08%), lr: 1.0000e-03
        Epoch 248, train: (loss: 0.217, accuracy: 92.54%), test: (loss: 0.4752, accuracy: 85.73%), lr: 1.0000e-03
        Epoch 249, train: (loss: 0.2156, accuracy: 92.41%), test: (loss: 0.4859, accuracy: 85.06%), lr: 1.0000e-03
        Epoch 250, train: (loss: 0.2146, accuracy: 92.42%), test: (loss: 0.4841, accuracy: 85.42%), lr: 1.0000e-03
        Epoch 251, train: (loss: 0.2173, accuracy: 92.28%), test: (loss: 0.4813, accuracy: 85.19%), lr: 1.0000e-03
        Epoch 252, train: (loss: 0.2222, accuracy: 92.24%), test: (loss: 0.4753, accuracy: 84.96%), lr: 1.0000e-03
        Epoch 253, train: (loss: 0.2181, accuracy: 92.34%), test: (loss: 0.4551, accuracy: 85.76%), lr: 1.0000e-03
        Epoch 254, train: (loss: 0.2135, accuracy: 92.44%), test: (loss: 0.4554, accuracy: 86.00%), lr: 1.0000e-03
        Epoch 255, train: (loss: 0.212, accuracy: 92.58%), test: (loss: 0.4526, accuracy: 85.66%), lr: 1.0000e-03
        Epoch 256, train: (loss: 0.2144, accuracy: 92.51%), test: (loss: 0.4726, accuracy: 85.47%), lr: 1.0000e-03
        Epoch 257, train: (loss: 0.2145, accuracy: 92.43%), test: (loss: 0.4619, accuracy: 85.57%), lr: 1.0000e-03
        Epoch 258, train: (loss: 0.2182, accuracy: 92.39%), test: (loss: 0.4726, accuracy: 85.40%), lr: 1.0000e-03
        Epoch 259, train: (loss: 0.2158, accuracy: 92.45%), test: (loss: 0.4962, accuracy: 85.24%), lr: 1.0000e-03
        Epoch 260, train: (loss: 0.2147, accuracy: 92.44%), test: (loss: 0.487, accuracy: 85.28%), lr: 1.0000e-03
        Epoch 261, train: (loss: 0.2124, accuracy: 92.47%), test: (loss: 0.4628, accuracy: 85.38%), lr: 1.0000e-03
        Epoch 262, train: (loss: 0.2107, accuracy: 92.57%), test: (loss: 0.4875, accuracy: 85.29%), lr: 1.0000e-03
        Epoch 263, train: (loss: 0.2139, accuracy: 92.52%), test: (loss: 0.4638, accuracy: 85.81%), lr: 1.0000e-03
        Epoch 264, train: (loss: 0.2082, accuracy: 92.62%), test: (loss: 0.4785, accuracy: 85.44%), lr: 1.0000e-03
        Epoch 265, train: (loss: 0.2111, accuracy: 92.55%), test: (loss: 0.4811, accuracy: 85.53%), lr: 1.0000e-03
        Epoch 266, train: (loss: 0.2074, accuracy: 92.61%), test: (loss: 0.4703, accuracy: 85.47%), lr: 1.0000e-03
        Epoch 267, train: (loss: 0.2179, accuracy: 92.25%), test: (loss: 0.4477, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 268, train: (loss: 0.2116, accuracy: 92.50%), test: (loss: 0.4663, accuracy: 85.86%), lr: 1.0000e-03
        Epoch 269, train: (loss: 0.21, accuracy: 92.69%), test: (loss: 0.4754, accuracy: 85.30%), lr: 1.0000e-03
        Epoch 270, train: (loss: 0.2104, accuracy: 92.60%), test: (loss: 0.479, accuracy: 85.27%), lr: 1.0000e-03
        Epoch 271, train: (loss: 0.2082, accuracy: 92.70%), test: (loss: 0.4827, accuracy: 85.56%), lr: 1.0000e-03
        Epoch 272, train: (loss: 0.2082, accuracy: 92.73%), test: (loss: 0.4671, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 273, train: (loss: 0.2068, accuracy: 92.83%), test: (loss: 0.4603, accuracy: 85.83%), lr: 1.0000e-03
        Epoch 274, train: (loss: 0.2093, accuracy: 92.70%), test: (loss: 0.4683, accuracy: 85.90%), lr: 1.0000e-03
        Epoch 275, train: (loss: 0.2104, accuracy: 92.62%), test: (loss: 0.4741, accuracy: 85.68%), lr: 1.0000e-03
        Epoch 276, train: (loss: 0.2062, accuracy: 92.89%), test: (loss: 0.4749, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 277, train: (loss: 0.2076, accuracy: 92.65%), test: (loss: 0.4596, accuracy: 85.66%), lr: 1.0000e-03
        Epoch 278, train: (loss: 0.2061, accuracy: 92.73%), test: (loss: 0.4827, accuracy: 85.07%), lr: 1.0000e-03
        Epoch 279, train: (loss: 0.2056, accuracy: 92.69%), test: (loss: 0.4715, accuracy: 85.57%), lr: 1.0000e-03
        Epoch 280, train: (loss: 0.2066, accuracy: 92.70%), test: (loss: 0.4723, accuracy: 85.20%), lr: 1.0000e-03
        Epoch 281, train: (loss: 0.2072, accuracy: 92.54%), test: (loss: 0.4803, accuracy: 85.67%), lr: 1.0000e-03
        Epoch 282, train: (loss: 0.2095, accuracy: 92.59%), test: (loss: 0.4992, accuracy: 85.20%), lr: 1.0000e-03
        Epoch 283, train: (loss: 0.2086, accuracy: 92.74%), test: (loss: 0.4614, accuracy: 85.84%), lr: 1.0000e-03
        Epoch 284, train: (loss: 0.2031, accuracy: 92.89%), test: (loss: 0.4768, accuracy: 85.66%), lr: 1.0000e-03
        Epoch 285, train: (loss: 0.206, accuracy: 92.64%), test: (loss: 0.4663, accuracy: 85.43%), lr: 1.0000e-03
        Epoch 286, train: (loss: 0.2064, accuracy: 92.67%), test: (loss: 0.4741, accuracy: 85.74%), lr: 1.0000e-03
        Epoch 287, train: (loss: 0.2078, accuracy: 92.71%), test: (loss: 0.4829, accuracy: 85.60%), lr: 1.0000e-03
        Epoch 288, train: (loss: 0.2083, accuracy: 92.59%), test: (loss: 0.4614, accuracy: 85.81%), lr: 1.0000e-03
        Epoch 289, train: (loss: 0.2013, accuracy: 92.83%), test: (loss: 0.4664, accuracy: 85.85%), lr: 1.0000e-03
        Epoch 290, train: (loss: 0.2052, accuracy: 92.79%), test: (loss: 0.464, accuracy: 85.83%), lr: 1.0000e-03
        Epoch 291, train: (loss: 0.2067, accuracy: 92.75%), test: (loss: 0.4645, accuracy: 85.45%), lr: 1.0000e-03
        Epoch 292, train: (loss: 0.1996, accuracy: 92.99%), test: (loss: 0.4731, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 293, train: (loss: 0.203, accuracy: 92.78%), test: (loss: 0.4709, accuracy: 86.01%), lr: 1.0000e-03
        Epoch 294, train: (loss: 0.1963, accuracy: 93.10%), test: (loss: 0.4787, accuracy: 85.42%), lr: 1.0000e-03
        Epoch 295, train: (loss: 0.2056, accuracy: 92.68%), test: (loss: 0.4581, accuracy: 86.12%), lr: 1.0000e-03
        Epoch 296, train: (loss: 0.2072, accuracy: 92.66%), test: (loss: 0.4568, accuracy: 85.36%), lr: 1.0000e-03
        Epoch 297, train: (loss: 0.1966, accuracy: 93.14%), test: (loss: 0.4598, accuracy: 86.07%), lr: 1.0000e-03
        Epoch 298, train: (loss: 0.2037, accuracy: 92.85%), test: (loss: 0.4782, accuracy: 85.43%), lr: 1.0000e-03
        Epoch 299, train: (loss: 0.2031, accuracy: 92.78%), test: (loss: 0.4597, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 300, train: (loss: 0.1981, accuracy: 93.06%), test: (loss: 0.4576, accuracy: 86.00%), lr: 1.0000e-03
        Epoch 301, train: (loss: 0.2051, accuracy: 92.91%), test: (loss: 0.4905, accuracy: 85.61%), lr: 1.0000e-03
        Epoch 302, train: (loss: 0.1984, accuracy: 93.01%), test: (loss: 0.4661, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 303, train: (loss: 0.1965, accuracy: 93.02%), test: (loss: 0.4618, accuracy: 85.86%), lr: 1.0000e-03
        Epoch 304, train: (loss: 0.1971, accuracy: 93.05%), test: (loss: 0.4636, accuracy: 85.72%), lr: 1.0000e-03
        Epoch 305, train: (loss: 0.1992, accuracy: 93.05%), test: (loss: 0.4581, accuracy: 85.89%), lr: 1.0000e-03
        Epoch 306, train: (loss: 0.1972, accuracy: 93.09%), test: (loss: 0.4668, accuracy: 86.01%), lr: 1.0000e-03
        Epoch 307, train: (loss: 0.1993, accuracy: 93.05%), test: (loss: 0.4753, accuracy: 85.22%), lr: 1.0000e-03
        Epoch 308, train: (loss: 0.196, accuracy: 93.11%), test: (loss: 0.489, accuracy: 85.17%), lr: 1.0000e-03
        Epoch 309, train: (loss: 0.2003, accuracy: 92.98%), test: (loss: 0.4631, accuracy: 86.06%), lr: 1.0000e-03
        Epoch 310, train: (loss: 0.1973, accuracy: 92.97%), test: (loss: 0.4591, accuracy: 85.73%), lr: 1.0000e-03
        Epoch 311, train: (loss: 0.1963, accuracy: 93.12%), test: (loss: 0.4645, accuracy: 85.81%), lr: 1.0000e-03
        Epoch 312, train: (loss: 0.1947, accuracy: 93.18%), test: (loss: 0.461, accuracy: 85.71%), lr: 1.0000e-03
        Epoch 313, train: (loss: 0.2015, accuracy: 92.92%), test: (loss: 0.4626, accuracy: 85.70%), lr: 1.0000e-03
        Epoch 314, train: (loss: 0.1965, accuracy: 93.11%), test: (loss: 0.464, accuracy: 85.82%), lr: 1.0000e-03
        Epoch 315, train: (loss: 0.2007, accuracy: 93.05%), test: (loss: 0.4439, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 316, train: (loss: 0.1948, accuracy: 93.27%), test: (loss: 0.4863, accuracy: 85.47%), lr: 1.0000e-03
        Epoch 317, train: (loss: 0.197, accuracy: 93.06%), test: (loss: 0.4733, accuracy: 85.60%), lr: 1.0000e-03
        Epoch 318, train: (loss: 0.1961, accuracy: 93.17%), test: (loss: 0.4721, accuracy: 85.75%), lr: 1.0000e-03
        Epoch 319, train: (loss: 0.1999, accuracy: 93.03%), test: (loss: 0.4673, accuracy: 85.31%), lr: 1.0000e-03
        Epoch 320, train: (loss: 0.1939, accuracy: 93.21%), test: (loss: 0.4668, accuracy: 86.00%), lr: 1.0000e-03
        Epoch 321, train: (loss: 0.193, accuracy: 93.14%), test: (loss: 0.4717, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 322, train: (loss: 0.1977, accuracy: 93.18%), test: (loss: 0.465, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 323, train: (loss: 0.1945, accuracy: 93.22%), test: (loss: 0.4619, accuracy: 85.99%), lr: 1.0000e-03
        Epoch 324, train: (loss: 0.1941, accuracy: 93.23%), test: (loss: 0.482, accuracy: 85.75%), lr: 1.0000e-03
        Epoch 325, train: (loss: 0.1965, accuracy: 93.22%), test: (loss: 0.466, accuracy: 85.66%), lr: 1.0000e-03
        Epoch 326, train: (loss: 0.1969, accuracy: 93.20%), test: (loss: 0.4761, accuracy: 85.52%), lr: 1.0000e-03
        Epoch 327, train: (loss: 0.1958, accuracy: 93.11%), test: (loss: 0.4692, accuracy: 85.90%), lr: 1.0000e-03
        Epoch 328, train: (loss: 0.1928, accuracy: 93.19%), test: (loss: 0.4603, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 329, train: (loss: 0.1942, accuracy: 93.27%), test: (loss: 0.4845, accuracy: 85.41%), lr: 1.0000e-03
        Epoch 330, train: (loss: 0.1965, accuracy: 92.94%), test: (loss: 0.4451, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 331, train: (loss: 0.1879, accuracy: 93.31%), test: (loss: 0.456, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 332, train: (loss: 0.1937, accuracy: 93.28%), test: (loss: 0.4619, accuracy: 85.91%), lr: 1.0000e-03
        Epoch 333, train: (loss: 0.1944, accuracy: 93.04%), test: (loss: 0.4739, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 334, train: (loss: 0.1948, accuracy: 93.33%), test: (loss: 0.4516, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 335, train: (loss: 0.1893, accuracy: 93.46%), test: (loss: 0.4779, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 336, train: (loss: 0.1965, accuracy: 93.09%), test: (loss: 0.4687, accuracy: 85.45%), lr: 1.0000e-03
        Epoch 337, train: (loss: 0.1919, accuracy: 93.13%), test: (loss: 0.4771, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 338, train: (loss: 0.1909, accuracy: 93.24%), test: (loss: 0.4605, accuracy: 86.19%), lr: 1.0000e-03
        Epoch 339, train: (loss: 0.1936, accuracy: 93.28%), test: (loss: 0.4619, accuracy: 85.47%), lr: 1.0000e-03
        Epoch 340, train: (loss: 0.1907, accuracy: 93.36%), test: (loss: 0.4572, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 341, train: (loss: 0.1915, accuracy: 93.32%), test: (loss: 0.4446, accuracy: 85.86%), lr: 1.0000e-03
        Epoch 342, train: (loss: 0.1944, accuracy: 93.08%), test: (loss: 0.4737, accuracy: 85.93%), lr: 1.0000e-03
        Epoch 343, train: (loss: 0.1946, accuracy: 93.12%), test: (loss: 0.488, accuracy: 85.33%), lr: 1.0000e-03
        Epoch 344, train: (loss: 0.194, accuracy: 93.23%), test: (loss: 0.4685, accuracy: 86.05%), lr: 1.0000e-03
        Epoch 345, train: (loss: 0.1872, accuracy: 93.35%), test: (loss: 0.481, accuracy: 86.01%), lr: 1.0000e-03
        Epoch 346, train: (loss: 0.1951, accuracy: 93.20%), test: (loss: 0.4783, accuracy: 85.76%), lr: 1.0000e-03
        Epoch 347, train: (loss: 0.1904, accuracy: 93.27%), test: (loss: 0.4827, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 348, train: (loss: 0.1905, accuracy: 93.37%), test: (loss: 0.4506, accuracy: 86.04%), lr: 1.0000e-03
        Epoch 349, train: (loss: 0.1943, accuracy: 93.28%), test: (loss: 0.4501, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 350, train: (loss: 0.1875, accuracy: 93.41%), test: (loss: 0.461, accuracy: 86.07%), lr: 1.0000e-03
        Epoch 351, train: (loss: 0.1899, accuracy: 93.30%), test: (loss: 0.4769, accuracy: 85.73%), lr: 1.0000e-03
        Epoch 352, train: (loss: 0.189, accuracy: 93.36%), test: (loss: 0.4621, accuracy: 85.82%), lr: 1.0000e-03
        Epoch 353, train: (loss: 0.1859, accuracy: 93.40%), test: (loss: 0.4436, accuracy: 86.58%), lr: 1.0000e-03
        Epoch 354, train: (loss: 0.1879, accuracy: 93.35%), test: (loss: 0.4759, accuracy: 85.32%), lr: 1.0000e-03
        Epoch 355, train: (loss: 0.186, accuracy: 93.49%), test: (loss: 0.4764, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 356, train: (loss: 0.1895, accuracy: 93.38%), test: (loss: 0.4705, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 357, train: (loss: 0.1849, accuracy: 93.52%), test: (loss: 0.4771, accuracy: 85.79%), lr: 1.0000e-03
        Epoch 358, train: (loss: 0.1841, accuracy: 93.48%), test: (loss: 0.4563, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 359, train: (loss: 0.1884, accuracy: 93.27%), test: (loss: 0.4671, accuracy: 86.03%), lr: 1.0000e-03
        Epoch 360, train: (loss: 0.1835, accuracy: 93.61%), test: (loss: 0.4632, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 361, train: (loss: 0.1864, accuracy: 93.46%), test: (loss: 0.4766, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 362, train: (loss: 0.1846, accuracy: 93.54%), test: (loss: 0.4986, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 363, train: (loss: 0.1854, accuracy: 93.45%), test: (loss: 0.4942, accuracy: 85.16%), lr: 1.0000e-03
        Epoch 364, train: (loss: 0.1848, accuracy: 93.54%), test: (loss: 0.4644, accuracy: 85.99%), lr: 1.0000e-03
        Epoch 365, train: (loss: 0.1865, accuracy: 93.47%), test: (loss: 0.4591, accuracy: 86.00%), lr: 1.0000e-03
        Epoch 366, train: (loss: 0.185, accuracy: 93.47%), test: (loss: 0.4626, accuracy: 86.15%), lr: 1.0000e-03
        Epoch 367, train: (loss: 0.1906, accuracy: 93.26%), test: (loss: 0.4571, accuracy: 86.31%), lr: 1.0000e-03
        Epoch 368, train: (loss: 0.1813, accuracy: 93.68%), test: (loss: 0.466, accuracy: 85.67%), lr: 1.0000e-03
        Epoch 369, train: (loss: 0.1859, accuracy: 93.39%), test: (loss: 0.4977, accuracy: 85.79%), lr: 1.0000e-03
        Epoch 370, train: (loss: 0.1849, accuracy: 93.56%), test: (loss: 0.4606, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 371, train: (loss: 0.1884, accuracy: 93.42%), test: (loss: 0.4733, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 372, train: (loss: 0.1837, accuracy: 93.52%), test: (loss: 0.4713, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 373, train: (loss: 0.1791, accuracy: 93.81%), test: (loss: 0.4487, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 374, train: (loss: 0.1806, accuracy: 93.67%), test: (loss: 0.4516, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 375, train: (loss: 0.1875, accuracy: 93.37%), test: (loss: 0.4609, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 376, train: (loss: 0.1884, accuracy: 93.43%), test: (loss: 0.4648, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 377, train: (loss: 0.1823, accuracy: 93.61%), test: (loss: 0.4558, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 378, train: (loss: 0.1875, accuracy: 93.52%), test: (loss: 0.4624, accuracy: 85.83%), lr: 1.0000e-03
        Epoch 379, train: (loss: 0.1815, accuracy: 93.55%), test: (loss: 0.4772, accuracy: 85.71%), lr: 1.0000e-03
        Epoch 380, train: (loss: 0.1814, accuracy: 93.68%), test: (loss: 0.4618, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 381, train: (loss: 0.1871, accuracy: 93.42%), test: (loss: 0.4703, accuracy: 85.67%), lr: 1.0000e-03
        Epoch 382, train: (loss: 0.184, accuracy: 93.58%), test: (loss: 0.4699, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 383, train: (loss: 0.1849, accuracy: 93.47%), test: (loss: 0.4591, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 384, train: (loss: 0.185, accuracy: 93.55%), test: (loss: 0.462, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 385, train: (loss: 0.1838, accuracy: 93.56%), test: (loss: 0.4606, accuracy: 85.90%), lr: 1.0000e-03
        Epoch 386, train: (loss: 0.1801, accuracy: 93.57%), test: (loss: 0.4917, accuracy: 86.16%), lr: 1.0000e-03
        Epoch 387, train: (loss: 0.1856, accuracy: 93.34%), test: (loss: 0.4717, accuracy: 85.62%), lr: 1.0000e-03
        Epoch 388, train: (loss: 0.188, accuracy: 93.42%), test: (loss: 0.4767, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 389, train: (loss: 0.1864, accuracy: 93.42%), test: (loss: 0.4562, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 390, train: (loss: 0.1782, accuracy: 93.62%), test: (loss: 0.4375, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 391, train: (loss: 0.1797, accuracy: 93.70%), test: (loss: 0.4713, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 392, train: (loss: 0.1794, accuracy: 93.73%), test: (loss: 0.462, accuracy: 86.04%), lr: 1.0000e-03
        Epoch 393, train: (loss: 0.1778, accuracy: 93.69%), test: (loss: 0.4768, accuracy: 85.60%), lr: 1.0000e-03
        Epoch 394, train: (loss: 0.1818, accuracy: 93.48%), test: (loss: 0.4728, accuracy: 85.95%), lr: 1.0000e-03
        Epoch 395, train: (loss: 0.1864, accuracy: 93.45%), test: (loss: 0.4518, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 396, train: (loss: 0.1827, accuracy: 93.59%), test: (loss: 0.4634, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 397, train: (loss: 0.1805, accuracy: 93.64%), test: (loss: 0.4535, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 398, train: (loss: 0.1819, accuracy: 93.59%), test: (loss: 0.4606, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 399, train: (loss: 0.1841, accuracy: 93.55%), test: (loss: 0.4658, accuracy: 85.79%), lr: 1.0000e-03
        Epoch 400, train: (loss: 0.1804, accuracy: 93.67%), test: (loss: 0.4575, accuracy: 85.96%), lr: 1.0000e-03
        Epoch 401, train: (loss: 0.1797, accuracy: 93.78%), test: (loss: 0.4639, accuracy: 85.72%), lr: 1.0000e-03
        Epoch 402, train: (loss: 0.1816, accuracy: 93.77%), test: (loss: 0.4591, accuracy: 85.38%), lr: 1.0000e-03
        Epoch 403, train: (loss: 0.1819, accuracy: 93.72%), test: (loss: 0.4795, accuracy: 85.89%), lr: 1.0000e-03
        Epoch 404, train: (loss: 0.1781, accuracy: 93.81%), test: (loss: 0.4805, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 405, train: (loss: 0.1822, accuracy: 93.59%), test: (loss: 0.4646, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 406, train: (loss: 0.1774, accuracy: 93.79%), test: (loss: 0.4637, accuracy: 86.29%), lr: 1.0000e-03
        Epoch 407, train: (loss: 0.1766, accuracy: 93.72%), test: (loss: 0.466, accuracy: 86.58%), lr: 1.0000e-03
        Epoch 408, train: (loss: 0.18, accuracy: 93.75%), test: (loss: 0.46, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 409, train: (loss: 0.1785, accuracy: 93.67%), test: (loss: 0.4489, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 410, train: (loss: 0.1767, accuracy: 93.82%), test: (loss: 0.4622, accuracy: 86.14%), lr: 1.0000e-03
        Epoch 411, train: (loss: 0.1819, accuracy: 93.73%), test: (loss: 0.4833, accuracy: 85.66%), lr: 1.0000e-03
        Epoch 412, train: (loss: 0.1771, accuracy: 93.69%), test: (loss: 0.4739, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 413, train: (loss: 0.1748, accuracy: 93.91%), test: (loss: 0.4547, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 414, train: (loss: 0.1788, accuracy: 93.85%), test: (loss: 0.4909, accuracy: 85.94%), lr: 1.0000e-03
        Epoch 415, train: (loss: 0.178, accuracy: 93.84%), test: (loss: 0.4615, accuracy: 86.31%), lr: 1.0000e-03
        Epoch 416, train: (loss: 0.1851, accuracy: 93.55%), test: (loss: 0.4526, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 417, train: (loss: 0.1726, accuracy: 93.88%), test: (loss: 0.471, accuracy: 86.09%), lr: 1.0000e-03
        Epoch 418, train: (loss: 0.1752, accuracy: 93.96%), test: (loss: 0.4652, accuracy: 86.02%), lr: 1.0000e-03
        Epoch 419, train: (loss: 0.1752, accuracy: 93.84%), test: (loss: 0.4852, accuracy: 86.16%), lr: 1.0000e-03
        Epoch 420, train: (loss: 0.1743, accuracy: 93.75%), test: (loss: 0.4762, accuracy: 85.79%), lr: 1.0000e-03
        Epoch 421, train: (loss: 0.1771, accuracy: 93.83%), test: (loss: 0.4585, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 422, train: (loss: 0.1798, accuracy: 93.70%), test: (loss: 0.4458, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 423, train: (loss: 0.1779, accuracy: 93.78%), test: (loss: 0.5092, accuracy: 85.20%), lr: 1.0000e-03
        Epoch 424, train: (loss: 0.1809, accuracy: 93.73%), test: (loss: 0.4934, accuracy: 85.95%), lr: 1.0000e-03
        Epoch 425, train: (loss: 0.1782, accuracy: 93.77%), test: (loss: 0.458, accuracy: 86.44%), lr: 1.0000e-03
        Epoch 426, train: (loss: 0.1776, accuracy: 93.80%), test: (loss: 0.4903, accuracy: 85.69%), lr: 1.0000e-03
        Epoch 427, train: (loss: 0.1823, accuracy: 93.54%), test: (loss: 0.4767, accuracy: 85.65%), lr: 1.0000e-03
        Epoch 428, train: (loss: 0.1714, accuracy: 93.92%), test: (loss: 0.4654, accuracy: 86.37%), lr: 1.0000e-03
        Epoch 429, train: (loss: 0.1745, accuracy: 93.73%), test: (loss: 0.4684, accuracy: 85.86%), lr: 1.0000e-03
        Epoch 430, train: (loss: 0.1791, accuracy: 93.64%), test: (loss: 0.4809, accuracy: 85.76%), lr: 1.0000e-03
        Epoch 431, train: (loss: 0.1764, accuracy: 93.68%), test: (loss: 0.4603, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 432, train: (loss: 0.1748, accuracy: 93.95%), test: (loss: 0.508, accuracy: 85.31%), lr: 1.0000e-03
        Epoch 433, train: (loss: 0.1759, accuracy: 93.89%), test: (loss: 0.477, accuracy: 85.92%), lr: 1.0000e-03
        Epoch 434, train: (loss: 0.1772, accuracy: 93.84%), test: (loss: 0.473, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 435, train: (loss: 0.1724, accuracy: 93.96%), test: (loss: 0.4746, accuracy: 86.10%), lr: 1.0000e-03
        Epoch 436, train: (loss: 0.1782, accuracy: 93.70%), test: (loss: 0.4614, accuracy: 86.34%), lr: 1.0000e-03
        Epoch 437, train: (loss: 0.1745, accuracy: 93.83%), test: (loss: 0.4611, accuracy: 85.91%), lr: 1.0000e-03
        Epoch 438, train: (loss: 0.1727, accuracy: 93.78%), test: (loss: 0.4547, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 439, train: (loss: 0.1732, accuracy: 94.00%), test: (loss: 0.5018, accuracy: 85.10%), lr: 1.0000e-03
        Epoch 440, train: (loss: 0.1764, accuracy: 93.95%), test: (loss: 0.4538, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 441, train: (loss: 0.1734, accuracy: 93.96%), test: (loss: 0.444, accuracy: 85.90%), lr: 1.0000e-03
        Epoch 442, train: (loss: 0.1727, accuracy: 93.96%), test: (loss: 0.4578, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 443, train: (loss: 0.1744, accuracy: 93.97%), test: (loss: 0.4591, accuracy: 86.35%), lr: 1.0000e-03
        Epoch 444, train: (loss: 0.1759, accuracy: 93.76%), test: (loss: 0.4644, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 445, train: (loss: 0.171, accuracy: 94.08%), test: (loss: 0.4734, accuracy: 86.16%), lr: 1.0000e-03
        Epoch 446, train: (loss: 0.1697, accuracy: 94.05%), test: (loss: 0.466, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 447, train: (loss: 0.1774, accuracy: 93.83%), test: (loss: 0.4807, accuracy: 85.85%), lr: 1.0000e-03
        Epoch 448, train: (loss: 0.1749, accuracy: 93.81%), test: (loss: 0.4605, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 449, train: (loss: 0.1732, accuracy: 93.83%), test: (loss: 0.5098, accuracy: 85.06%), lr: 1.0000e-03
        Epoch 450, train: (loss: 0.1739, accuracy: 93.87%), test: (loss: 0.4699, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 451, train: (loss: 0.1759, accuracy: 93.81%), test: (loss: 0.4609, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 452, train: (loss: 0.1746, accuracy: 93.79%), test: (loss: 0.4586, accuracy: 86.07%), lr: 1.0000e-03
        Epoch 453, train: (loss: 0.1715, accuracy: 93.94%), test: (loss: 0.4666, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 454, train: (loss: 0.174, accuracy: 93.90%), test: (loss: 0.4598, accuracy: 86.64%), lr: 1.0000e-03
        Epoch 455, train: (loss: 0.1708, accuracy: 93.97%), test: (loss: 0.4766, accuracy: 86.16%), lr: 1.0000e-03
        Epoch 456, train: (loss: 0.1747, accuracy: 93.96%), test: (loss: 0.5142, accuracy: 85.72%), lr: 1.0000e-03
        Epoch 457, train: (loss: 0.1643, accuracy: 94.17%), test: (loss: 0.4612, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 458, train: (loss: 0.174, accuracy: 93.83%), test: (loss: 0.4671, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 459, train: (loss: 0.1695, accuracy: 94.12%), test: (loss: 0.4636, accuracy: 86.12%), lr: 1.0000e-03
        Epoch 460, train: (loss: 0.1713, accuracy: 94.01%), test: (loss: 0.4739, accuracy: 85.95%), lr: 1.0000e-03
        Epoch 461, train: (loss: 0.1695, accuracy: 94.02%), test: (loss: 0.4582, accuracy: 86.74%), lr: 1.0000e-03
        Epoch 462, train: (loss: 0.1705, accuracy: 94.04%), test: (loss: 0.4963, accuracy: 85.47%), lr: 1.0000e-03
        Epoch 463, train: (loss: 0.1737, accuracy: 93.91%), test: (loss: 0.476, accuracy: 85.96%), lr: 1.0000e-03
        Epoch 464, train: (loss: 0.1705, accuracy: 94.00%), test: (loss: 0.4272, accuracy: 86.93%), lr: 1.0000e-03
        Epoch 465, train: (loss: 0.1707, accuracy: 94.10%), test: (loss: 0.4607, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 466, train: (loss: 0.1718, accuracy: 94.04%), test: (loss: 0.4545, accuracy: 86.76%), lr: 1.0000e-03
        Epoch 467, train: (loss: 0.1721, accuracy: 93.92%), test: (loss: 0.4701, accuracy: 86.14%), lr: 1.0000e-03
        Epoch 468, train: (loss: 0.1717, accuracy: 93.90%), test: (loss: 0.472, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 469, train: (loss: 0.1655, accuracy: 94.29%), test: (loss: 0.4519, accuracy: 86.84%), lr: 1.0000e-03
        Epoch 470, train: (loss: 0.1715, accuracy: 94.07%), test: (loss: 0.4627, accuracy: 86.21%), lr: 1.0000e-03
        Epoch 471, train: (loss: 0.1719, accuracy: 93.90%), test: (loss: 0.4802, accuracy: 85.77%), lr: 1.0000e-03
        Epoch 472, train: (loss: 0.1637, accuracy: 94.22%), test: (loss: 0.4589, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 473, train: (loss: 0.171, accuracy: 93.95%), test: (loss: 0.4608, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 474, train: (loss: 0.1713, accuracy: 93.92%), test: (loss: 0.4598, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 475, train: (loss: 0.1714, accuracy: 93.90%), test: (loss: 0.4883, accuracy: 85.76%), lr: 1.0000e-03
        Epoch 476, train: (loss: 0.1722, accuracy: 93.86%), test: (loss: 0.4756, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 477, train: (loss: 0.1714, accuracy: 94.03%), test: (loss: 0.4645, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 478, train: (loss: 0.1714, accuracy: 93.94%), test: (loss: 0.4654, accuracy: 86.29%), lr: 1.0000e-03
        Epoch 479, train: (loss: 0.1729, accuracy: 93.93%), test: (loss: 0.471, accuracy: 85.86%), lr: 1.0000e-03
        Epoch 480, train: (loss: 0.1655, accuracy: 94.37%), test: (loss: 0.4652, accuracy: 86.58%), lr: 1.0000e-03
        Epoch 481, train: (loss: 0.1665, accuracy: 94.20%), test: (loss: 0.4886, accuracy: 85.82%), lr: 1.0000e-03
        Epoch 482, train: (loss: 0.1689, accuracy: 94.07%), test: (loss: 0.4666, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 483, train: (loss: 0.1724, accuracy: 93.99%), test: (loss: 0.453, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 484, train: (loss: 0.1661, accuracy: 94.26%), test: (loss: 0.469, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 485, train: (loss: 0.1704, accuracy: 94.09%), test: (loss: 0.4683, accuracy: 86.20%), lr: 1.0000e-03
        Epoch 486, train: (loss: 0.1727, accuracy: 93.87%), test: (loss: 0.4567, accuracy: 86.44%), lr: 1.0000e-03
        Epoch 487, train: (loss: 0.169, accuracy: 94.19%), test: (loss: 0.4715, accuracy: 86.35%), lr: 1.0000e-03
        Epoch 488, train: (loss: 0.1713, accuracy: 94.00%), test: (loss: 0.4643, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 489, train: (loss: 0.1664, accuracy: 94.19%), test: (loss: 0.4875, accuracy: 85.50%), lr: 1.0000e-03
        Epoch 490, train: (loss: 0.173, accuracy: 93.99%), test: (loss: 0.4617, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 491, train: (loss: 0.1671, accuracy: 94.26%), test: (loss: 0.4706, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 492, train: (loss: 0.1667, accuracy: 94.15%), test: (loss: 0.4707, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 493, train: (loss: 0.1668, accuracy: 94.27%), test: (loss: 0.4759, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 494, train: (loss: 0.1669, accuracy: 94.00%), test: (loss: 0.4614, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 495, train: (loss: 0.1675, accuracy: 94.15%), test: (loss: 0.4594, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 496, train: (loss: 0.1664, accuracy: 94.13%), test: (loss: 0.474, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 497, train: (loss: 0.1663, accuracy: 94.10%), test: (loss: 0.4687, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 498, train: (loss: 0.1694, accuracy: 94.08%), test: (loss: 0.4636, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 499, train: (loss: 0.1657, accuracy: 94.33%), test: (loss: 0.4881, accuracy: 85.63%), lr: 1.0000e-03
        Epoch 500, train: (loss: 0.1655, accuracy: 94.39%), test: (loss: 0.4654, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 501, train: (loss: 0.1692, accuracy: 94.20%), test: (loss: 0.4641, accuracy: 86.53%), lr: 1.0000e-03
        Epoch 502, train: (loss: 0.1704, accuracy: 93.96%), test: (loss: 0.4547, accuracy: 86.29%), lr: 1.0000e-03
        Epoch 503, train: (loss: 0.1669, accuracy: 94.22%), test: (loss: 0.4629, accuracy: 86.44%), lr: 1.0000e-03
        Epoch 504, train: (loss: 0.1683, accuracy: 94.01%), test: (loss: 0.4738, accuracy: 86.02%), lr: 1.0000e-03
        Epoch 505, train: (loss: 0.1667, accuracy: 94.16%), test: (loss: 0.4721, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 506, train: (loss: 0.1609, accuracy: 94.37%), test: (loss: 0.4718, accuracy: 85.73%), lr: 1.0000e-03
        Epoch 507, train: (loss: 0.1675, accuracy: 94.06%), test: (loss: 0.4659, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 508, train: (loss: 0.1645, accuracy: 94.21%), test: (loss: 0.4603, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 509, train: (loss: 0.1645, accuracy: 94.34%), test: (loss: 0.4613, accuracy: 86.79%), lr: 1.0000e-03
        Epoch 510, train: (loss: 0.1635, accuracy: 94.25%), test: (loss: 0.4633, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 511, train: (loss: 0.1652, accuracy: 94.26%), test: (loss: 0.4743, accuracy: 86.20%), lr: 1.0000e-03
        Epoch 512, train: (loss: 0.1687, accuracy: 94.03%), test: (loss: 0.4787, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 513, train: (loss: 0.1681, accuracy: 94.14%), test: (loss: 0.4649, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 514, train: (loss: 0.1637, accuracy: 94.21%), test: (loss: 0.4816, accuracy: 86.07%), lr: 1.0000e-03
        Epoch 515, train: (loss: 0.1642, accuracy: 94.21%), test: (loss: 0.4479, accuracy: 86.49%), lr: 1.0000e-03
        Epoch 516, train: (loss: 0.1672, accuracy: 94.23%), test: (loss: 0.4856, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 517, train: (loss: 0.1683, accuracy: 94.05%), test: (loss: 0.4699, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 518, train: (loss: 0.1647, accuracy: 94.19%), test: (loss: 0.4748, accuracy: 85.64%), lr: 1.0000e-03
        Epoch 519, train: (loss: 0.1657, accuracy: 94.10%), test: (loss: 0.4783, accuracy: 85.82%), lr: 1.0000e-03
        Epoch 520, train: (loss: 0.1604, accuracy: 94.35%), test: (loss: 0.4735, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 521, train: (loss: 0.1629, accuracy: 94.30%), test: (loss: 0.4803, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 522, train: (loss: 0.1657, accuracy: 94.35%), test: (loss: 0.4806, accuracy: 86.15%), lr: 1.0000e-03
        Epoch 523, train: (loss: 0.1676, accuracy: 94.10%), test: (loss: 0.4872, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 524, train: (loss: 0.1656, accuracy: 94.20%), test: (loss: 0.4757, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 525, train: (loss: 0.1669, accuracy: 94.17%), test: (loss: 0.4978, accuracy: 85.81%), lr: 1.0000e-03
        Epoch 526, train: (loss: 0.1608, accuracy: 94.30%), test: (loss: 0.4497, accuracy: 86.53%), lr: 1.0000e-03
        Epoch 527, train: (loss: 0.1628, accuracy: 94.19%), test: (loss: 0.4934, accuracy: 85.81%), lr: 1.0000e-03
        Epoch 528, train: (loss: 0.1616, accuracy: 94.49%), test: (loss: 0.4652, accuracy: 86.35%), lr: 1.0000e-03
        Epoch 529, train: (loss: 0.1644, accuracy: 94.18%), test: (loss: 0.4618, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 530, train: (loss: 0.1626, accuracy: 94.25%), test: (loss: 0.4658, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 531, train: (loss: 0.1673, accuracy: 94.04%), test: (loss: 0.4766, accuracy: 85.85%), lr: 1.0000e-03
        Epoch 532, train: (loss: 0.1603, accuracy: 94.34%), test: (loss: 0.4724, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 533, train: (loss: 0.1626, accuracy: 94.36%), test: (loss: 0.4655, accuracy: 86.36%), lr: 1.0000e-03
        Epoch 534, train: (loss: 0.1631, accuracy: 94.27%), test: (loss: 0.4716, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 535, train: (loss: 0.1641, accuracy: 94.34%), test: (loss: 0.4433, accuracy: 86.73%), lr: 1.0000e-03
        Epoch 536, train: (loss: 0.1612, accuracy: 94.34%), test: (loss: 0.4759, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 537, train: (loss: 0.1639, accuracy: 94.21%), test: (loss: 0.4614, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 538, train: (loss: 0.1616, accuracy: 94.41%), test: (loss: 0.4681, accuracy: 86.21%), lr: 1.0000e-03
        Epoch 539, train: (loss: 0.164, accuracy: 94.33%), test: (loss: 0.4585, accuracy: 86.34%), lr: 1.0000e-03
        Epoch 540, train: (loss: 0.1611, accuracy: 94.44%), test: (loss: 0.4497, accuracy: 86.68%), lr: 1.0000e-03
        Epoch 541, train: (loss: 0.1647, accuracy: 94.41%), test: (loss: 0.4588, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 542, train: (loss: 0.161, accuracy: 94.37%), test: (loss: 0.4581, accuracy: 86.53%), lr: 1.0000e-03
        Epoch 543, train: (loss: 0.1653, accuracy: 94.28%), test: (loss: 0.4726, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 544, train: (loss: 0.162, accuracy: 94.36%), test: (loss: 0.4663, accuracy: 86.25%), lr: 1.0000e-03
        Epoch 545, train: (loss: 0.1626, accuracy: 94.39%), test: (loss: 0.4744, accuracy: 86.59%), lr: 1.0000e-03
        Epoch 546, train: (loss: 0.1664, accuracy: 94.22%), test: (loss: 0.4406, accuracy: 86.86%), lr: 1.0000e-03
        Epoch 547, train: (loss: 0.162, accuracy: 94.30%), test: (loss: 0.4762, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 548, train: (loss: 0.1589, accuracy: 94.49%), test: (loss: 0.4722, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 549, train: (loss: 0.162, accuracy: 94.30%), test: (loss: 0.4503, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 550, train: (loss: 0.1639, accuracy: 94.35%), test: (loss: 0.4655, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 551, train: (loss: 0.1609, accuracy: 94.38%), test: (loss: 0.4701, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 552, train: (loss: 0.1598, accuracy: 94.51%), test: (loss: 0.4681, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 553, train: (loss: 0.162, accuracy: 94.33%), test: (loss: 0.4831, accuracy: 85.88%), lr: 1.0000e-03
        Epoch 554, train: (loss: 0.1573, accuracy: 94.47%), test: (loss: 0.484, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 555, train: (loss: 0.1585, accuracy: 94.44%), test: (loss: 0.4719, accuracy: 86.43%), lr: 1.0000e-03
        Epoch 556, train: (loss: 0.162, accuracy: 94.49%), test: (loss: 0.4614, accuracy: 86.60%), lr: 1.0000e-03
        Epoch 557, train: (loss: 0.1557, accuracy: 94.62%), test: (loss: 0.4656, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 558, train: (loss: 0.1589, accuracy: 94.49%), test: (loss: 0.4806, accuracy: 85.80%), lr: 1.0000e-03
        Epoch 559, train: (loss: 0.1603, accuracy: 94.32%), test: (loss: 0.4616, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 560, train: (loss: 0.1637, accuracy: 94.22%), test: (loss: 0.4593, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 561, train: (loss: 0.1589, accuracy: 94.50%), test: (loss: 0.4551, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 562, train: (loss: 0.1546, accuracy: 94.50%), test: (loss: 0.4656, accuracy: 86.35%), lr: 1.0000e-03
        Epoch 563, train: (loss: 0.1651, accuracy: 94.15%), test: (loss: 0.4646, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 564, train: (loss: 0.1603, accuracy: 94.33%), test: (loss: 0.464, accuracy: 86.34%), lr: 1.0000e-03
        Epoch 565, train: (loss: 0.1634, accuracy: 94.35%), test: (loss: 0.4525, accuracy: 86.53%), lr: 1.0000e-03
        Epoch 566, train: (loss: 0.1613, accuracy: 94.42%), test: (loss: 0.4804, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 567, train: (loss: 0.158, accuracy: 94.49%), test: (loss: 0.468, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 568, train: (loss: 0.161, accuracy: 94.47%), test: (loss: 0.4565, accuracy: 86.49%), lr: 1.0000e-03
        Epoch 569, train: (loss: 0.1598, accuracy: 94.48%), test: (loss: 0.4487, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 570, train: (loss: 0.1616, accuracy: 94.42%), test: (loss: 0.4805, accuracy: 86.35%), lr: 1.0000e-03
        Epoch 571, train: (loss: 0.1571, accuracy: 94.40%), test: (loss: 0.4582, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 572, train: (loss: 0.1588, accuracy: 94.50%), test: (loss: 0.4922, accuracy: 85.28%), lr: 1.0000e-03
        Epoch 573, train: (loss: 0.1619, accuracy: 94.29%), test: (loss: 0.4632, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 574, train: (loss: 0.1565, accuracy: 94.57%), test: (loss: 0.4743, accuracy: 85.93%), lr: 1.0000e-03
        Epoch 575, train: (loss: 0.1611, accuracy: 94.31%), test: (loss: 0.4783, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 576, train: (loss: 0.1633, accuracy: 94.35%), test: (loss: 0.4518, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 577, train: (loss: 0.1574, accuracy: 94.47%), test: (loss: 0.4648, accuracy: 86.14%), lr: 1.0000e-03
        Epoch 578, train: (loss: 0.1581, accuracy: 94.55%), test: (loss: 0.4779, accuracy: 85.92%), lr: 1.0000e-03
        Epoch 579, train: (loss: 0.1626, accuracy: 94.33%), test: (loss: 0.4578, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 580, train: (loss: 0.1618, accuracy: 94.38%), test: (loss: 0.4548, accuracy: 86.68%), lr: 1.0000e-03
        Epoch 581, train: (loss: 0.159, accuracy: 94.43%), test: (loss: 0.4648, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 582, train: (loss: 0.1609, accuracy: 94.40%), test: (loss: 0.4533, accuracy: 86.68%), lr: 1.0000e-03
        Epoch 583, train: (loss: 0.1576, accuracy: 94.46%), test: (loss: 0.4795, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 584, train: (loss: 0.1582, accuracy: 94.36%), test: (loss: 0.4383, accuracy: 86.89%), lr: 1.0000e-03
        Epoch 585, train: (loss: 0.1551, accuracy: 94.55%), test: (loss: 0.4739, accuracy: 86.14%), lr: 1.0000e-03
        Epoch 586, train: (loss: 0.1579, accuracy: 94.52%), test: (loss: 0.4547, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 587, train: (loss: 0.1601, accuracy: 94.36%), test: (loss: 0.4512, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 588, train: (loss: 0.1521, accuracy: 94.65%), test: (loss: 0.4566, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 589, train: (loss: 0.1638, accuracy: 94.20%), test: (loss: 0.4658, accuracy: 86.64%), lr: 1.0000e-03
        Epoch 590, train: (loss: 0.1521, accuracy: 94.68%), test: (loss: 0.4575, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 591, train: (loss: 0.1617, accuracy: 94.31%), test: (loss: 0.4566, accuracy: 86.51%), lr: 1.0000e-03
        Epoch 592, train: (loss: 0.1601, accuracy: 94.38%), test: (loss: 0.47, accuracy: 86.29%), lr: 1.0000e-03
        Epoch 593, train: (loss: 0.1579, accuracy: 94.47%), test: (loss: 0.4963, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 594, train: (loss: 0.1586, accuracy: 94.53%), test: (loss: 0.4541, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 595, train: (loss: 0.1588, accuracy: 94.39%), test: (loss: 0.4584, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 596, train: (loss: 0.1589, accuracy: 94.55%), test: (loss: 0.4869, accuracy: 86.00%), lr: 1.0000e-03
        Epoch 597, train: (loss: 0.1598, accuracy: 94.46%), test: (loss: 0.4893, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 598, train: (loss: 0.1546, accuracy: 94.59%), test: (loss: 0.4508, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 599, train: (loss: 0.1559, accuracy: 94.65%), test: (loss: 0.5015, accuracy: 85.98%), lr: 1.0000e-03
        Epoch 600, train: (loss: 0.1611, accuracy: 94.43%), test: (loss: 0.4298, accuracy: 87.23%), lr: 1.0000e-03
        Epoch 601, train: (loss: 0.1559, accuracy: 94.53%), test: (loss: 0.4549, accuracy: 86.60%), lr: 1.0000e-03
        Epoch 602, train: (loss: 0.1565, accuracy: 94.51%), test: (loss: 0.4724, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 603, train: (loss: 0.1552, accuracy: 94.47%), test: (loss: 0.4621, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 604, train: (loss: 0.1559, accuracy: 94.57%), test: (loss: 0.457, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 605, train: (loss: 0.1576, accuracy: 94.44%), test: (loss: 0.4754, accuracy: 86.02%), lr: 1.0000e-03
        Epoch 606, train: (loss: 0.157, accuracy: 94.51%), test: (loss: 0.4779, accuracy: 85.83%), lr: 1.0000e-03
        Epoch 607, train: (loss: 0.1568, accuracy: 94.60%), test: (loss: 0.4529, accuracy: 86.74%), lr: 1.0000e-03
        Epoch 608, train: (loss: 0.1626, accuracy: 94.33%), test: (loss: 0.4679, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 609, train: (loss: 0.1573, accuracy: 94.53%), test: (loss: 0.4715, accuracy: 86.12%), lr: 1.0000e-03
        Epoch 610, train: (loss: 0.1558, accuracy: 94.53%), test: (loss: 0.4741, accuracy: 86.36%), lr: 1.0000e-03
        Epoch 611, train: (loss: 0.1616, accuracy: 94.30%), test: (loss: 0.4709, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 612, train: (loss: 0.1597, accuracy: 94.44%), test: (loss: 0.4888, accuracy: 86.09%), lr: 1.0000e-03
        Epoch 613, train: (loss: 0.1596, accuracy: 94.44%), test: (loss: 0.4602, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 614, train: (loss: 0.1591, accuracy: 94.36%), test: (loss: 0.4929, accuracy: 86.01%), lr: 1.0000e-03
        Epoch 615, train: (loss: 0.1554, accuracy: 94.60%), test: (loss: 0.441, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 616, train: (loss: 0.154, accuracy: 94.71%), test: (loss: 0.4768, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 617, train: (loss: 0.1556, accuracy: 94.67%), test: (loss: 0.4775, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 618, train: (loss: 0.1512, accuracy: 94.73%), test: (loss: 0.488, accuracy: 86.02%), lr: 1.0000e-03
        Epoch 619, train: (loss: 0.1536, accuracy: 94.71%), test: (loss: 0.4722, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 620, train: (loss: 0.1515, accuracy: 94.78%), test: (loss: 0.4748, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 621, train: (loss: 0.1577, accuracy: 94.48%), test: (loss: 0.4595, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 622, train: (loss: 0.1619, accuracy: 94.30%), test: (loss: 0.4657, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 623, train: (loss: 0.1578, accuracy: 94.47%), test: (loss: 0.4734, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 624, train: (loss: 0.1564, accuracy: 94.49%), test: (loss: 0.4643, accuracy: 86.51%), lr: 1.0000e-03
        Epoch 625, train: (loss: 0.1536, accuracy: 94.62%), test: (loss: 0.4544, accuracy: 86.59%), lr: 1.0000e-03
        Epoch 626, train: (loss: 0.1563, accuracy: 94.55%), test: (loss: 0.4692, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 627, train: (loss: 0.1551, accuracy: 94.50%), test: (loss: 0.4489, accuracy: 86.59%), lr: 1.0000e-03
        Epoch 628, train: (loss: 0.1542, accuracy: 94.72%), test: (loss: 0.4721, accuracy: 86.43%), lr: 1.0000e-03
        Epoch 629, train: (loss: 0.1531, accuracy: 94.67%), test: (loss: 0.4755, accuracy: 86.08%), lr: 1.0000e-03
        Epoch 630, train: (loss: 0.1529, accuracy: 94.56%), test: (loss: 0.4838, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 631, train: (loss: 0.1595, accuracy: 94.47%), test: (loss: 0.4556, accuracy: 86.87%), lr: 1.0000e-03
        Epoch 632, train: (loss: 0.1577, accuracy: 94.47%), test: (loss: 0.4647, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 633, train: (loss: 0.1545, accuracy: 94.62%), test: (loss: 0.4649, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 634, train: (loss: 0.1593, accuracy: 94.31%), test: (loss: 0.4553, accuracy: 86.94%), lr: 1.0000e-03
        Epoch 635, train: (loss: 0.1569, accuracy: 94.44%), test: (loss: 0.4578, accuracy: 86.50%), lr: 1.0000e-03
        Epoch 636, train: (loss: 0.1494, accuracy: 94.78%), test: (loss: 0.487, accuracy: 85.80%), lr: 1.0000e-03
        Epoch 637, train: (loss: 0.1509, accuracy: 94.75%), test: (loss: 0.4868, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 638, train: (loss: 0.1572, accuracy: 94.47%), test: (loss: 0.4533, accuracy: 87.14%), lr: 1.0000e-03
        Epoch 639, train: (loss: 0.1536, accuracy: 94.70%), test: (loss: 0.4754, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 640, train: (loss: 0.1562, accuracy: 94.55%), test: (loss: 0.4716, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 641, train: (loss: 0.1533, accuracy: 94.71%), test: (loss: 0.4569, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 642, train: (loss: 0.1479, accuracy: 94.81%), test: (loss: 0.4726, accuracy: 86.11%), lr: 1.0000e-03
        Epoch 643, train: (loss: 0.1523, accuracy: 94.71%), test: (loss: 0.4674, accuracy: 86.04%), lr: 1.0000e-03
        Epoch 644, train: (loss: 0.1553, accuracy: 94.60%), test: (loss: 0.4688, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 645, train: (loss: 0.1561, accuracy: 94.69%), test: (loss: 0.4576, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 646, train: (loss: 0.1529, accuracy: 94.64%), test: (loss: 0.4666, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 647, train: (loss: 0.1519, accuracy: 94.72%), test: (loss: 0.4743, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 648, train: (loss: 0.1551, accuracy: 94.52%), test: (loss: 0.4663, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 649, train: (loss: 0.1606, accuracy: 94.43%), test: (loss: 0.4413, accuracy: 86.98%), lr: 1.0000e-03
        Epoch 650, train: (loss: 0.1486, accuracy: 94.84%), test: (loss: 0.4604, accuracy: 86.76%), lr: 1.0000e-03
        Epoch 651, train: (loss: 0.1557, accuracy: 94.52%), test: (loss: 0.4618, accuracy: 86.65%), lr: 1.0000e-03
        Epoch 652, train: (loss: 0.1522, accuracy: 94.65%), test: (loss: 0.4677, accuracy: 87.17%), lr: 1.0000e-03
        Epoch 653, train: (loss: 0.1564, accuracy: 94.58%), test: (loss: 0.465, accuracy: 86.30%), lr: 1.0000e-03
        Epoch 654, train: (loss: 0.1528, accuracy: 94.71%), test: (loss: 0.457, accuracy: 86.57%), lr: 1.0000e-03
        Epoch 655, train: (loss: 0.1569, accuracy: 94.50%), test: (loss: 0.4583, accuracy: 86.57%), lr: 1.0000e-03
        Epoch 656, train: (loss: 0.1525, accuracy: 94.55%), test: (loss: 0.4701, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 657, train: (loss: 0.1519, accuracy: 94.75%), test: (loss: 0.4557, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 658, train: (loss: 0.1545, accuracy: 94.57%), test: (loss: 0.4726, accuracy: 86.30%), lr: 1.0000e-03
        Epoch 659, train: (loss: 0.1533, accuracy: 94.70%), test: (loss: 0.468, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 660, train: (loss: 0.1557, accuracy: 94.65%), test: (loss: 0.4754, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 661, train: (loss: 0.1523, accuracy: 94.76%), test: (loss: 0.4729, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 662, train: (loss: 0.1529, accuracy: 94.69%), test: (loss: 0.4666, accuracy: 86.51%), lr: 1.0000e-03
        Epoch 663, train: (loss: 0.1508, accuracy: 94.78%), test: (loss: 0.4472, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 664, train: (loss: 0.1531, accuracy: 94.61%), test: (loss: 0.4606, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 665, train: (loss: 0.1504, accuracy: 94.70%), test: (loss: 0.4542, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 666, train: (loss: 0.1542, accuracy: 94.55%), test: (loss: 0.47, accuracy: 86.50%), lr: 1.0000e-03
        Epoch 667, train: (loss: 0.1512, accuracy: 94.70%), test: (loss: 0.4584, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 668, train: (loss: 0.1531, accuracy: 94.67%), test: (loss: 0.4546, accuracy: 86.65%), lr: 1.0000e-03
        Epoch 669, train: (loss: 0.1534, accuracy: 94.55%), test: (loss: 0.4647, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 670, train: (loss: 0.1504, accuracy: 94.68%), test: (loss: 0.4824, accuracy: 85.78%), lr: 1.0000e-03
        Epoch 671, train: (loss: 0.1499, accuracy: 94.78%), test: (loss: 0.4642, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 672, train: (loss: 0.1516, accuracy: 94.65%), test: (loss: 0.4713, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 673, train: (loss: 0.1499, accuracy: 94.85%), test: (loss: 0.4665, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 674, train: (loss: 0.1508, accuracy: 94.60%), test: (loss: 0.4614, accuracy: 86.13%), lr: 1.0000e-03
        Epoch 675, train: (loss: 0.154, accuracy: 94.67%), test: (loss: 0.4768, accuracy: 86.27%), lr: 1.0000e-03
        Epoch 676, train: (loss: 0.1531, accuracy: 94.66%), test: (loss: 0.5093, accuracy: 85.61%), lr: 1.0000e-03
        Epoch 677, train: (loss: 0.1524, accuracy: 94.65%), test: (loss: 0.4508, accuracy: 86.87%), lr: 1.0000e-03
        Epoch 678, train: (loss: 0.1512, accuracy: 94.67%), test: (loss: 0.4821, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 679, train: (loss: 0.1464, accuracy: 95.00%), test: (loss: 0.4797, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 680, train: (loss: 0.1497, accuracy: 94.74%), test: (loss: 0.4734, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 681, train: (loss: 0.1496, accuracy: 94.80%), test: (loss: 0.4815, accuracy: 86.15%), lr: 1.0000e-03
        Epoch 682, train: (loss: 0.1486, accuracy: 94.78%), test: (loss: 0.4677, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 683, train: (loss: 0.1539, accuracy: 94.58%), test: (loss: 0.4883, accuracy: 85.84%), lr: 1.0000e-03
        Epoch 684, train: (loss: 0.1557, accuracy: 94.54%), test: (loss: 0.4468, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 685, train: (loss: 0.1474, accuracy: 94.73%), test: (loss: 0.4706, accuracy: 86.43%), lr: 1.0000e-03
        Epoch 686, train: (loss: 0.1523, accuracy: 94.81%), test: (loss: 0.4599, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 687, train: (loss: 0.1488, accuracy: 94.77%), test: (loss: 0.472, accuracy: 86.29%), lr: 1.0000e-03
        Epoch 688, train: (loss: 0.1541, accuracy: 94.66%), test: (loss: 0.4518, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 689, train: (loss: 0.152, accuracy: 94.67%), test: (loss: 0.4642, accuracy: 86.65%), lr: 1.0000e-03
        Epoch 690, train: (loss: 0.1544, accuracy: 94.50%), test: (loss: 0.4771, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 691, train: (loss: 0.1529, accuracy: 94.58%), test: (loss: 0.4748, accuracy: 86.30%), lr: 1.0000e-03
        Epoch 692, train: (loss: 0.1507, accuracy: 94.80%), test: (loss: 0.4446, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 693, train: (loss: 0.1475, accuracy: 94.89%), test: (loss: 0.4694, accuracy: 86.47%), lr: 1.0000e-03
        Epoch 694, train: (loss: 0.1484, accuracy: 94.74%), test: (loss: 0.4661, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 695, train: (loss: 0.1558, accuracy: 94.69%), test: (loss: 0.4665, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 696, train: (loss: 0.1487, accuracy: 94.83%), test: (loss: 0.4583, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 697, train: (loss: 0.1534, accuracy: 94.74%), test: (loss: 0.4574, accuracy: 86.58%), lr: 1.0000e-03
        Epoch 698, train: (loss: 0.1486, accuracy: 94.78%), test: (loss: 0.4642, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 699, train: (loss: 0.1464, accuracy: 94.95%), test: (loss: 0.4649, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 700, train: (loss: 0.1475, accuracy: 94.75%), test: (loss: 0.4763, accuracy: 86.43%), lr: 1.0000e-03
        Epoch 701, train: (loss: 0.1501, accuracy: 94.77%), test: (loss: 0.4544, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 702, train: (loss: 0.1502, accuracy: 94.83%), test: (loss: 0.4481, accuracy: 87.02%), lr: 1.0000e-03
        Epoch 703, train: (loss: 0.1508, accuracy: 94.72%), test: (loss: 0.4807, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 704, train: (loss: 0.154, accuracy: 94.62%), test: (loss: 0.4779, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 705, train: (loss: 0.152, accuracy: 94.78%), test: (loss: 0.4543, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 706, train: (loss: 0.15, accuracy: 94.80%), test: (loss: 0.4634, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 707, train: (loss: 0.1509, accuracy: 94.84%), test: (loss: 0.4805, accuracy: 86.23%), lr: 1.0000e-03
        Epoch 708, train: (loss: 0.1522, accuracy: 94.69%), test: (loss: 0.4606, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 709, train: (loss: 0.1482, accuracy: 94.79%), test: (loss: 0.4597, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 710, train: (loss: 0.1466, accuracy: 94.81%), test: (loss: 0.4631, accuracy: 86.37%), lr: 1.0000e-03
        Epoch 711, train: (loss: 0.1548, accuracy: 94.61%), test: (loss: 0.4619, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 712, train: (loss: 0.1511, accuracy: 94.77%), test: (loss: 0.4861, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 713, train: (loss: 0.1468, accuracy: 94.91%), test: (loss: 0.4637, accuracy: 86.50%), lr: 1.0000e-03
        Epoch 714, train: (loss: 0.1488, accuracy: 94.83%), test: (loss: 0.4623, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 715, train: (loss: 0.1484, accuracy: 94.83%), test: (loss: 0.4693, accuracy: 86.65%), lr: 1.0000e-03
        Epoch 716, train: (loss: 0.1512, accuracy: 94.71%), test: (loss: 0.4418, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 717, train: (loss: 0.146, accuracy: 94.89%), test: (loss: 0.4889, accuracy: 85.68%), lr: 1.0000e-03
        Epoch 718, train: (loss: 0.1546, accuracy: 94.63%), test: (loss: 0.4694, accuracy: 86.15%), lr: 1.0000e-03
        Epoch 719, train: (loss: 0.1537, accuracy: 94.66%), test: (loss: 0.4882, accuracy: 86.78%), lr: 1.0000e-03
        Epoch 720, train: (loss: 0.1513, accuracy: 94.61%), test: (loss: 0.4981, accuracy: 85.90%), lr: 1.0000e-03
        Epoch 721, train: (loss: 0.1448, accuracy: 94.93%), test: (loss: 0.4989, accuracy: 86.21%), lr: 1.0000e-03
        Epoch 722, train: (loss: 0.1515, accuracy: 94.68%), test: (loss: 0.4558, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 723, train: (loss: 0.1507, accuracy: 94.73%), test: (loss: 0.483, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 724, train: (loss: 0.1483, accuracy: 94.79%), test: (loss: 0.4489, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 725, train: (loss: 0.1498, accuracy: 94.75%), test: (loss: 0.4684, accuracy: 86.57%), lr: 1.0000e-03
        Epoch 726, train: (loss: 0.1476, accuracy: 94.86%), test: (loss: 0.4834, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 727, train: (loss: 0.1473, accuracy: 94.83%), test: (loss: 0.4653, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 728, train: (loss: 0.1495, accuracy: 94.77%), test: (loss: 0.4598, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 729, train: (loss: 0.1516, accuracy: 94.74%), test: (loss: 0.4801, accuracy: 85.92%), lr: 1.0000e-03
        Epoch 730, train: (loss: 0.1444, accuracy: 94.89%), test: (loss: 0.487, accuracy: 86.24%), lr: 1.0000e-03
        Epoch 731, train: (loss: 0.1496, accuracy: 94.66%), test: (loss: 0.4653, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 732, train: (loss: 0.1522, accuracy: 94.67%), test: (loss: 0.4632, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 733, train: (loss: 0.1497, accuracy: 94.79%), test: (loss: 0.4519, accuracy: 87.11%), lr: 1.0000e-03
        Epoch 734, train: (loss: 0.1477, accuracy: 94.92%), test: (loss: 0.4563, accuracy: 86.68%), lr: 1.0000e-03
        Epoch 735, train: (loss: 0.1493, accuracy: 94.86%), test: (loss: 0.4632, accuracy: 86.68%), lr: 1.0000e-03
        Epoch 736, train: (loss: 0.1473, accuracy: 94.80%), test: (loss: 0.4671, accuracy: 86.73%), lr: 1.0000e-03
        Epoch 737, train: (loss: 0.1456, accuracy: 94.89%), test: (loss: 0.4565, accuracy: 87.33%), lr: 1.0000e-03
        Epoch 738, train: (loss: 0.1538, accuracy: 94.59%), test: (loss: 0.456, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 739, train: (loss: 0.1436, accuracy: 94.96%), test: (loss: 0.483, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 740, train: (loss: 0.1463, accuracy: 95.01%), test: (loss: 0.4631, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 741, train: (loss: 0.1482, accuracy: 94.88%), test: (loss: 0.4923, accuracy: 85.99%), lr: 1.0000e-03
        Epoch 742, train: (loss: 0.1481, accuracy: 94.89%), test: (loss: 0.4682, accuracy: 86.51%), lr: 1.0000e-03
        Epoch 743, train: (loss: 0.1499, accuracy: 94.74%), test: (loss: 0.4754, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 744, train: (loss: 0.152, accuracy: 94.73%), test: (loss: 0.4624, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 745, train: (loss: 0.1482, accuracy: 94.73%), test: (loss: 0.4678, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 746, train: (loss: 0.1521, accuracy: 94.77%), test: (loss: 0.4721, accuracy: 86.20%), lr: 1.0000e-03
        Epoch 747, train: (loss: 0.1512, accuracy: 94.74%), test: (loss: 0.4593, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 748, train: (loss: 0.1517, accuracy: 94.73%), test: (loss: 0.4509, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 749, train: (loss: 0.1458, accuracy: 94.91%), test: (loss: 0.4662, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 750, train: (loss: 0.1441, accuracy: 94.97%), test: (loss: 0.461, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 751, train: (loss: 0.1466, accuracy: 94.84%), test: (loss: 0.4517, accuracy: 86.92%), lr: 1.0000e-03
        Epoch 752, train: (loss: 0.1432, accuracy: 95.02%), test: (loss: 0.4609, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 753, train: (loss: 0.1496, accuracy: 94.76%), test: (loss: 0.4519, accuracy: 86.94%), lr: 1.0000e-03
        Epoch 754, train: (loss: 0.145, accuracy: 94.95%), test: (loss: 0.4736, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 755, train: (loss: 0.1465, accuracy: 94.86%), test: (loss: 0.4565, accuracy: 86.96%), lr: 1.0000e-03
        Epoch 756, train: (loss: 0.1497, accuracy: 94.81%), test: (loss: 0.4632, accuracy: 86.98%), lr: 1.0000e-03
        Epoch 757, train: (loss: 0.1435, accuracy: 94.99%), test: (loss: 0.4723, accuracy: 86.25%), lr: 1.0000e-03
        Epoch 758, train: (loss: 0.1483, accuracy: 94.78%), test: (loss: 0.4552, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 759, train: (loss: 0.148, accuracy: 94.96%), test: (loss: 0.4658, accuracy: 86.70%), lr: 1.0000e-03
        Epoch 760, train: (loss: 0.1499, accuracy: 94.78%), test: (loss: 0.4446, accuracy: 87.04%), lr: 1.0000e-03
        Epoch 761, train: (loss: 0.1484, accuracy: 94.87%), test: (loss: 0.4853, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 762, train: (loss: 0.1486, accuracy: 94.83%), test: (loss: 0.495, accuracy: 85.72%), lr: 1.0000e-03
        Epoch 763, train: (loss: 0.1465, accuracy: 95.04%), test: (loss: 0.4605, accuracy: 86.60%), lr: 1.0000e-03
        Epoch 764, train: (loss: 0.1462, accuracy: 94.90%), test: (loss: 0.4377, accuracy: 87.12%), lr: 1.0000e-03
        Epoch 765, train: (loss: 0.1472, accuracy: 94.89%), test: (loss: 0.4676, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 766, train: (loss: 0.1473, accuracy: 94.90%), test: (loss: 0.4921, accuracy: 85.79%), lr: 1.0000e-03
        Epoch 767, train: (loss: 0.1521, accuracy: 94.66%), test: (loss: 0.4722, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 768, train: (loss: 0.1436, accuracy: 94.85%), test: (loss: 0.4825, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 769, train: (loss: 0.1468, accuracy: 94.94%), test: (loss: 0.4548, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 770, train: (loss: 0.145, accuracy: 95.06%), test: (loss: 0.4631, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 771, train: (loss: 0.1469, accuracy: 94.82%), test: (loss: 0.4586, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 772, train: (loss: 0.1411, accuracy: 95.05%), test: (loss: 0.4775, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 773, train: (loss: 0.1427, accuracy: 95.07%), test: (loss: 0.4613, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 774, train: (loss: 0.1449, accuracy: 94.86%), test: (loss: 0.4404, accuracy: 86.90%), lr: 1.0000e-03
        Epoch 775, train: (loss: 0.1485, accuracy: 94.85%), test: (loss: 0.4702, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 776, train: (loss: 0.1421, accuracy: 95.11%), test: (loss: 0.4765, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 777, train: (loss: 0.1463, accuracy: 95.00%), test: (loss: 0.465, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 778, train: (loss: 0.1473, accuracy: 94.84%), test: (loss: 0.4679, accuracy: 85.97%), lr: 1.0000e-03
        Epoch 779, train: (loss: 0.1426, accuracy: 95.00%), test: (loss: 0.4644, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 780, train: (loss: 0.1447, accuracy: 94.93%), test: (loss: 0.452, accuracy: 87.28%), lr: 1.0000e-03
        Epoch 781, train: (loss: 0.1437, accuracy: 94.87%), test: (loss: 0.4642, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 782, train: (loss: 0.144, accuracy: 95.02%), test: (loss: 0.4773, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 783, train: (loss: 0.1465, accuracy: 94.82%), test: (loss: 0.4915, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 784, train: (loss: 0.1448, accuracy: 94.94%), test: (loss: 0.4593, accuracy: 86.60%), lr: 1.0000e-03
        Epoch 785, train: (loss: 0.1503, accuracy: 94.83%), test: (loss: 0.4648, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 786, train: (loss: 0.1475, accuracy: 94.91%), test: (loss: 0.469, accuracy: 86.43%), lr: 1.0000e-03
        Epoch 787, train: (loss: 0.1471, accuracy: 94.93%), test: (loss: 0.4675, accuracy: 86.90%), lr: 1.0000e-03
        Epoch 788, train: (loss: 0.1447, accuracy: 95.01%), test: (loss: 0.445, accuracy: 86.70%), lr: 1.0000e-03
        Epoch 789, train: (loss: 0.1455, accuracy: 94.96%), test: (loss: 0.4456, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 790, train: (loss: 0.1419, accuracy: 95.01%), test: (loss: 0.4921, accuracy: 86.32%), lr: 1.0000e-03
        Epoch 791, train: (loss: 0.1477, accuracy: 94.86%), test: (loss: 0.4539, accuracy: 87.40%), lr: 1.0000e-03
        Epoch 792, train: (loss: 0.1386, accuracy: 95.03%), test: (loss: 0.471, accuracy: 86.46%), lr: 1.0000e-03
        Epoch 793, train: (loss: 0.1529, accuracy: 94.69%), test: (loss: 0.4432, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 794, train: (loss: 0.1478, accuracy: 94.82%), test: (loss: 0.4421, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 795, train: (loss: 0.146, accuracy: 94.91%), test: (loss: 0.4631, accuracy: 86.94%), lr: 1.0000e-03
        Epoch 796, train: (loss: 0.1435, accuracy: 95.03%), test: (loss: 0.484, accuracy: 86.50%), lr: 1.0000e-03
        Epoch 797, train: (loss: 0.1452, accuracy: 95.04%), test: (loss: 0.4881, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 798, train: (loss: 0.1464, accuracy: 95.01%), test: (loss: 0.4723, accuracy: 86.34%), lr: 1.0000e-03
        Epoch 799, train: (loss: 0.1471, accuracy: 94.91%), test: (loss: 0.463, accuracy: 86.17%), lr: 1.0000e-03
        Epoch 800, train: (loss: 0.1471, accuracy: 94.96%), test: (loss: 0.4626, accuracy: 86.51%), lr: 1.0000e-03
        Epoch 801, train: (loss: 0.1411, accuracy: 95.16%), test: (loss: 0.4481, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 802, train: (loss: 0.146, accuracy: 94.84%), test: (loss: 0.4731, accuracy: 86.39%), lr: 1.0000e-03
        Epoch 803, train: (loss: 0.1479, accuracy: 94.89%), test: (loss: 0.4649, accuracy: 86.78%), lr: 1.0000e-03
        Epoch 804, train: (loss: 0.1412, accuracy: 95.01%), test: (loss: 0.4717, accuracy: 86.52%), lr: 1.0000e-03
        Epoch 805, train: (loss: 0.144, accuracy: 95.04%), test: (loss: 0.4772, accuracy: 86.25%), lr: 1.0000e-03
        Epoch 806, train: (loss: 0.1454, accuracy: 94.93%), test: (loss: 0.4595, accuracy: 86.78%), lr: 1.0000e-03
        Epoch 807, train: (loss: 0.1465, accuracy: 94.87%), test: (loss: 0.5061, accuracy: 85.65%), lr: 1.0000e-03
        Epoch 808, train: (loss: 0.1512, accuracy: 94.74%), test: (loss: 0.4564, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 809, train: (loss: 0.1471, accuracy: 94.88%), test: (loss: 0.4655, accuracy: 86.82%), lr: 1.0000e-03
        Epoch 810, train: (loss: 0.1435, accuracy: 95.09%), test: (loss: 0.4647, accuracy: 86.25%), lr: 1.0000e-03
        Epoch 811, train: (loss: 0.142, accuracy: 95.21%), test: (loss: 0.4798, accuracy: 86.26%), lr: 1.0000e-03
        Epoch 812, train: (loss: 0.1493, accuracy: 94.72%), test: (loss: 0.4597, accuracy: 87.06%), lr: 1.0000e-03
        Epoch 813, train: (loss: 0.1465, accuracy: 94.82%), test: (loss: 0.4691, accuracy: 86.61%), lr: 1.0000e-03
        Epoch 814, train: (loss: 0.1461, accuracy: 94.87%), test: (loss: 0.4789, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 815, train: (loss: 0.1467, accuracy: 94.96%), test: (loss: 0.4847, accuracy: 86.18%), lr: 1.0000e-03
        Epoch 816, train: (loss: 0.144, accuracy: 94.91%), test: (loss: 0.4609, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 817, train: (loss: 0.1451, accuracy: 95.04%), test: (loss: 0.4744, accuracy: 86.34%), lr: 1.0000e-03
        Epoch 818, train: (loss: 0.1441, accuracy: 94.94%), test: (loss: 0.48, accuracy: 86.38%), lr: 1.0000e-03
        Epoch 819, train: (loss: 0.1429, accuracy: 95.06%), test: (loss: 0.4572, accuracy: 86.96%), lr: 1.0000e-03
        Epoch 820, train: (loss: 0.146, accuracy: 94.84%), test: (loss: 0.4409, accuracy: 87.17%), lr: 1.0000e-03
        Epoch 821, train: (loss: 0.1416, accuracy: 95.09%), test: (loss: 0.4609, accuracy: 86.98%), lr: 1.0000e-03
        Epoch 822, train: (loss: 0.1441, accuracy: 95.00%), test: (loss: 0.4575, accuracy: 86.98%), lr: 1.0000e-03
        Epoch 823, train: (loss: 0.1441, accuracy: 94.99%), test: (loss: 0.4552, accuracy: 86.87%), lr: 1.0000e-03
        Epoch 824, train: (loss: 0.1431, accuracy: 95.02%), test: (loss: 0.4668, accuracy: 86.55%), lr: 1.0000e-03
        Epoch 825, train: (loss: 0.1472, accuracy: 94.86%), test: (loss: 0.4625, accuracy: 86.58%), lr: 1.0000e-03
        Epoch 826, train: (loss: 0.1457, accuracy: 94.84%), test: (loss: 0.4628, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 827, train: (loss: 0.1381, accuracy: 95.08%), test: (loss: 0.4472, accuracy: 86.99%), lr: 1.0000e-03
        Epoch 828, train: (loss: 0.144, accuracy: 94.92%), test: (loss: 0.4549, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 829, train: (loss: 0.1451, accuracy: 94.82%), test: (loss: 0.469, accuracy: 86.66%), lr: 1.0000e-03
        Epoch 830, train: (loss: 0.1442, accuracy: 94.96%), test: (loss: 0.4753, accuracy: 86.22%), lr: 1.0000e-03
        Epoch 831, train: (loss: 0.1426, accuracy: 94.96%), test: (loss: 0.4835, accuracy: 86.16%), lr: 1.0000e-03
        Epoch 832, train: (loss: 0.1409, accuracy: 95.06%), test: (loss: 0.464, accuracy: 86.56%), lr: 1.0000e-03
        Epoch 833, train: (loss: 0.1417, accuracy: 94.98%), test: (loss: 0.4703, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 834, train: (loss: 0.1406, accuracy: 95.02%), test: (loss: 0.477, accuracy: 86.74%), lr: 1.0000e-03
        Epoch 835, train: (loss: 0.1452, accuracy: 94.94%), test: (loss: 0.4835, accuracy: 86.20%), lr: 1.0000e-03
        Epoch 836, train: (loss: 0.1475, accuracy: 94.82%), test: (loss: 0.4609, accuracy: 86.50%), lr: 1.0000e-03
        Epoch 837, train: (loss: 0.1452, accuracy: 95.00%), test: (loss: 0.4649, accuracy: 86.78%), lr: 1.0000e-03
        Epoch 838, train: (loss: 0.1462, accuracy: 94.89%), test: (loss: 0.4671, accuracy: 86.62%), lr: 1.0000e-03
        Epoch 839, train: (loss: 0.1436, accuracy: 94.94%), test: (loss: 0.4771, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 840, train: (loss: 0.1425, accuracy: 94.99%), test: (loss: 0.4645, accuracy: 86.86%), lr: 1.0000e-03
        Epoch 841, train: (loss: 0.141, accuracy: 95.15%), test: (loss: 0.4538, accuracy: 86.91%), lr: 1.0000e-03
        Epoch 842, train: (loss: 0.1451, accuracy: 94.92%), test: (loss: 0.4704, accuracy: 86.75%), lr: 1.0000e-03
        Epoch 843, train: (loss: 0.1432, accuracy: 94.99%), test: (loss: 0.449, accuracy: 87.19%), lr: 1.0000e-03
        Epoch 844, train: (loss: 0.1433, accuracy: 95.08%), test: (loss: 0.476, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 845, train: (loss: 0.1443, accuracy: 94.98%), test: (loss: 0.4492, accuracy: 87.08%), lr: 1.0000e-03
        Epoch 846, train: (loss: 0.1449, accuracy: 95.04%), test: (loss: 0.4776, accuracy: 86.71%), lr: 1.0000e-03
        Epoch 847, train: (loss: 0.1424, accuracy: 94.96%), test: (loss: 0.468, accuracy: 86.67%), lr: 1.0000e-03
        Epoch 848, train: (loss: 0.142, accuracy: 95.09%), test: (loss: 0.4977, accuracy: 85.65%), lr: 1.0000e-03
        Epoch 849, train: (loss: 0.1453, accuracy: 94.88%), test: (loss: 0.452, accuracy: 86.85%), lr: 1.0000e-03
        Epoch 850, train: (loss: 0.1442, accuracy: 94.93%), test: (loss: 0.4692, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 851, train: (loss: 0.1443, accuracy: 94.93%), test: (loss: 0.4534, accuracy: 86.88%), lr: 1.0000e-03
        Epoch 852, train: (loss: 0.1436, accuracy: 94.84%), test: (loss: 0.4782, accuracy: 86.12%), lr: 1.0000e-03
        Epoch 853, train: (loss: 0.1358, accuracy: 95.21%), test: (loss: 0.4832, accuracy: 86.45%), lr: 1.0000e-03
        Epoch 854, train: (loss: 0.1409, accuracy: 95.11%), test: (loss: 0.4668, accuracy: 86.42%), lr: 1.0000e-03
        Epoch 855, train: (loss: 0.1443, accuracy: 95.08%), test: (loss: 0.4605, accuracy: 86.87%), lr: 1.0000e-03
        Epoch 856, train: (loss: 0.1392, accuracy: 95.20%), test: (loss: 0.4833, accuracy: 86.33%), lr: 1.0000e-03
        Epoch 857, train: (loss: 0.1435, accuracy: 94.97%), test: (loss: 0.4622, accuracy: 86.89%), lr: 1.0000e-03
        Epoch 858, train: (loss: 0.1443, accuracy: 94.97%), test: (loss: 0.4651, accuracy: 86.87%), lr: 1.0000e-03
        Epoch 859, train: (loss: 0.1401, accuracy: 95.17%), test: (loss: 0.4707, accuracy: 86.48%), lr: 1.0000e-03
        Epoch 860, train: (loss: 0.1426, accuracy: 95.02%), test: (loss: 0.4509, accuracy: 86.76%), lr: 1.0000e-03
        Epoch 861, train: (loss: 0.1398, accuracy: 95.01%), test: (loss: 0.4891, accuracy: 86.14%), lr: 1.0000e-03
        Epoch 862, train: (loss: 0.1402, accuracy: 95.08%), test: (loss: 0.4661, accuracy: 86.73%), lr: 1.0000e-03
        Epoch 863, train: (loss: 0.1415, accuracy: 95.05%), test: (loss: 0.4624, accuracy: 86.69%), lr: 1.0000e-03
        Epoch 864, train: (loss: 0.1397, accuracy: 95.07%), test: (loss: 0.4554, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 865, train: (loss: 0.1433, accuracy: 94.94%), test: (loss: 0.4735, accuracy: 86.84%), lr: 1.0000e-03
        Epoch 866, train: (loss: 0.1413, accuracy: 95.03%), test: (loss: 0.4967, accuracy: 86.28%), lr: 1.0000e-03
        Epoch 867, train: (loss: 0.1387, accuracy: 95.16%), test: (loss: 0.4644, accuracy: 86.72%), lr: 1.0000e-03
        Epoch 868, train: (loss: 0.1453, accuracy: 94.90%), test: (loss: 0.4667, accuracy: 86.54%), lr: 1.0000e-03
        Epoch 869, train: (loss: 0.1468, accuracy: 94.84%), test: (loss: 0.4509, accuracy: 86.85%), lr: 1.0000e-03
        Epoch 870, train: (loss: 0.1378, accuracy: 95.26%), test: (loss: 0.4614, accuracy: 86.81%), lr: 1.0000e-03
        Epoch 871, train: (loss: 0.1415, accuracy: 95.03%), test: (loss: 0.4609, accuracy: 86.83%), lr: 1.0000e-03
        Epoch 872, train: (loss: 0.1438, accuracy: 95.05%), test: (loss: 0.4739, accuracy: 86.77%), lr: 1.0000e-03
        Epoch 873, train: (loss: 0.1442, accuracy: 95.01%), test: (loss: 0.4691, accuracy: 86.40%), lr: 1.0000e-03
        Epoch 874, train: (loss: 0.1422, accuracy: 95.00%), test: (loss: 0.472, accuracy: 86.63%), lr: 1.0000e-03
        Epoch 875, train: (loss: 0.1395, accuracy: 95.13%), test: (loss: 0.4499, accuracy: 87.07%), lr: 1.0000e-03
        Epoch 876, train: (loss: 0.1422, accuracy: 94.99%), test: (loss: 0.4726, accuracy: 87.00%), lr: 1.0000e-03
        Epoch 877, train: (loss: 0.1416, accuracy: 94.98%), test: (loss: 0.4755, accuracy: 86.65%), lr: 1.0000e-03
        Epoch 878, train: (loss: 0.1458, accuracy: 94.86%), test: (loss: 0.4674, accuracy: 86.71%), lr: 1.0000e-03
        Epoch 879, train: (loss: 0.1415, accuracy: 95.06%), test: (loss: 0.4749, accuracy: 86.12%), lr: 1.0000e-03
        Epoch 880, train: (loss: 0.1426, accuracy: 95.07%), test: (loss: 0.4498, accuracy: 86.99%), lr: 1.0000e-03
        Epoch 881, train: (loss: 0.1426, accuracy: 95.00%), test: (loss: 0.4545, accuracy: 86.52%), lr: 1.0000e-03
    -> best accuracy, train: 95.26% (epoch 870), test: 87.40% (epoch 791)
eval (test) with no augments: (loss: 0.4114, accuracy: 88.86%)
totalTime: 4 h 2 min 5.2 sec, trainTime: 3 h 11 min 53.7 sec, testTime: 50 min 11.5 sec